(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{541:(Mo,Ie,Ci)=>{"use strict";function w(e){return"function"==typeof e}function Io(e){const n=e(i=>{Error.call(i),i.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const wi=Io(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function br(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class kt{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const o of n)o.remove(this);else n.remove(this);const{initialTeardown:i}=this;if(w(i))try{i()}catch(o){t=o instanceof wi?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{h(o)}catch(u){t=t??[],u instanceof wi?t=[...t,...u.errors]:t.push(u)}}if(t)throw new wi(t)}}add(t){var n;if(t&&t!==this)if(this.closed)h(t);else{if(t instanceof kt){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&br(n,t)}remove(t){const{_finalizers:n}=this;n&&br(n,t),t instanceof kt&&t._removeParent(this)}}kt.EMPTY=(()=>{const e=new kt;return e.closed=!0,e})();const bi=kt.EMPTY;function y(e){return e instanceof kt||e&&"closed"in e&&w(e.remove)&&w(e.add)&&w(e.unsubscribe)}function h(e){w(e)?e():e.unsubscribe()}const p={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},d={setTimeout(e,t,...n){const{delegate:i}=d;return i?.setTimeout?i.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=d;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function a(e){d.setTimeout(()=>{const{onUnhandledError:t}=p;if(!t)throw e;t(e)})}function c(){}const s=l("C",void 0,void 0);function l(e,t,n){return{kind:e,value:t,error:n}}let v=null;function _(e){if(p.useDeprecatedSynchronousErrorHandling){const t=!v;if(t&&(v={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:i}=v;if(v=null,n)throw i}}else e()}class S extends kt{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,y(t)&&t.add(this)):this.destination=ge}static create(t,n,i){return new j(t,n,i)}next(t){this.isStopped?le(function g(e){return l("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?le(function f(e){return l("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?le(s,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const T=Function.prototype.bind;function M(e,t){return T.call(e,t)}class P{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(i){G(i)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(i){G(i)}else G(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){G(n)}}}class j extends S{constructor(t,n,i){let r;if(super(),w(t)||!t)r={next:t??void 0,error:n??void 0,complete:i??void 0};else{let o;this&&p.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&M(t.next,o),error:t.error&&M(t.error,o),complete:t.complete&&M(t.complete,o)}):r=t}this.destination=new P(r)}}function G(e){p.useDeprecatedSynchronousErrorHandling?function b(e){p.useDeprecatedSynchronousErrorHandling&&v&&(v.errorThrown=!0,v.error=e)}(e):a(e)}function le(e,t){const{onStoppedNotification:n}=p;n&&d.setTimeout(()=>n(e,t))}const ge={closed:!0,next:c,error:function re(e){throw e},complete:c},pe="function"==typeof Symbol&&Symbol.observable||"@@observable";function ce(e){return e}let ve=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const i=new e;return i.source=this,i.operator=n,i}subscribe(n,i,r){const o=function N(e){return e&&e instanceof S||function I(e){return e&&w(e.next)&&w(e.error)&&w(e.complete)}(e)&&y(e)}(n)?n:new j(n,i,r);return _(()=>{const{operator:u,source:m}=this;o.add(u?u.call(o,m):m?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return new(i=Ce(i))((r,o)=>{const u=new j({next:m=>{try{n(m)}catch(C){o(C),u.unsubscribe()}},error:o,complete:r});this.subscribe(u)})}_subscribe(n){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(n)}[pe](){return this}pipe(...n){return function _e(e){return 0===e.length?ce:1===e.length?e[0]:function(n){return e.reduce((i,r)=>r(i),n)}}(n)(this)}toPromise(n){return new(n=Ce(n))((i,r)=>{let o;this.subscribe(u=>o=u,u=>r(u),()=>i(o))})}}return e.create=t=>new e(t),e})();function Ce(e){var t;return null!==(t=e??p.Promise)&&void 0!==t?t:Promise}const L=Io(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let R=(()=>{class e extends ve{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const i=new $(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new L}next(n){_(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(n)}})}error(n){_(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){_(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:i,isStopped:r,observers:o}=this;return i||r?bi:(this.currentObservers=null,o.push(n),new kt(()=>{this.currentObservers=null,br(o,n)}))}_checkFinalizedStatuses(n){const{hasError:i,thrownError:r,isStopped:o}=this;i?n.error(r):o&&n.complete()}asObservable(){const n=new ve;return n.source=this,n}}return e.create=(t,n)=>new $(t,n),e})();class $ extends R{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===i||i.call(n,t)}error(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===i||i.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,i;return null!==(i=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==i?i:bi}}function O(e){return t=>{if(function F(e){return w(e?.lift)}(t))return t.lift(function(n){try{return e(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function B(e,t,n,i,r){return new U(e,t,n,i,r)}class U extends S{constructor(t,n,i,r,o,u){super(t),this.onFinalize=o,this.shouldUnsubscribe=u,this._next=n?function(m){try{n(m)}catch(C){t.error(C)}}:super._next,this._error=r?function(m){try{r(m)}catch(C){t.error(C)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(m){t.error(m)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function qe(e){return this instanceof qe?(this.v=e,this):new qe(e)}function $t(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function Oe(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=e[o]&&function(u){return new Promise(function(m,C){!function r(o,u,m,C){Promise.resolve(C).then(function(D){o({value:D,done:m})},u)}(m,C,(u=e[o](u)).done,u.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const of=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function sf(e){return w(e?.then)}function af(e){return w(e[pe])}function lf(e){return Symbol.asyncIterator&&w(e?.[Symbol.asyncIterator])}function cf(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const uf=function c_(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function ff(e){return w(e?.[uf])}function hf(e){return function pn(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(A){i[A]&&(r[A]=function(k){return new Promise(function(z,q){o.push([A,k,z,q])>1||m(A,k)})})}function m(A,k){try{!function C(A){A.value instanceof qe?Promise.resolve(A.value.v).then(D,E):x(o[0][2],A)}(i[A](k))}catch(z){x(o[0][3],z)}}function D(A){m("next",A)}function E(A){m("throw",A)}function x(A,k){A(k),o.shift(),o.length&&m(o[0][0],o[0][1])}}(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:i,done:r}=yield qe(n.read());if(r)return yield qe(void 0);yield yield qe(i)}}finally{n.releaseLock()}})}function df(e){return w(e?.getReader)}function Mn(e){if(e instanceof ve)return e;if(null!=e){if(af(e))return function u_(e){return new ve(t=>{const n=e[pe]();if(w(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(of(e))return function f_(e){return new ve(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(sf(e))return function h_(e){return new ve(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,a)})}(e);if(lf(e))return gf(e);if(ff(e))return function d_(e){return new ve(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(df(e))return function g_(e){return gf(hf(e))}(e)}throw cf(e)}function gf(e){return new ve(t=>{(function p_(e,t){var n,i,r,o;return function xe(e,t,n,i){return new(n||(n=Promise))(function(o,u){function m(E){try{D(i.next(E))}catch(x){u(x)}}function C(E){try{D(i.throw(E))}catch(x){u(x)}}function D(E){E.done?o(E.value):function r(o){return o instanceof n?o:new n(function(u){u(o)})}(E.value).then(m,C)}D((i=i.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=$t(e);!(i=yield n.next()).done;)if(t.next(i.value),t.closed)return}catch(u){r={error:u}}finally{try{i&&!i.done&&(o=n.return)&&(yield o.call(n))}finally{if(r)throw r.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function $n(e,t,n,i=0,r=!1){const o=t.schedule(function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(o),!r)return o}function pf(e,t,n=1/0){return w(t)?pf((i,r)=>function K(e,t){return O((n,i)=>{let r=0;n.subscribe(B(i,o=>{i.next(e.call(t,o,r++))}))})}((o,u)=>t(i,o,r,u))(Mn(e(i,r))),n):("number"==typeof t&&(n=t),O((i,r)=>function m_(e,t,n,i,r,o,u,m){const C=[];let D=0,E=0,x=!1;const A=()=>{x&&!C.length&&!D&&t.complete()},k=q=>D<i?z(q):C.push(q),z=q=>{o&&t.next(q),D++;let se=!1;Mn(n(q,E++)).subscribe(B(t,ue=>{r?.(ue),o?k(ue):t.next(ue)},()=>{se=!0},void 0,()=>{if(se)try{for(D--;C.length&&D<i;){const ue=C.shift();u?$n(t,u,()=>z(ue)):z(ue)}A()}catch(ue){t.error(ue)}}))};return e.subscribe(B(t,k,()=>{x=!0,A()})),()=>{m?.()}}(i,r,e,n)))}const mf=new ve(e=>e.complete());function Oa(e){return e[e.length-1]}function vf(e){return function __(e){return e&&w(e.schedule)}(Oa(e))?e.pop():void 0}function yf(e,t=0){return O((n,i)=>{n.subscribe(B(i,r=>$n(i,e,()=>i.next(r),t),()=>$n(i,e,()=>i.complete(),t),r=>$n(i,e,()=>i.error(r),t)))})}function _f(e,t=0){return O((n,i)=>{i.add(e.schedule(()=>n.subscribe(i),t))})}function Cf(e,t){if(!e)throw new Error("Iterable cannot be null");return new ve(n=>{$n(n,t,()=>{const i=e[Symbol.asyncIterator]();$n(n,t,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function wf(e,t){return t?function T_(e,t){if(null!=e){if(af(e))return function w_(e,t){return Mn(e).pipe(_f(t),yf(t))}(e,t);if(of(e))return function D_(e,t){return new ve(n=>{let i=0;return t.schedule(function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())})})}(e,t);if(sf(e))return function b_(e,t){return Mn(e).pipe(_f(t),yf(t))}(e,t);if(lf(e))return Cf(e,t);if(ff(e))return function S_(e,t){return new ve(n=>{let i;return $n(n,t,()=>{i=e[uf](),$n(n,t,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(u){return void n.error(u)}o?n.complete():n.next(r)},0,!0)}),()=>w(i?.return)&&i.return()})}(e,t);if(df(e))return function E_(e,t){return Cf(hf(e),t)}(e,t)}throw cf(e)}(e,t):Mn(e)}function x_(...e){const t=vf(e),n=function C_(e,t){return"number"==typeof Oa(e)?e.pop():t}(e,1/0),i=e;return i.length?1===i.length?Mn(i[0]):function v_(e=1/0){return pf(ce,e)}(n)(wf(i,t)):mf}class M_ extends R{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:i}=this;if(t)throw n;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}function bf(e={}){const{connector:t=(()=>new R),resetOnError:n=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return o=>{let u,m,C,D=0,E=!1,x=!1;const A=()=>{m?.unsubscribe(),m=void 0},k=()=>{A(),u=C=void 0,E=x=!1},z=()=>{const q=u;k(),q?.unsubscribe()};return O((q,se)=>{D++,!x&&!E&&A();const ue=C=C??t();se.add(()=>{D--,0===D&&!x&&!E&&(m=Aa(z,r))}),ue.subscribe(se),!u&&D>0&&(u=new j({next:Z=>ue.next(Z),error:Z=>{x=!0,A(),m=Aa(k,n,Z),ue.error(Z)},complete:()=>{E=!0,A(),m=Aa(k,i),ue.complete()}}),Mn(q).subscribe(u))})(o)}}function Aa(e,t,...n){if(!0===t)return void e();if(!1===t)return;const i=new j({next:()=>{i.unsubscribe(),e()}});return Mn(t(...n)).subscribe(i)}function P_(e,t){return e===t}function Ze(e){for(let t in e)if(e[t]===Ze)return t;throw Error("Could not find renamed property on target object.")}function gt(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(gt).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function Pa(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const F_=Ze({__forward_ref__:Ze});function Fa(e){return e.__forward_ref__=Fa,e.toString=function(){return gt(this())},e}function Me(e){return function Ra(e){return"function"==typeof e&&e.hasOwnProperty(F_)&&e.__forward_ref__===Fa}(e)?e():e}function ka(e){return e&&!!e.\u0275providers}class ye extends Error{constructor(t,n){super(function Po(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}(t,n)),this.code=t}}function Ae(e){return"string"==typeof e?e:null==e?"":String(e)}function Na(e,t){throw new ye(-201,!1)}function Qt(e,t){null==e&&function Se(e,t,n,i){throw new Error(`ASSERTION ERROR: ${e}`+(null==i?"":` [Expected=> ${n} ${i} ${t} <=Actual]`))}(t,e,null,"!=")}function Ke(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function oi(e){return{providers:e.providers||[],imports:e.imports||[]}}function Fo(e){return Sf(e,ko)||Sf(e,Ef)}function Sf(e,t){return e.hasOwnProperty(t)?e[t]:null}function Ro(e){return e&&(e.hasOwnProperty(La)||e.hasOwnProperty(V_))?e[La]:null}const ko=Ze({\u0275prov:Ze}),La=Ze({\u0275inj:Ze}),Ef=Ze({ngInjectableDef:Ze}),V_=Ze({ngInjectorDef:Ze});var Ve=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(Ve||{});let ja;function Nt(e){const t=ja;return ja=e,t}function xf(e,t,n){const i=Fo(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&Ve.Optional?null:void 0!==t?t:void Na(gt(e))}const et=globalThis,Dr={},za="__NG_DI_FLAG__",No="ngTempTokenPath",z_=/\n/gm,If="__source";let Di;function Wn(e){const t=Di;return Di=e,t}function G_(e,t=Ve.Default){if(void 0===Di)throw new ye(-203,!1);return null===Di?xf(e,void 0,t):Di.get(e,t&Ve.Optional?null:void 0,t)}function He(e,t=Ve.Default){return(function Tf(){return ja}()||G_)(Me(e),t)}function tt(e,t=Ve.Default){return He(e,Lo(t))}function Lo(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function $a(e){const t=[];for(let n=0;n<e.length;n++){const i=Me(e[n]);if(Array.isArray(i)){if(0===i.length)throw new ye(900,!1);let r,o=Ve.Default;for(let u=0;u<i.length;u++){const m=i[u],C=Y_(m);"number"==typeof C?-1===C?r=m.token:o|=C:r=m}t.push(He(r,o))}else t.push(He(i))}return t}function Sr(e,t){return e[za]=t,e.prototype[za]=t,e}function Y_(e){return e[za]}function In(e){return{toString:e}.toString()}var jo=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(jo||{}),on=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(on||{});const mn={},$e=[],Bo=Ze({\u0275cmp:Ze}),Wa=Ze({\u0275dir:Ze}),Ga=Ze({\u0275pipe:Ze}),Af=Ze({\u0275mod:Ze}),On=Ze({\u0275fac:Ze}),Er=Ze({__NG_ELEMENT_ID__:Ze}),Pf=Ze({__NG_ENV_ID__:Ze});function Ff(e,t,n){let i=e.length;for(;;){const r=e.indexOf(t,n);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const o=t.length;if(r+o===i||e.charCodeAt(r+o)<=32)return r}n=r+1}}function Ya(e,t,n){let i=0;for(;i<n.length;){const r=n[i];if("number"==typeof r){if(0!==r)break;i++;const o=n[i++],u=n[i++],m=n[i++];e.setAttribute(t,u,m,o)}else{const o=r,u=n[++i];kf(o)?e.setProperty(t,o,u):e.setAttribute(t,o,u),i++}}return i}function Rf(e){return 3===e||4===e||6===e}function kf(e){return 64===e.charCodeAt(0)}function Tr(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?n=r:0===n||Nf(e,n,r,null,-1===n||2===n?t[++i]:null)}}return e}function Nf(e,t,n,i,r){let o=0,u=e.length;if(-1===t)u=-1;else for(;o<e.length;){const m=e[o++];if("number"==typeof m){if(m===t){u=-1;break}if(m>t){u=o-1;break}}}for(;o<e.length;){const m=e[o];if("number"==typeof m)break;if(m===n){if(null===i)return void(null!==r&&(e[o+1]=r));if(i===e[o+1])return void(e[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==u&&(e.splice(u,0,t),o=u+1),e.splice(o++,0,n),null!==i&&e.splice(o++,0,i),null!==r&&e.splice(o++,0,r)}const Lf="ng-template";function Z_(e,t,n){let i=0,r=!0;for(;i<e.length;){let o=e[i++];if("string"==typeof o&&r){const u=e[i++];if(n&&"class"===o&&-1!==Ff(u.toLowerCase(),t,0))return!0}else{if(1===o){for(;i<e.length&&"string"==typeof(o=e[i++]);)if(o.toLowerCase()===t)return!0;return!1}"number"==typeof o&&(r=!1)}}return!1}function jf(e){return 4===e.type&&e.value!==Lf}function K_(e,t,n){return t===(4!==e.type||n?e.value:Lf)}function Q_(e,t,n){let i=4;const r=e.attrs||[],o=function tC(e){for(let t=0;t<e.length;t++)if(Rf(e[t]))return t;return e.length}(r);let u=!1;for(let m=0;m<t.length;m++){const C=t[m];if("number"!=typeof C){if(!u)if(4&i){if(i=2|1&i,""!==C&&!K_(e,C,n)||""===C&&1===t.length){if(sn(i))return!1;u=!0}}else{const D=8&i?C:t[++m];if(8&i&&null!==e.attrs){if(!Z_(e.attrs,D,n)){if(sn(i))return!1;u=!0}continue}const x=J_(8&i?"class":C,r,jf(e),n);if(-1===x){if(sn(i))return!1;u=!0;continue}if(""!==D){let A;A=x>o?"":r[x+1].toLowerCase();const k=8&i?A:null;if(k&&-1!==Ff(k,D,0)||2&i&&D!==A){if(sn(i))return!1;u=!0}}}}else{if(!u&&!sn(i)&&!sn(C))return!1;if(u&&sn(C))continue;u=!1,i=C|1&i}}return sn(i)||u}function sn(e){return 0==(1&e)}function J_(e,t,n,i){if(null===t)return-1;let r=0;if(i||!n){let o=!1;for(;r<t.length;){const u=t[r];if(u===e)return r;if(3===u||6===u)o=!0;else{if(1===u||2===u){let m=t[++r];for(;"string"==typeof m;)m=t[++r];continue}if(4===u)break;if(0===u){r+=4;continue}}r+=o?1:2}return-1}return function nC(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const i=e[n];if("number"==typeof i)return-1;if(i===t)return n;n++}return-1}(t,e)}function Bf(e,t,n=!1){for(let i=0;i<t.length;i++)if(Q_(e,t[i],n))return!0;return!1}function Vf(e,t){return e?":not("+t.trim()+")":t}function rC(e){let t=e[0],n=1,i=2,r="",o=!1;for(;n<e.length;){let u=e[n];if("string"==typeof u)if(2&i){const m=e[++n];r+="["+u+(m.length>0?'="'+m+'"':"")+"]"}else 8&i?r+="."+u:4&i&&(r+=" "+u);else""!==r&&!sn(u)&&(t+=Vf(o,r),r=""),i=u,o=o||!sn(i);n++}return""!==r&&(t+=Vf(o,r)),t}function Xa(e){return In(()=>{const t=Uf(e),n={...t,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===jo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||on.Emulated,styles:e.styles||$e,_:null,schemas:e.schemas||null,tView:null,id:""};zf(n);const i=e.dependencies;return n.directiveDefs=Vo(i,!1),n.pipeDefs=Vo(i,!0),n.id=function hC(e){let t=0;const n=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const r of n)t=Math.imul(31,t)+r.charCodeAt(0)<<0;return t+=2147483648,"c"+t}(n),n})}function lC(e){return Ue(e)||yt(e)}function cC(e){return null!==e}function Si(e){return In(()=>({type:e.type,bootstrap:e.bootstrap||$e,declarations:e.declarations||$e,imports:e.imports||$e,exports:e.exports||$e,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function Hf(e,t){if(null==e)return mn;const n={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),n[r]=i,t&&(t[r]=o)}return n}function Gt(e){return In(()=>{const t=Uf(e);return zf(t),t})}function Ue(e){return e[Bo]||null}function yt(e){return e[Wa]||null}function xt(e){return e[Ga]||null}function Uf(e){const t={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:e.inputs||mn,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||$e,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Hf(e.inputs,t),outputs:Hf(e.outputs)}}function zf(e){e.features?.forEach(t=>t(e))}function Vo(e,t){if(!e)return null;const n=t?xt:lC;return()=>("function"==typeof e?e():e).map(i=>n(i)).filter(cC)}const lt=0,me=1,ke=2,ot=3,an=4,Mr=5,St=6,Ei=7,ut=8,Gn=9,Ti=10,Pe=11,Ir=12,$f=13,xi=14,ft=15,Or=16,Mi=17,vn=18,Ar=19,Wf=20,Yn=21,An=22,Pr=23,Fr=24,je=25,qa=1,Gf=2,yn=7,Ii=9,_t=11;function jt(e){return Array.isArray(e)&&"object"==typeof e[qa]}function Mt(e){return Array.isArray(e)&&!0===e[qa]}function Za(e){return 0!=(4&e.flags)}function si(e){return e.componentOffset>-1}function Uo(e){return 1==(1&e.flags)}function ln(e){return!!e.template}function Ka(e){return 0!=(512&e[ke])}function ai(e,t){return e.hasOwnProperty(On)?e[On]:null}let Ct=null,zo=!1;function Jt(e){const t=Ct;return Ct=e,t}const $o={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Kf(e){if(!kr(e)||e.dirty){if(!e.producerMustRecompute(e)&&!eh(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function Jf(e){e.dirty=!0,function Qf(e){if(void 0===e.liveConsumerNode)return;const t=zo;zo=!0;try{for(const n of e.liveConsumerNode)n.dirty||Jf(n)}finally{zo=t}}(e),e.consumerMarkedDirty?.(e)}function Wo(e){return e&&(e.nextProducerIndex=0),Jt(e)}function Go(e,t){if(Jt(t),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(kr(e))for(let n=e.nextProducerIndex;n<e.producerNode.length;n++)Yo(e.producerNode[n],e.producerIndexOfThis[n]);for(let n=e.nextProducerIndex;n<e.producerNode.length;n++)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function eh(e){Oi(e);for(let t=0;t<e.producerNode.length;t++){const n=e.producerNode[t],i=e.producerLastReadVersion[t];if(i!==n.version||(Kf(n),i!==n.version))return!0}return!1}function th(e){if(Oi(e),kr(e))for(let t=0;t<e.producerNode.length;t++)Yo(e.producerNode[t],e.producerIndexOfThis[t]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function Yo(e,t){if(function ih(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),Oi(e),1===e.liveConsumerNode.length)for(let i=0;i<e.producerNode.length;i++)Yo(e.producerNode[i],e.producerIndexOfThis[i]);const n=e.liveConsumerNode.length-1;if(e.liveConsumerNode[t]=e.liveConsumerNode[n],e.liveConsumerIndexOfThis[t]=e.liveConsumerIndexOfThis[n],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,t<e.liveConsumerNode.length){const i=e.liveConsumerIndexOfThis[t],r=e.liveConsumerNode[t];Oi(r),r.producerIndexOfThis[i]=t}}function kr(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function Oi(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let rh=null;const lh=()=>{},SC={...$o,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:lh};class EC{constructor(t,n,i){this.previousValue=t,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}}function Nr(){return ch}function ch(e){return e.type.prototype.ngOnChanges&&(e.setInput=xC),TC}function TC(){const e=fh(this),t=e?.current;if(t){const n=e.previous;if(n===mn)e.previous=t;else for(let i in t)n[i]=t[i];e.current=null,this.ngOnChanges(t)}}function xC(e,t,n,i){const r=this.declaredInputs[n],o=fh(e)||function MC(e,t){return e[uh]=t}(e,{previous:mn,current:null}),u=o.current||(o.current={}),m=o.previous,C=m[r];u[r]=new EC(C&&C.currentValue,t,m===mn),e[i]=t}Nr.ngInherit=!0;const uh="__ngSimpleChanges__";function fh(e){return e[uh]||null}const _n=function(e,t,n){};function nt(e){for(;Array.isArray(e);)e=e[lt];return e}function qo(e,t){return nt(t[e])}function Bt(e,t){return nt(t[e.index])}function gh(e,t){return e.data[t]}function Xt(e,t){const n=t[e];return jt(n)?n:n[lt]}function qn(e,t){return null==t?null:e[t]}function ph(e){e[Mi]=0}function RC(e){1024&e[ke]||(e[ke]|=1024,vh(e,1))}function mh(e){1024&e[ke]&&(e[ke]&=-1025,vh(e,-1))}function vh(e,t){let n=e[ot];if(null===n)return;n[Mr]+=t;let i=n;for(n=n[ot];null!==n&&(1===t&&1===i[Mr]||-1===t&&0===i[Mr]);)n[Mr]+=t,i=n,n=n[ot]}const Ee={lFrame:Mh(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Ch(){return Ee.bindingsEnabled}function ie(){return Ee.lFrame.lView}function ze(){return Ee.lFrame.tView}function Fi(e){return Ee.lFrame.contextLView=e,e[ut]}function Ri(e){return Ee.lFrame.contextLView=null,e}function wt(){let e=wh();for(;null!==e&&64===e.type;)e=e.parent;return e}function wh(){return Ee.lFrame.currentTNode}function Cn(e,t){const n=Ee.lFrame;n.currentTNode=e,n.isParent=t}function ol(){return Ee.lFrame.isParent}function ki(){return Ee.lFrame.bindingIndex++}function GC(e,t){const n=Ee.lFrame;n.bindingIndex=n.bindingRootIndex=e,al(t)}function al(e){Ee.lFrame.currentDirectiveIndex=e}function Eh(){return Ee.lFrame.currentQueryIndex}function cl(e){Ee.lFrame.currentQueryIndex=e}function XC(e){const t=e[me];return 2===t.type?t.declTNode:1===t.type?e[St]:null}function Th(e,t,n){if(n&Ve.SkipSelf){let r=t,o=e;for(;!(r=r.parent,null!==r||n&Ve.Host||(r=XC(o),null===r||(o=o[xi],10&r.type))););if(null===r)return!1;t=r,e=o}const i=Ee.lFrame=xh();return i.currentTNode=t,i.lView=e,!0}function ul(e){const t=xh(),n=e[me];Ee.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function xh(){const e=Ee.lFrame,t=null===e?null:e.child;return null===t?Mh(e):t}function Mh(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function Ih(){const e=Ee.lFrame;return Ee.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Oh=Ih;function fl(){const e=Ih();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Ot(){return Ee.lFrame.selectedIndex}function li(e){Ee.lFrame.selectedIndex=e}let Ph=!0;function Zo(){return Ph}function Zn(e){Ph=e}function Ko(e,t){for(let n=t.directiveStart,i=t.directiveEnd;n<i;n++){const o=e.data[n].type.prototype,{ngAfterContentInit:u,ngAfterContentChecked:m,ngAfterViewInit:C,ngAfterViewChecked:D,ngOnDestroy:E}=o;u&&(e.contentHooks??=[]).push(-n,u),m&&((e.contentHooks??=[]).push(n,m),(e.contentCheckHooks??=[]).push(n,m)),C&&(e.viewHooks??=[]).push(-n,C),D&&((e.viewHooks??=[]).push(n,D),(e.viewCheckHooks??=[]).push(n,D)),null!=E&&(e.destroyHooks??=[]).push(n,E)}}function Qo(e,t,n){Fh(e,t,3,n)}function Jo(e,t,n,i){(3&e[ke])===n&&Fh(e,t,n,i)}function hl(e,t){let n=e[ke];(3&n)===t&&(n&=8191,n+=1,e[ke]=n)}function Fh(e,t,n,i){const o=i??-1,u=t.length-1;let m=0;for(let C=void 0!==i?65535&e[Mi]:0;C<u;C++)if("number"==typeof t[C+1]){if(m=t[C],null!=i&&m>=i)break}else t[C]<0&&(e[Mi]+=65536),(m<o||-1==o)&&(n0(e,n,t,C),e[Mi]=(4294901760&e[Mi])+C+2),C++}function Rh(e,t){_n(4,e,t);const n=Jt(null);try{t.call(e)}finally{Jt(n),_n(5,e,t)}}function n0(e,t,n,i){const r=n[i]<0,o=n[i+1],m=e[r?-n[i]:n[i]];r?e[ke]>>13<e[Mi]>>16&&(3&e[ke])===t&&(e[ke]+=8192,Rh(m,o)):Rh(m,o)}const Ni=-1;class jr{constructor(t,n,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}}function gl(e){return e!==Ni}function Br(e){return 32767&e}function Vr(e,t){let n=function a0(e){return e>>16}(e),i=t;for(;n>0;)i=i[xi],n--;return i}let pl=!0;function es(e){const t=pl;return pl=e,t}const kh=255,Nh=5;let l0=0;const wn={};function ts(e,t){const n=Lh(e,t);if(-1!==n)return n;const i=t[me];i.firstCreatePass&&(e.injectorIndex=t.length,ml(i.data,e),ml(t,null),ml(i.blueprint,null));const r=ns(e,t),o=e.injectorIndex;if(gl(r)){const u=Br(r),m=Vr(r,t),C=m[me].data;for(let D=0;D<8;D++)t[o+D]=m[u+D]|C[u+D]}return t[o+8]=r,o}function ml(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Lh(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function ns(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,i=null,r=t;for(;null!==r;){if(i=$h(r),null===i)return Ni;if(n++,r=r[xi],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return Ni}function vl(e,t,n){!function c0(e,t,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(Er)&&(i=n[Er]),null==i&&(i=n[Er]=l0++);const r=i&kh;t.data[e+(r>>Nh)]|=1<<r}(e,t,n)}function jh(e,t,n){if(n&Ve.Optional||void 0!==e)return e;Na()}function Bh(e,t,n,i){if(n&Ve.Optional&&void 0===i&&(i=null),!(n&(Ve.Self|Ve.Host))){const r=e[Gn],o=Nt(void 0);try{return r?r.get(t,i,n&Ve.Optional):xf(t,i,n&Ve.Optional)}finally{Nt(o)}}return jh(i,0,n)}function Vh(e,t,n,i=Ve.Default,r){if(null!==e){if(2048&t[ke]&&!(i&Ve.Self)){const u=function m0(e,t,n,i,r){let o=e,u=t;for(;null!==o&&null!==u&&2048&u[ke]&&!(512&u[ke]);){const m=Hh(o,u,n,i|Ve.Self,wn);if(m!==wn)return m;let C=o.parent;if(!C){const D=u[Wf];if(D){const E=D.get(n,wn,i);if(E!==wn)return E}C=$h(u),u=u[xi]}o=C}return r}(e,t,n,i,wn);if(u!==wn)return u}const o=Hh(e,t,n,i,wn);if(o!==wn)return o}return Bh(t,n,i,r)}function Hh(e,t,n,i,r){const o=function h0(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(Er)?e[Er]:void 0;return"number"==typeof t?t>=0?t&kh:g0:t}(n);if("function"==typeof o){if(!Th(t,e,i))return i&Ve.Host?jh(r,0,i):Bh(t,n,i,r);try{let u;if(u=o(i),null!=u||i&Ve.Optional)return u;Na()}finally{Oh()}}else if("number"==typeof o){let u=null,m=Lh(e,t),C=Ni,D=i&Ve.Host?t[ft][St]:null;for((-1===m||i&Ve.SkipSelf)&&(C=-1===m?ns(e,t):t[m+8],C!==Ni&&zh(i,!1)?(u=t[me],m=Br(C),t=Vr(C,t)):m=-1);-1!==m;){const E=t[me];if(Uh(o,m,E.data)){const x=f0(m,t,n,u,i,D);if(x!==wn)return x}C=t[m+8],C!==Ni&&zh(i,t[me].data[m+8]===D)&&Uh(o,m,t)?(u=E,m=Br(C),t=Vr(C,t)):m=-1}}return r}function f0(e,t,n,i,r,o){const u=t[me],m=u.data[e+8],E=is(m,u,n,null==i?si(m)&&pl:i!=u&&0!=(3&m.type),r&Ve.Host&&o===m);return null!==E?ci(t,u,E,m):wn}function is(e,t,n,i,r){const o=e.providerIndexes,u=t.data,m=1048575&o,C=e.directiveStart,E=o>>20,A=r?m+E:e.directiveEnd;for(let k=i?m:m+E;k<A;k++){const z=u[k];if(k<C&&n===z||k>=C&&z.type===n)return k}if(r){const k=u[C];if(k&&ln(k)&&k.type===n)return C}return null}function ci(e,t,n,i){let r=e[n];const o=t.data;if(function r0(e){return e instanceof jr}(r)){const u=r;u.resolving&&function R_(e,t){const n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new ye(-200,`Circular dependency in DI detected for ${e}${n}`)}(function Xe(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Ae(e)}(o[n]));const m=es(u.canSeeViewProviders);u.resolving=!0;const D=u.injectImpl?Nt(u.injectImpl):null;Th(e,i,Ve.Default);try{r=e[n]=u.factory(void 0,o,e,i),t.firstCreatePass&&n>=i.directiveStart&&function t0(e,t,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=t.type.prototype;if(i){const u=ch(t);(n.preOrderHooks??=[]).push(e,u),(n.preOrderCheckHooks??=[]).push(e,u)}r&&(n.preOrderHooks??=[]).push(0-e,r),o&&((n.preOrderHooks??=[]).push(e,o),(n.preOrderCheckHooks??=[]).push(e,o))}(n,o[n],t)}finally{null!==D&&Nt(D),es(m),u.resolving=!1,Oh()}}return r}function Uh(e,t,n){return!!(n[t+(e>>Nh)]&1<<e)}function zh(e,t){return!(e&Ve.Self||e&Ve.Host&&t)}class At{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,i){return Vh(this._tNode,this._lView,t,Lo(i),n)}}function g0(){return new At(wt(),ie())}function $h(e){const t=e[me],n=t.type;return 2===n?t.declTNode:1===n?e[St]:null}const ji="__parameters__";function Vi(e,t,n){return In(()=>{const i=function Cl(e){return function(...n){if(e){const i=e(...n);for(const r in i)this[r]=i[r]}}}(t);function r(...o){if(this instanceof r)return i.apply(this,o),this;const u=new r(...o);return m.annotation=u,m;function m(C,D,E){const x=C.hasOwnProperty(ji)?C[ji]:Object.defineProperty(C,ji,{value:[]})[ji];for(;x.length<=E;)x.push(null);return(x[E]=x[E]||[]).push(u),C}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}function Ui(e,t){e.forEach(n=>Array.isArray(n)?Ui(n,t):t(n))}function Gh(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function rs(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function qt(e,t,n){let i=zi(e,t);return i>=0?e[1|i]=n:(i=~i,function D0(e,t,n,i){let r=e.length;if(r==t)e.push(n,i);else if(1===r)e.push(i,e[0]),e[0]=n;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=n,e[t+1]=i}}(e,i,t,n)),i}function wl(e,t){const n=zi(e,t);if(n>=0)return e[1|n]}function zi(e,t){return function Yh(e,t,n){let i=0,r=e.length>>n;for(;r!==i;){const o=i+(r-i>>1),u=e[o<<n];if(t===u)return o<<n;u>t?r=o:i=o+1}return~(r<<n)}(e,t,1)}const Dl=Sr(Vi("Optional"),8),Sl=Sr(Vi("SkipSelf"),4);function us(e){return 128==(128&e.flags)}var Kn=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Kn||{});const Ml=new Map;let Y0=0;const Ol="__ngContext__";function Et(e,t){jt(t)?(e[Ol]=t[Ar],function q0(e){Ml.set(e[Ar],e)}(t)):e[Ol]=t}let Al;function Pl(e,t){return Al(e,t)}function Gr(e){const t=e[ot];return Mt(t)?t[ot]:t}function dd(e){return pd(e[Ir])}function gd(e){return pd(e[an])}function pd(e){for(;null!==e&&!Mt(e);)e=e[an];return e}function Gi(e,t,n,i,r){if(null!=i){let o,u=!1;Mt(i)?o=i:jt(i)&&(u=!0,i=i[lt]);const m=nt(i);0===e&&null!==n?null==r?_d(t,n,m):ui(t,n,m,r||null,!0):1===e&&null!==n?ui(t,n,m,r||null,!0):2===e?function vs(e,t,n){const i=ps(e,t);i&&function gw(e,t,n,i){e.removeChild(t,n,i)}(e,i,t,n)}(t,m,u):3===e&&t.destroyNode(m),null!=o&&function vw(e,t,n,i,r){const o=n[yn];o!==nt(n)&&Gi(t,e,i,o,r);for(let m=_t;m<n.length;m++){const C=n[m];Xr(C[me],C,e,t,i,o)}}(t,e,o,n,r)}}function ds(e,t,n){return e.createElement(t,n)}function vd(e,t){const n=e[Ii],i=n.indexOf(t);mh(t),n.splice(i,1)}function gs(e,t){if(e.length<=_t)return;const n=_t+t,i=e[n];if(i){const r=i[Or];null!==r&&r!==e&&vd(r,i),t>0&&(e[n-1][an]=i[an]);const o=rs(e,_t+t);!function sw(e,t){Xr(e,t,t[Pe],2,null,null),t[lt]=null,t[St]=null}(i[me],i);const u=o[vn];null!==u&&u.detachView(o[me]),i[ot]=null,i[an]=null,i[ke]&=-129}return i}function Rl(e,t){if(!(256&t[ke])){const n=t[Pe];t[Pr]&&th(t[Pr]),t[Fr]&&th(t[Fr]),n.destroyNode&&Xr(e,t,n,3,null,null),function cw(e){let t=e[Ir];if(!t)return kl(e[me],e);for(;t;){let n=null;if(jt(t))n=t[Ir];else{const i=t[_t];i&&(n=i)}if(!n){for(;t&&!t[an]&&t!==e;)jt(t)&&kl(t[me],t),t=t[ot];null===t&&(t=e),jt(t)&&kl(t[me],t),n=t&&t[an]}t=n}}(t)}}function kl(e,t){if(!(256&t[ke])){t[ke]&=-129,t[ke]|=256,function dw(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let i=0;i<n.length;i+=2){const r=t[n[i]];if(!(r instanceof jr)){const o=n[i+1];if(Array.isArray(o))for(let u=0;u<o.length;u+=2){const m=r[o[u]],C=o[u+1];_n(4,m,C);try{C.call(m)}finally{_n(5,m,C)}}else{_n(4,r,o);try{o.call(r)}finally{_n(5,r,o)}}}}}(e,t),function hw(e,t){const n=e.cleanup,i=t[Ei];if(null!==n)for(let o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){const u=n[o+3];u>=0?i[u]():i[-u].unsubscribe(),o+=2}else n[o].call(i[n[o+1]]);null!==i&&(t[Ei]=null);const r=t[Yn];if(null!==r){t[Yn]=null;for(let o=0;o<r.length;o++)(0,r[o])()}}(e,t),1===t[me].type&&t[Pe].destroy();const n=t[Or];if(null!==n&&Mt(t[ot])){n!==t[ot]&&vd(n,t);const i=t[vn];null!==i&&i.detachView(e)}!function Z0(e){Ml.delete(e[Ar])}(t)}}function Nl(e,t,n){return function yd(e,t,n){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return n[lt];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:o}=e.data[i.directiveStart+r];if(o===on.None||o===on.Emulated)return null}return Bt(i,n)}}(e,t.parent,n)}function ui(e,t,n,i,r){e.insertBefore(t,n,i,r)}function _d(e,t,n){e.appendChild(t,n)}function Cd(e,t,n,i,r){null!==i?ui(e,t,n,i,r):_d(e,t,n)}function ps(e,t){return e.parentNode(t)}let Ll,Hl,Dd=function bd(e,t,n){return 40&e.type?Bt(e,n):null};function ms(e,t,n,i){const r=Nl(e,i,t),o=t[Pe],m=function wd(e,t,n){return Dd(e,t,n)}(i.parent||t[St],i,t);if(null!=r)if(Array.isArray(n))for(let C=0;C<n.length;C++)Cd(o,r,n[C],m,!1);else Cd(o,r,n,m,!1);void 0!==Ll&&Ll(o,i,t,n,r)}function Yr(e,t){if(null!==t){const n=t.type;if(3&n)return Bt(t,e);if(4&n)return jl(-1,e[t.index]);if(8&n){const i=t.child;if(null!==i)return Yr(e,i);{const r=e[t.index];return Mt(r)?jl(-1,r):nt(r)}}if(32&n)return Pl(t,e)()||nt(e[t.index]);{const i=Ed(e,t);return null!==i?Array.isArray(i)?i[0]:Yr(Gr(e[ft]),i):Yr(e,t.next)}}return null}function Ed(e,t){return null!==t?e[ft][St].projection[t.projection]:null}function jl(e,t){const n=_t+e+1;if(n<t.length){const i=t[n],r=i[me].firstChild;if(null!==r)return Yr(i,r)}return t[yn]}function Bl(e,t,n,i,r,o,u){for(;null!=n;){const m=i[n.index],C=n.type;if(u&&0===t&&(m&&Et(nt(m),i),n.flags|=2),32!=(32&n.flags))if(8&C)Bl(e,t,n.child,i,r,o,!1),Gi(t,e,r,m,o);else if(32&C){const D=Pl(n,i);let E;for(;E=D();)Gi(t,e,r,E,o);Gi(t,e,r,m,o)}else 16&C?xd(e,t,i,n,r,o):Gi(t,e,r,m,o);n=u?n.projectionNext:n.next}}function Xr(e,t,n,i,r,o){Bl(n,i,e.firstChild,t,r,o,!1)}function xd(e,t,n,i,r,o){const u=n[ft],C=u[St].projection[i.projection];if(Array.isArray(C))for(let D=0;D<C.length;D++)Gi(t,e,r,C[D],o);else{let D=C;const E=u[ot];us(i)&&(D.flags|=128),Bl(e,t,D,E,r,o,!0)}}function Md(e,t,n){""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}function Id(e,t,n){const{mergedAttrs:i,classes:r,styles:o}=n;null!==i&&Ya(e,t,i),null!==r&&Md(e,t,r),null!==o&&function _w(e,t,n){e.setAttribute(t,"style",n)}(e,t,o)}class Fd{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Fe{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Ke({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const ws=new Fe("ENVIRONMENT_INITIALIZER"),Ud=new Fe("INJECTOR",-1),zd=new Fe("INJECTOR_DEF_TYPES");class Yl{get(t,n=Dr){if(n===Dr){const i=new Error(`NullInjectorError: No provider for ${gt(t)}!`);throw i.name="NullInjectorError",i}return n}}function Yw(...e){return{\u0275providers:Wd(0,e),\u0275fromNgModule:!0}}function Wd(e,...t){const n=[],i=new Set;let r;const o=u=>{n.push(u)};return Ui(t,u=>{const m=u;bs(m,o,[],i)&&(r||=[],r.push(m))}),void 0!==r&&Gd(r,o),n}function Gd(e,t){for(let n=0;n<e.length;n++){const{ngModule:i,providers:r}=e[n];Xl(r,o=>{t(o,i)})}}function bs(e,t,n,i){if(!(e=Me(e)))return!1;let r=null,o=Ro(e);const u=!o&&Ue(e);if(o||u){if(u&&!u.standalone)return!1;r=e}else{const C=e.ngModule;if(o=Ro(C),!o)return!1;r=C}const m=i.has(r);if(u){if(m)return!1;if(i.add(r),u.dependencies){const C="function"==typeof u.dependencies?u.dependencies():u.dependencies;for(const D of C)bs(D,t,n,i)}}else{if(!o)return!1;{if(null!=o.imports&&!m){let D;i.add(r);try{Ui(o.imports,E=>{bs(E,t,n,i)&&(D||=[],D.push(E))})}finally{}void 0!==D&&Gd(D,t)}if(!m){const D=ai(r)||(()=>new r);t({provide:r,useFactory:D,deps:$e},r),t({provide:zd,useValue:r,multi:!0},r),t({provide:ws,useValue:()=>He(r),multi:!0},r)}const C=o.providers;if(null!=C&&!m){const D=e;Xl(C,E=>{t(E,D)})}}}return r!==e&&void 0!==e.providers}function Xl(e,t){for(let n of e)ka(n)&&(n=n.\u0275providers),Array.isArray(n)?Xl(n,t):t(n)}const Xw=Ze({provide:String,useValue:Ze});function ql(e){return null!==e&&"object"==typeof e&&Xw in e}function fi(e){return"function"==typeof e}const Zl=new Fe("Set Injector scope."),Ds={},Zw={};let Kl;function Ss(){return void 0===Kl&&(Kl=new Yl),Kl}class kn{}class Es extends kn{get destroyed(){return this._destroyed}constructor(t,n,i,r){super(),this.parent=n,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Jl(t,u=>this.processProvider(u)),this.records.set(Ud,Zi(void 0,this)),r.has("environment")&&this.records.set(kn,Zi(void 0,this));const o=this.records.get(Zl);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(zd.multi,$e,Ve.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const n=Wn(this),i=Nt(void 0);try{return t()}finally{Wn(n),Nt(i)}}get(t,n=Dr,i=Ve.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(Pf))return t[Pf](this);i=Lo(i);const o=Wn(this),u=Nt(void 0);try{if(!(i&Ve.SkipSelf)){let C=this.records.get(t);if(void 0===C){const D=function tb(e){return"function"==typeof e||"object"==typeof e&&e instanceof Fe}(t)&&Fo(t);C=D&&this.injectableDefInScope(D)?Zi(Ql(t),Ds):null,this.records.set(t,C)}if(null!=C)return this.hydrate(t,C)}return(i&Ve.Self?Ss():this.parent).get(t,n=i&Ve.Optional&&n===Dr?null:n)}catch(m){if("NullInjectorError"===m.name){if((m[No]=m[No]||[]).unshift(gt(t)),o)throw m;return function X_(e,t,n,i){const r=e[No];throw t[If]&&r.unshift(t[If]),e.message=function q_(e,t,n,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let r=gt(t);if(Array.isArray(t))r=t.map(gt).join(" -> ");else if("object"==typeof t){let o=[];for(let u in t)if(t.hasOwnProperty(u)){let m=t[u];o.push(u+":"+("string"==typeof m?JSON.stringify(m):gt(m)))}r=`{${o.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${e.replace(z_,"\n  ")}`}("\n"+e.message,r,n,i),e.ngTokenPath=r,e[No]=null,e}(m,t,"R3InjectorError",this.source)}throw m}finally{Nt(u),Wn(o)}}resolveInjectorInitializers(){const t=Wn(this),n=Nt(void 0);try{const r=this.get(ws.multi,$e,Ve.Self);for(const o of r)o()}finally{Wn(t),Nt(n)}}toString(){const t=[],n=this.records;for(const i of n.keys())t.push(gt(i));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ye(205,!1)}processProvider(t){let n=fi(t=Me(t))?t:Me(t&&t.provide);const i=function Qw(e){return ql(e)?Zi(void 0,e.useValue):Zi(function qd(e,t,n){let i;if(fi(e)){const r=Me(e);return ai(r)||Ql(r)}if(ql(e))i=()=>Me(e.useValue);else if(function Xd(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...$a(e.deps||[]));else if(function Yd(e){return!(!e||!e.useExisting)}(e))i=()=>He(Me(e.useExisting));else{const r=Me(e&&(e.useClass||e.provide));if(!function Jw(e){return!!e.deps}(e))return ai(r)||Ql(r);i=()=>new r(...$a(e.deps))}return i}(e),Ds)}(t);if(fi(t)||!0!==t.multi)this.records.get(n);else{let r=this.records.get(n);r||(r=Zi(void 0,Ds,!0),r.factory=()=>$a(r.multi),this.records.set(n,r)),n=t,r.multi.push(t)}this.records.set(n,i)}hydrate(t,n){return n.value===Ds&&(n.value=Zw,n.value=n.factory()),"object"==typeof n.value&&n.value&&function eb(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(t){if(!t.providedIn)return!1;const n=Me(t.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(t){const n=this._onDestroyHooks.indexOf(t);-1!==n&&this._onDestroyHooks.splice(n,1)}}function Ql(e){const t=Fo(e),n=null!==t?t.factory:ai(e);if(null!==n)return n;if(e instanceof Fe)throw new ye(204,!1);if(e instanceof Function)return function Kw(e){const t=e.length;if(t>0)throw function zr(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}(t,"?"),new ye(204,!1);const n=function B_(e){return e&&(e[ko]||e[Ef])||null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new ye(204,!1)}function Zi(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function Jl(e,t){for(const n of e)Array.isArray(n)?Jl(n,t):n&&ka(n)?Jl(n.\u0275providers,t):t(n)}const Ts=new Fe("AppId",{providedIn:"root",factory:()=>nb}),nb="ng",Zd=new Fe("Platform Initializer"),Ki=new Fe("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Kd=new Fe("CSP nonce",{providedIn:"root",factory:()=>function Xi(){if(void 0!==Hl)return Hl;if(typeof document<"u")return document;throw new ye(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Qd=(e,t,n)=>null;function ac(e,t,n=!1){return Qd(e,t,n)}class hb{}class tg{}class gb{resolveComponentFactory(t){throw function db(e){const t=Error(`No component factory found for ${gt(e)}.`);return t.ngComponent=e,t}(t)}}let Ps=(()=>{class t{}return t.NULL=new gb,t})();function pb(){return er(wt(),ie())}function er(e,t){return new hi(Bt(e,t))}let hi=(()=>{class t{constructor(i){this.nativeElement=i}}return t.__NG_ELEMENT_ID__=pb,t})();function mb(e){return e instanceof hi?e.nativeElement:e}class ig{}let yb=(()=>{var e;class t{}return(e=t).\u0275prov=Ke({token:e,providedIn:"root",factory:()=>null}),t})();class uc{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const _b=new uc("16.2.5"),fc={};function lg(e,t=null,n=null,i){const r=cg(e,t,n,i);return r.resolveInjectorInitializers(),r}function cg(e,t=null,n=null,i,r=new Set){const o=[n||$e,Yw(e)];return i=i||("object"==typeof e?void 0:gt(e)),new Es(o,t||Ss(),i||null,r)}let bn=(()=>{var e;class t{static create(i,r){if(Array.isArray(i))return lg({name:""},r,i,"");{const o=i.name??"";return lg({name:o},i.parent,i.providers,o)}}}return(e=t).THROW_IF_NOT_FOUND=Dr,e.NULL=new Yl,e.\u0275prov=Ke({token:e,providedIn:"any",factory:()=>He(Ud)}),e.__NG_ELEMENT_ID__=-1,t})();function dc(e){return e.ngOriginalError}class Nn{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t);this._console.error("ERROR",t),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&dc(t);for(;n&&dc(n);)n=dc(n);return n||null}}function pc(e){return t=>{setTimeout(e,void 0,t)}}const ae=class Tb extends R{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,i){let r=t,o=n||(()=>null),u=i;if(t&&"object"==typeof t){const C=t;r=C.next?.bind(C),o=C.error?.bind(C),u=C.complete?.bind(C)}this.__isAsync&&(o=pc(o),r&&(r=pc(r)),u&&(u=pc(u)));const m=super.subscribe({next:r,error:o,complete:u});return t instanceof kt&&t.add(m),m}};function fg(...e){}class at{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ae(!1),this.onMicrotaskEmpty=new ae(!1),this.onStable=new ae(!1),this.onError=new ae(!1),typeof Zone>"u")throw new ye(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&n,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function xb(){const e="function"==typeof et.requestAnimationFrame;let t=et[e?"requestAnimationFrame":"setTimeout"],n=et[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&t&&n){const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i);const r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function Ob(e){const t=()=>{!function Ib(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(et,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,vc(e),e.isCheckStableRunning=!0,mc(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),vc(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,o,u,m)=>{if(function Pb(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(m))return n.invokeTask(r,o,u,m);try{return hg(e),n.invokeTask(r,o,u,m)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||e.shouldCoalesceRunChangeDetection)&&t(),dg(e)}},onInvoke:(n,i,r,o,u,m,C)=>{try{return hg(e),n.invoke(r,o,u,m,C)}finally{e.shouldCoalesceRunChangeDetection&&t(),dg(e)}},onHasTask:(n,i,r,o)=>{n.hasTask(r,o),i===r&&("microTask"==o.change?(e._hasPendingMicrotasks=o.microTask,vc(e),mc(e)):"macroTask"==o.change&&(e.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,i,r,o)=>(n.handleError(r,o),e.runOutsideAngular(()=>e.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!at.isInAngularZone())throw new ye(909,!1)}static assertNotInAngularZone(){if(at.isInAngularZone())throw new ye(909,!1)}run(t,n,i){return this._inner.run(t,n,i)}runTask(t,n,i,r){const o=this._inner,u=o.scheduleEventTask("NgZoneEvent: "+r,t,Mb,fg,fg);try{return o.runTask(u,n,i)}finally{o.cancelTask(u)}}runGuarded(t,n,i){return this._inner.runGuarded(t,n,i)}runOutsideAngular(t){return this._outer.run(t)}}const Mb={};function mc(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function vc(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function hg(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function dg(e){e._nesting--,mc(e)}class Ab{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ae,this.onMicrotaskEmpty=new ae,this.onStable=new ae,this.onError=new ae}run(t,n,i){return t.apply(n,i)}runGuarded(t,n,i){return t.apply(n,i)}runOutsideAngular(t){return t()}runTask(t,n,i,r){return t.apply(n,i)}}const gg=new Fe("",{providedIn:"root",factory:pg});function pg(){const e=tt(at);let t=!0;return x_(new ve(r=>{t=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{r.next(t),r.complete()})}),new ve(r=>{let o;e.runOutsideAngular(()=>{o=e.onStable.subscribe(()=>{at.assertNotInAngularZone(),queueMicrotask(()=>{!t&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(t=!0,r.next(!0))})})});const u=e.onUnstable.subscribe(()=>{at.assertInAngularZone(),t&&(t=!1,e.runOutsideAngular(()=>{r.next(!1)}))});return()=>{o.unsubscribe(),u.unsubscribe()}}).pipe(bf()))}let yc=(()=>{var e;class t{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}}return(e=t).\u0275prov=Ke({token:e,providedIn:"root",factory:()=>new e}),t})();function eo(e){for(;e;){e[ke]|=64;const t=Gr(e);if(Ka(e)&&!t)return e;e=t}return null}const Cg=new Fe("",{providedIn:"root",factory:()=>!1});let Rs=null;function Sg(e,t){return e[t]??xg()}function Eg(e,t){const n=xg();n.producerNode?.length&&(e[t]=Rs,n.lView=e,Rs=Tg())}const Ub={...$o,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{eo(e.lView)},lView:null};function Tg(){return Object.create(Ub)}function xg(){return Rs??=Tg(),Rs}const Re={};function to(e){Mg(ze(),ie(),Ot()+e,!1)}function Mg(e,t,n,i){if(!i)if(3==(3&t[ke])){const o=e.preOrderCheckHooks;null!==o&&Qo(t,o,n)}else{const o=e.preOrderHooks;null!==o&&Jo(t,o,0,n)}li(n)}function Ne(e,t=Ve.Default){const n=ie();return null===n?He(e,t):Vh(wt(),n,Me(e),t)}function ks(e,t,n,i,r,o,u,m,C,D,E){const x=t.blueprint.slice();return x[lt]=r,x[ke]=140|i,(null!==D||e&&2048&e[ke])&&(x[ke]|=2048),ph(x),x[ot]=x[xi]=e,x[ut]=n,x[Ti]=u||e&&e[Ti],x[Pe]=m||e&&e[Pe],x[Gn]=C||e&&e[Gn]||null,x[St]=o,x[Ar]=function X0(){return Y0++}(),x[An]=E,x[Wf]=D,x[ft]=2==t.type?e[ft]:x,x}function ir(e,t,n,i,r){let o=e.data[t];if(null===o)o=function _c(e,t,n,i,r){const o=wh(),u=ol(),C=e.data[t]=function Kb(e,t,n,i,r,o){let u=t?t.injectorIndex:-1,m=0;return function Pi(){return null!==Ee.skipHydrationRootTNode}()&&(m|=128),{type:n,index:i,insertBeforeIndex:null,injectorIndex:u,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:m,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,u?o:o&&o.parent,n,t,i,r);return null===e.firstChild&&(e.firstChild=C),null!==o&&(u?null==o.child&&null!==C.parent&&(o.child=C):null===o.next&&(o.next=C,C.prev=o)),C}(e,t,n,i,r),function WC(){return Ee.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=n,o.value=i,o.attrs=r;const u=function Lr(){const e=Ee.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();o.injectorIndex=null===u?-1:u.injectorIndex}return Cn(o,!0),o}function no(e,t,n,i){if(0===n)return-1;const r=t.length;for(let o=0;o<n;o++)t.push(i),e.blueprint.push(i),e.data.push(null);return r}function Ig(e,t,n,i,r){const o=Sg(t,Pr),u=Ot(),m=2&i;try{li(-1),m&&t.length>je&&Mg(e,t,je,!1),_n(m?2:0,r);const D=m?o:null,E=Wo(D);try{null!==D&&(D.dirty=!1),n(i,r)}finally{Go(D,E)}}finally{m&&null===t[Pr]&&Eg(t,Pr),li(u),_n(m?3:1,r)}}function Cc(e,t,n){if(Za(t)){const i=Jt(null);try{const o=t.directiveEnd;for(let u=t.directiveStart;u<o;u++){const m=e.data[u];m.contentQueries&&m.contentQueries(1,n[u],u)}}finally{Jt(i)}}}function wc(e,t,n){Ch()&&(function rD(e,t,n,i){const r=n.directiveStart,o=n.directiveEnd;si(n)&&function fD(e,t,n){const i=Bt(t,e),r=Og(n);let u=16;n.signals?u=4096:n.onPush&&(u=64);const m=Ns(e,ks(e,r,null,u,i,t,null,e[Ti].rendererFactory.createRenderer(i,n),null,null,null));e[t.index]=m}(t,n,e.data[r+n.componentOffset]),e.firstCreatePass||ts(n,t),Et(i,t);const u=n.initialInputs;for(let m=r;m<o;m++){const C=e.data[m],D=ci(t,e,m,n);Et(D,t),null!==u&&hD(0,m-r,D,C,0,u),ln(C)&&(Xt(n.index,t)[ut]=ci(t,e,m,n))}}(e,t,n,Bt(n,t)),64==(64&n.flags)&&kg(e,t,n))}function bc(e,t,n=Bt){const i=t.localNames;if(null!==i){let r=t.index+1;for(let o=0;o<i.length;o+=2){const u=i[o+1],m=-1===u?n(t,e):e[u];e[r++]=m}}}function Og(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Dc(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}function Dc(e,t,n,i,r,o,u,m,C,D,E){const x=je+i,A=x+r,k=function Wb(e,t){const n=[];for(let i=0;i<t;i++)n.push(i<e?null:Re);return n}(x,A),z="function"==typeof D?D():D;return k[me]={type:e,blueprint:k,template:n,queries:null,viewQuery:m,declTNode:t,data:k.slice().fill(null,x),bindingStartIndex:x,expandoStartIndex:A,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof u?u():u,firstChild:null,schemas:C,consts:z,incompleteFirstPass:!1,ssrId:E}}let Ag=e=>null;function Pg(e,t,n,i){for(let r in e)if(e.hasOwnProperty(r)){n=null===n?{}:n;const o=e[r];null===i?Fg(n,t,r,o):i.hasOwnProperty(r)&&Fg(n,t,i[r],o)}return n}function Fg(e,t,n,i){e.hasOwnProperty(n)?e[n].push(t,i):e[n]=[t,i]}function Sc(e,t,n,i){if(Ch()){const r=null===i?null:{"":-1},o=function sD(e,t){const n=e.directiveRegistry;let i=null,r=null;if(n)for(let o=0;o<n.length;o++){const u=n[o];if(Bf(t,u.selectors,!1))if(i||(i=[]),ln(u))if(null!==u.findHostDirectiveDefs){const m=[];r=r||new Map,u.findHostDirectiveDefs(u,m,r),i.unshift(...m,u),Ec(e,t,m.length)}else i.unshift(u),Ec(e,t,0);else r=r||new Map,u.findHostDirectiveDefs?.(u,i,r),i.push(u)}return null===i?null:[i,r]}(e,n);let u,m;null===o?u=m=null:[u,m]=o,null!==u&&Rg(e,t,n,u,r,m),r&&function aD(e,t,n){if(t){const i=e.localNames=[];for(let r=0;r<t.length;r+=2){const o=n[t[r+1]];if(null==o)throw new ye(-301,!1);i.push(t[r],o)}}}(n,i,r)}n.mergedAttrs=Tr(n.mergedAttrs,n.attrs)}function Rg(e,t,n,i,r,o){for(let D=0;D<i.length;D++)vl(ts(n,t),e,i[D].type);!function cD(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}(n,e.data.length,i.length);for(let D=0;D<i.length;D++){const E=i[D];E.providersResolver&&E.providersResolver(E)}let u=!1,m=!1,C=no(e,t,i.length,null);for(let D=0;D<i.length;D++){const E=i[D];n.mergedAttrs=Tr(n.mergedAttrs,E.hostAttrs),uD(e,n,t,C,E),lD(C,E,r),null!==E.contentQueries&&(n.flags|=4),(null!==E.hostBindings||null!==E.hostAttrs||0!==E.hostVars)&&(n.flags|=64);const x=E.type.prototype;!u&&(x.ngOnChanges||x.ngOnInit||x.ngDoCheck)&&((e.preOrderHooks??=[]).push(n.index),u=!0),!m&&(x.ngOnChanges||x.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(n.index),m=!0),C++}!function Qb(e,t,n){const r=t.directiveEnd,o=e.data,u=t.attrs,m=[];let C=null,D=null;for(let E=t.directiveStart;E<r;E++){const x=o[E],A=n?n.get(x):null,z=A?A.outputs:null;C=Pg(x.inputs,E,C,A?A.inputs:null),D=Pg(x.outputs,E,D,z);const q=null===C||null===u||jf(t)?null:dD(C,E,u);m.push(q)}null!==C&&(C.hasOwnProperty("class")&&(t.flags|=8),C.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=m,t.inputs=C,t.outputs=D}(e,n,o)}function kg(e,t,n){const i=n.directiveStart,r=n.directiveEnd,o=n.index,u=function YC(){return Ee.lFrame.currentDirectiveIndex}();try{li(o);for(let m=i;m<r;m++){const C=e.data[m],D=t[m];al(m),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&oD(C,D)}}finally{li(-1),al(u)}}function oD(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Ec(e,t,n){t.componentOffset=n,(e.components??=[]).push(t.index)}function lD(e,t,n){if(n){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)n[t.exportAs[i]]=e;ln(t)&&(n[""]=e)}}function uD(e,t,n,i,r){e.data[i]=r;const o=r.factory||(r.factory=ai(r.type)),u=new jr(o,ln(r),Ne);e.blueprint[i]=u,n[i]=u,function nD(e,t,n,i,r){const o=r.hostBindings;if(o){let u=e.hostBindingOpCodes;null===u&&(u=e.hostBindingOpCodes=[]);const m=~t.index;(function iD(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(u)!=m&&u.push(m),u.push(n,i,o)}}(e,t,i,no(e,n,r.hostVars,Re),r)}function hD(e,t,n,i,r,o){const u=o[t];if(null!==u)for(let m=0;m<u.length;)Ng(i,n,u[m++],u[m++],u[m++])}function Ng(e,t,n,i,r){const o=Jt(null);try{const u=e.inputTransforms;null!==u&&u.hasOwnProperty(i)&&(r=u[i].call(t,r)),null!==e.setInput?e.setInput(t,r,n,i):t[i]=r}finally{Jt(o)}}function dD(e,t,n){let i=null,r=0;for(;r<n.length;){const o=n[r];if(0!==o)if(5!==o){if("number"==typeof o)break;if(e.hasOwnProperty(o)){null===i&&(i=[]);const u=e[o];for(let m=0;m<u.length;m+=2)if(u[m]===t){i.push(o,u[m+1],n[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function Lg(e,t,n,i){return[e,!0,!1,t,null,0,i,n,null,null,null]}function jg(e,t){const n=e.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const o=n[i+1];if(-1!==o){const u=e.data[o];cl(n[i]),u.contentQueries(2,t[o],o)}}}function Ns(e,t){return e[Ir]?e[$f][an]=t:e[Ir]=t,e[$f]=t,t}function xc(e,t,n){cl(0);const i=Jt(null);try{t(e,n)}finally{Jt(i)}}function Bg(e){return e[Ei]||(e[Ei]=[])}function Vg(e){return e.cleanup||(e.cleanup=[])}function Ug(e,t){const n=e[Gn],i=n?n.get(Nn,null):null;i&&i.handleError(t)}function Mc(e,t,n,i,r){for(let o=0;o<n.length;){const u=n[o++],m=n[o++];Ng(e.data[u],t[u],i,m,r)}}function gD(e,t){const n=Xt(t,e),i=n[me];!function pD(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(i,n);const r=n[lt];null!==r&&null===n[An]&&(n[An]=ac(r,n[Gn])),Ic(i,n,n[ut])}function Ic(e,t,n){ul(t);try{const i=e.viewQuery;null!==i&&xc(1,i,n);const r=e.template;null!==r&&Ig(e,t,r,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&jg(e,t),e.staticViewQueries&&xc(2,e.viewQuery,n);const o=e.components;null!==o&&function mD(e,t){for(let n=0;n<t.length;n++)gD(e,t[n])}(t,o)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{t[ke]&=-5,fl()}}let zg=(()=>{var e;class t{constructor(){this.all=new Set,this.queue=new Map}create(i,r,o){const u=typeof Zone>"u"?null:Zone.current,m=function DC(e,t,n){const i=Object.create(SC);n&&(i.consumerAllowSignalWrites=!0),i.fn=e,i.schedule=t;const r=u=>{i.cleanupFn=u};return i.ref={notify:()=>Jf(i),run:()=>{if(i.dirty=!1,i.hasRun&&!eh(i))return;i.hasRun=!0;const u=Wo(i);try{i.cleanupFn(),i.cleanupFn=lh,i.fn(r)}finally{Go(i,u)}},cleanup:()=>i.cleanupFn()},i.ref}(i,E=>{this.all.has(E)&&this.queue.set(E,u)},o);let C;this.all.add(m),m.notify();const D=()=>{m.cleanup(),C?.(),this.all.delete(m),this.queue.delete(m)};return C=r?.onDestroy(D),{destroy:D}}flush(){if(0!==this.queue.size)for(const[i,r]of this.queue)this.queue.delete(i),r?r.run(()=>i.run()):i.run()}get isQueueEmpty(){return 0===this.queue.size}}return(e=t).\u0275prov=Ke({token:e,providedIn:"root",factory:()=>new e}),t})();function Ls(e,t,n){let i=n?e.styles:null,r=n?e.classes:null,o=0;if(null!==t)for(let u=0;u<t.length;u++){const m=t[u];"number"==typeof m?o=m:1==o?r=Pa(r,m):2==o&&(i=Pa(i,m+": "+t[++u]+";"))}n?e.styles=i:e.stylesWithoutHost=i,n?e.classes=r:e.classesWithoutHost=r}function io(e,t,n,i,r=!1){for(;null!==n;){const o=t[n.index];null!==o&&i.push(nt(o)),Mt(o)&&$g(o,i);const u=n.type;if(8&u)io(e,t,n.child,i);else if(32&u){const m=Pl(n,t);let C;for(;C=m();)i.push(C)}else if(16&u){const m=Ed(t,n);if(Array.isArray(m))i.push(...m);else{const C=Gr(t[ft]);io(C[me],C,m,i,!0)}}n=r?n.projectionNext:n.next}return i}function $g(e,t){for(let n=_t;n<e.length;n++){const i=e[n],r=i[me].firstChild;null!==r&&io(i[me],i,r,t)}e[yn]!==e[lt]&&t.push(e[yn])}function js(e,t,n,i=!0){const r=t[Ti],o=r.rendererFactory,u=r.afterRenderEventManager;o.begin?.(),u?.begin();try{Wg(e,t,e.template,n)}catch(C){throw i&&Ug(t,C),C}finally{o.end?.(),r.effectManager?.flush(),u?.end()}}function Wg(e,t,n,i){const r=t[ke];if(256!=(256&r)){t[Ti].effectManager?.flush(),ul(t);try{ph(t),function Dh(e){return Ee.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&Ig(e,t,n,2,i);const u=3==(3&r);if(u){const D=e.preOrderCheckHooks;null!==D&&Qo(t,D,null)}else{const D=e.preOrderHooks;null!==D&&Jo(t,D,0,null),hl(t,0)}if(function _D(e){for(let t=dd(e);null!==t;t=gd(t)){if(!t[Gf])continue;const n=t[Ii];for(let i=0;i<n.length;i++){RC(n[i])}}}(t),Gg(t,2),null!==e.contentQueries&&jg(e,t),u){const D=e.contentCheckHooks;null!==D&&Qo(t,D)}else{const D=e.contentHooks;null!==D&&Jo(t,D,1),hl(t,1)}!function $b(e,t){const n=e.hostBindingOpCodes;if(null===n)return;const i=Sg(t,Fr);try{for(let r=0;r<n.length;r++){const o=n[r];if(o<0)li(~o);else{const u=o,m=n[++r],C=n[++r];GC(m,u),i.dirty=!1;const D=Wo(i);try{C(2,t[u])}finally{Go(i,D)}}}}finally{null===t[Fr]&&Eg(t,Fr),li(-1)}}(e,t);const m=e.components;null!==m&&Xg(t,m,0);const C=e.viewQuery;if(null!==C&&xc(2,C,i),u){const D=e.viewCheckHooks;null!==D&&Qo(t,D)}else{const D=e.viewHooks;null!==D&&Jo(t,D,2),hl(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[ke]&=-73,mh(t)}finally{fl()}}}function Gg(e,t){for(let n=dd(e);null!==n;n=gd(n))for(let i=_t;i<n.length;i++)Yg(n[i],t)}function CD(e,t,n){Yg(Xt(t,e),n)}function Yg(e,t){if(!function PC(e){return 128==(128&e[ke])}(e))return;const n=e[me],i=e[ke];if(80&i&&0===t||1024&i||2===t)Wg(n,e,n.template,e[ut]);else if(e[Mr]>0){Gg(e,1);const r=n.components;null!==r&&Xg(e,r,1)}}function Xg(e,t,n){for(let i=0;i<t.length;i++)CD(e,t[i],n)}class ro{get rootNodes(){const t=this._lView,n=t[me];return io(n,t,n.firstChild,[])}constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ut]}set context(t){this._lView[ut]=t}get destroyed(){return 256==(256&this._lView[ke])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[ot];if(Mt(t)){const n=t[8],i=n?n.indexOf(this):-1;i>-1&&(gs(t,i),rs(n,i))}this._attachedToViewContainer=!1}Rl(this._lView[me],this._lView)}onDestroy(t){!function yh(e,t){if(256==(256&e[ke]))throw new ye(911,!1);null===e[Yn]&&(e[Yn]=[]),e[Yn].push(t)}(this._lView,t)}markForCheck(){eo(this._cdRefInjectingView||this._lView)}detach(){this._lView[ke]&=-129}reattach(){this._lView[ke]|=128}detectChanges(){js(this._lView[me],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ye(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function lw(e,t){Xr(e,t,t[Pe],2,null,null)}(this._lView[me],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new ye(902,!1);this._appRef=t}}class wD extends ro{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;js(t[me],t,t[ut],!1)}checkNoChanges(){}get context(){return null}}class qg extends Ps{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=Ue(t);return new oo(n,this.ngModule)}}function Zg(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}class DD{constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,i){i=Lo(i);const r=this.injector.get(t,fc,i);return r!==fc||n===fc?r:this.parentInjector.get(t,n,i)}}class oo extends tg{get inputs(){const t=this.componentDef,n=t.inputTransforms,i=Zg(t.inputs);if(null!==n)for(const r of i)n.hasOwnProperty(r.propName)&&(r.transform=n[r.propName]);return i}get outputs(){return Zg(this.componentDef.outputs)}constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function oC(e){return e.map(rC).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}create(t,n,i,r){let o=(r=r||this.ngModule)instanceof kn?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const u=o?new DD(t,o):t,m=u.get(ig,null);if(null===m)throw new ye(407,!1);const x={rendererFactory:m,sanitizer:u.get(yb,null),effectManager:u.get(zg,null),afterRenderEventManager:u.get(yc,null)},A=m.createRenderer(null,this.componentDef),k=this.componentDef.selectors[0][0]||"div",z=i?function Gb(e,t,n,i){const o=i.get(Cg,!1)||n===on.ShadowDom,u=e.selectRootElement(t,o);return function Yb(e){Ag(e)}(u),u}(A,i,this.componentDef.encapsulation,u):ds(A,k,function bD(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(k)),ue=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let Z=null;null!==z&&(Z=ac(z,u,!0));const De=Dc(0,null,null,1,0,null,null,null,null,null,null),Te=ks(null,De,null,ue,null,null,x,A,u,null,Z);let Be,zt;ul(Te);try{const zn=this.componentDef;let wr,rf=null;zn.findHostDirectiveDefs?(wr=[],rf=new Map,zn.findHostDirectiveDefs(zn,wr,rf),wr.push(zn)):wr=[zn];const LO=function ED(e,t){const n=e[me],i=je;return e[i]=t,ir(n,i,2,"#host",null)}(Te,z),jO=function TD(e,t,n,i,r,o,u){const m=r[me];!function xD(e,t,n,i){for(const r of e)t.mergedAttrs=Tr(t.mergedAttrs,r.hostAttrs);null!==t.mergedAttrs&&(Ls(t,t.mergedAttrs,!0),null!==n&&Id(i,n,t))}(i,e,t,u);let C=null;null!==t&&(C=ac(t,r[Gn]));const D=o.rendererFactory.createRenderer(t,n);let E=16;n.signals?E=4096:n.onPush&&(E=64);const x=ks(r,Og(n),null,E,r[e.index],e,o,D,null,null,C);return m.firstCreatePass&&Ec(m,e,i.length-1),Ns(r,x),r[e.index]=x}(LO,z,zn,wr,Te,x,A);zt=gh(De,je),z&&function ID(e,t,n,i){if(i)Ya(e,n,["ng-version",_b.full]);else{const{attrs:r,classes:o}=function sC(e){const t=[],n=[];let i=1,r=2;for(;i<e.length;){let o=e[i];if("string"==typeof o)2===r?""!==o&&t.push(o,e[++i]):8===r&&n.push(o);else{if(!sn(r))break;r=o}i++}return{attrs:t,classes:n}}(t.selectors[0]);r&&Ya(e,n,r),o&&o.length>0&&Md(e,n,o.join(" "))}}(A,zn,z,i),void 0!==n&&function OD(e,t,n){const i=e.projection=[];for(let r=0;r<t.length;r++){const o=n[r];i.push(null!=o?Array.from(o):null)}}(zt,this.ngContentSelectors,n),Be=function MD(e,t,n,i,r,o){const u=wt(),m=r[me],C=Bt(u,r);Rg(m,r,u,n,null,i);for(let E=0;E<n.length;E++)Et(ci(r,m,u.directiveStart+E,u),r);kg(m,r,u),C&&Et(C,r);const D=ci(r,m,u.directiveStart+u.componentOffset,u);if(e[ut]=r[ut]=D,null!==o)for(const E of o)E(D,t);return Cc(m,u,e),D}(jO,zn,wr,rf,Te,[AD]),Ic(De,Te,null)}finally{fl()}return new SD(this.componentType,Be,er(zt,Te),Te,zt)}}class SD extends hb{constructor(t,n,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new wD(r),this.componentType=t}setInput(t,n){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),n))return;const o=this._rootLView;Mc(o[me],o,r,t,n),this.previousInputValues.set(t,n),eo(Xt(this._tNode.index,o))}}get injector(){return new At(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function AD(){const e=wt();Ko(ie()[me],e)}function Oc(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Tt(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function Nc(e,t,n,i,r,o,u,m){const C=ie(),D=ze(),E=e+je,x=D.firstCreatePass?function aS(e,t,n,i,r,o,u,m,C){const D=t.consts,E=ir(t,e,4,u||null,qn(D,m));Sc(t,n,E,qn(D,C)),Ko(t,E);const x=E.tView=Dc(2,E,i,r,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,D,null);return null!==t.queries&&(t.queries.template(t,E),x.queries=t.queries.embeddedTView(E)),E}(E,D,C,t,n,i,r,o,u):D.data[E];Cn(x,!1);const A=pp(D,C,x,e);Zo()&&ms(D,C,A,x),Et(A,C),Ns(C,C[E]=Lg(A,C,A,x)),Uo(x)&&wc(D,C,x),null!=u&&bc(C,x,m)}let pp=function mp(e,t,n,i){return Zn(!0),t[Pe].createComment("")};function gi(e,t,n){const i=ie();return Tt(i,ki(),t)&&function Zt(e,t,n,i,r,o,u,m){const C=Bt(t,n);let E,D=t.inputs;!m&&null!=D&&(E=D[i])?(Mc(e,n,E,i,r),si(t)&&function eD(e,t){const n=Xt(t,e);16&n[ke]||(n[ke]|=64)}(n,t.index)):3&t.type&&(i=function Jb(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=u?u(r,t.value||"",i):r,o.setProperty(C,i,r))}(ze(),function st(){const e=Ee.lFrame;return gh(e.tView,e.selectedIndex)}(),i,e,t,i[Pe],n,!1),gi}function Lc(e,t,n,i,r){const u=r?"class":"style";Mc(e,n,t.inputs[u],u,i)}function bt(e,t,n,i){const r=ie(),o=ze(),u=je+e,m=r[Pe],C=o.firstCreatePass?function hS(e,t,n,i,r,o){const u=t.consts,C=ir(t,e,2,i,qn(u,r));return Sc(t,n,C,qn(u,o)),null!==C.attrs&&Ls(C,C.attrs,!1),null!==C.mergedAttrs&&Ls(C,C.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,C),C}(u,o,r,t,n,i):o.data[u],D=yp(o,r,C,m,t,e);r[u]=D;const E=Uo(C);return Cn(C,!0),Id(m,D,C),32!=(32&C.flags)&&Zo()&&ms(o,r,D,C),0===function NC(){return Ee.lFrame.elementDepthCount}()&&Et(D,r),function LC(){Ee.lFrame.elementDepthCount++}(),E&&(wc(o,r,C),Cc(o,C,r)),null!==i&&bc(r,C),bt}function Dt(){let e=wt();ol()?function sl(){Ee.lFrame.isParent=!1}():(e=e.parent,Cn(e,!1));const t=e;(function BC(e){return Ee.skipHydrationRootTNode===e})(t)&&function zC(){Ee.skipHydrationRootTNode=null}(),function jC(){Ee.lFrame.elementDepthCount--}();const n=ze();return n.firstCreatePass&&(Ko(n,e),Za(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function o0(e){return 0!=(8&e.flags)}(t)&&Lc(n,t,ie(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function s0(e){return 0!=(16&e.flags)}(t)&&Lc(n,t,ie(),t.stylesWithoutHost,!1),Dt}let yp=(e,t,n,i,r,o)=>(Zn(!0),ds(i,r,function Ah(){return Ee.lFrame.currentNamespace}()));function Vc(){return ie()}function Hc(e){return!!e&&"function"==typeof e.then}function wp(e){return!!e&&"function"==typeof e.subscribe}function cn(e,t,n,i){const r=ie(),o=ze(),u=wt();return function Dp(e,t,n,i,r,o,u){const m=Uo(i),D=e.firstCreatePass&&Vg(e),E=t[ut],x=Bg(t);let A=!0;if(3&i.type||u){const q=Bt(i,t),se=u?u(q):q,ue=x.length,Z=u?Te=>u(nt(Te[i.index])):i.index;let De=null;if(!u&&m&&(De=function yS(e,t,n,i){const r=e.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const u=r[o];if(u===n&&r[o+1]===i){const m=t[Ei],C=r[o+2];return m.length>C?m[C]:null}"string"==typeof u&&(o+=2)}return null}(e,t,r,i.index)),null!==De)(De.__ngLastListenerFn__||De).__ngNextListenerFn__=o,De.__ngLastListenerFn__=o,A=!1;else{o=Ep(i,t,E,o,!1);const Te=n.listen(se,r,o);x.push(o,Te),D&&D.push(r,Z,ue,ue+1)}}else o=Ep(i,t,E,o,!1);const k=i.outputs;let z;if(A&&null!==k&&(z=k[r])){const q=z.length;if(q)for(let se=0;se<q;se+=2){const Be=t[z[se]][z[se+1]].subscribe(o),zt=x.length;x.push(o,Be),D&&D.push(r,i.index,zt,-(zt+1))}}}(o,r,r[Pe],u,e,t,i),cn}function Sp(e,t,n,i){try{return _n(6,t,n),!1!==n(i)}catch(r){return Ug(e,r),!1}finally{_n(7,t,n)}}function Ep(e,t,n,i,r){return function o(u){if(u===Function)return i;eo(e.componentOffset>-1?Xt(e.index,t):t);let C=Sp(t,n,i,u),D=o.__ngNextListenerFn__;for(;D;)C=Sp(t,n,D,u)&&C,D=D.__ngNextListenerFn__;return r&&!1===C&&u.preventDefault(),C}}function Jn(e=1){return function qC(e){return(Ee.lFrame.contextLView=function ZC(e,t){for(;e>0;)t=t[xi],e--;return t}(e,Ee.lFrame.contextLView))[ut]}(e)}function Ws(e,t){return e<<17|t<<2}function ei(e){return e>>17&32767}function zc(e){return 2|e}function pi(e){return(131068&e)>>2}function $c(e,t){return-131069&e|t<<2}function Wc(e){return 1|e}function kp(e,t,n,i,r){const o=e[n+1],u=null===t;let m=i?ei(o):pi(o),C=!1;for(;0!==m&&(!1===C||u);){const E=e[m+1];xS(e[m],t)&&(C=!0,e[m+1]=i?Wc(E):zc(E)),m=i?ei(E):pi(E)}C&&(e[n+1]=i?zc(o):Wc(o))}function xS(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&zi(e,t)>=0}function Gc(e,t){return function un(e,t,n,i){const r=ie(),o=ze(),u=function Fn(e){const t=Ee.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}(2);o.firstUpdatePass&&function $p(e,t,n,i){const r=e.data;if(null===r[n+1]){const o=r[Ot()],u=function zp(e,t){return t>=e.expandoStartIndex}(e,n);(function Xp(e,t){return 0!=(e.flags&(t?8:16))})(o,i)&&null===t&&!u&&(t=!1),t=function NS(e,t,n,i){const r=function ll(e){const t=Ee.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let o=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(n=uo(n=Yc(null,e,t,n,i),t.attrs,i),o=null);else{const u=t.directiveStylingLast;if(-1===u||e[u]!==r)if(n=Yc(r,e,t,n,i),null===o){let C=function LS(e,t,n){const i=n?t.classBindings:t.styleBindings;if(0!==pi(i))return e[ei(i)]}(e,t,i);void 0!==C&&Array.isArray(C)&&(C=Yc(null,e,t,C[1],i),C=uo(C,t.attrs,i),function jS(e,t,n,i){e[ei(n?t.classBindings:t.styleBindings)]=i}(e,t,i,C))}else o=function BS(e,t,n){let i;const r=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<r;o++)i=uo(i,e[o].hostAttrs,n);return uo(i,t.attrs,n)}(e,t,i)}return void 0!==o&&(i?t.residualClasses=o:t.residualStyles=o),n}(r,o,t,i),function ES(e,t,n,i,r,o){let u=o?t.classBindings:t.styleBindings,m=ei(u),C=pi(u);e[i]=n;let E,D=!1;if(Array.isArray(n)?(E=n[1],(null===E||zi(n,E)>0)&&(D=!0)):E=n,r)if(0!==C){const A=ei(e[m+1]);e[i+1]=Ws(A,m),0!==A&&(e[A+1]=$c(e[A+1],i)),e[m+1]=function DS(e,t){return 131071&e|t<<17}(e[m+1],i)}else e[i+1]=Ws(m,0),0!==m&&(e[m+1]=$c(e[m+1],i)),m=i;else e[i+1]=Ws(C,0),0===m?m=i:e[C+1]=$c(e[C+1],i),C=i;D&&(e[i+1]=zc(e[i+1])),kp(e,E,i,!0),kp(e,E,i,!1),function TS(e,t,n,i,r){const o=r?e.residualClasses:e.residualStyles;null!=o&&"string"==typeof t&&zi(o,t)>=0&&(n[i+1]=Wc(n[i+1]))}(t,E,e,i,o),u=Ws(m,C),o?t.classBindings=u:t.styleBindings=u}(r,o,t,n,u,i)}}(o,e,u,i),t!==Re&&Tt(r,u,t)&&function Gp(e,t,n,i,r,o,u,m){if(!(3&t.type))return;const C=e.data,D=C[m+1],E=function SS(e){return 1==(1&e)}(D)?Yp(C,t,n,r,pi(D),u):void 0;Gs(E)||(Gs(o)||function bS(e){return 2==(2&e)}(D)&&(o=Yp(C,null,n,r,m,u)),function yw(e,t,n,i,r){if(t)r?e.addClass(n,i):e.removeClass(n,i);else{let o=-1===i.indexOf("-")?void 0:Kn.DashCase;null==r?e.removeStyle(n,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Kn.Important),e.setStyle(n,i,r,o))}}(i,u,qo(Ot(),n),r,o))}(o,o.data[Ot()],r,r[Pe],e,r[u+1]=function zS(e,t){return null==e||""===e||("string"==typeof t?e+=t:"object"==typeof e&&(e=gt(function Qn(e){return e instanceof Fd?e.changingThisBreaksApplicationSecurity:e}(e)))),e}(t,n),i,u)}(e,t,null,!0),Gc}function Yc(e,t,n,i,r){let o=null;const u=n.directiveEnd;let m=n.directiveStylingLast;for(-1===m?m=n.directiveStart:m++;m<u&&(o=t[m],i=uo(i,o.hostAttrs,r),o!==e);)m++;return null!==e&&(n.directiveStylingLast=m),i}function uo(e,t,n){const i=n?1:2;let r=-1;if(null!==t)for(let o=0;o<t.length;o++){const u=t[o];"number"==typeof u?r=u:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),qt(e,u,!!n||t[++o]))}return void 0===e?null:e}function Yp(e,t,n,i,r,o){const u=null===t;let m;for(;r>0;){const C=e[r],D=Array.isArray(C),E=D?C[1]:C,x=null===E;let A=n[r+1];A===Re&&(A=x?$e:void 0);let k=x?wl(A,i):E===i?A:void 0;if(D&&!Gs(k)&&(k=wl(C,i)),Gs(k)&&(m=k,u))return m;const z=e[r+1];r=u?ei(z):pi(z)}if(null!==t){let C=o?t.residualClasses:t.residualStyles;null!=C&&(m=wl(C,i))}return m}function Gs(e){return void 0!==e}function hn(e,t=""){const n=ie(),i=ze(),r=e+je,o=i.firstCreatePass?ir(i,r,1,t,null):i.data[r],u=qp(i,n,o,t,e);n[r]=u,Zo()&&ms(i,n,u,o),Cn(o,!1)}let qp=(e,t,n,i,r)=>(Zn(!0),function hs(e,t){return e.createText(t)}(t[Pe],i));function Xc(e){return qc("",e,""),Xc}function qc(e,t,n){const i=ie(),r=function or(e,t,n,i){return Tt(e,ki(),n)?t+Ae(n)+i:Re}(i,e,t,n);return r!==Re&&function jn(e,t,n){const i=qo(t,e);!function md(e,t,n){e.setValue(t,n)}(e[Pe],i,n)}(i,Ot(),r),qc}const pr="en-US";let vm=pr;class vi{}class hT{}class nu extends vi{constructor(t,n,i){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new qg(this);const r=function Yt(e,t){const n=e[Af]||null;if(!n&&!0===t)throw new Error(`Type ${gt(e)} does not have '\u0275mod' property.`);return n}(t);this._bootstrapComponents=function Ln(e){return e instanceof Function?e():e}(r.bootstrap),this._r3Injector=cg(t,n,[{provide:vi,useValue:this},{provide:Ps,useValue:this.componentFactoryResolver},...i],gt(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class iu extends hT{constructor(t){super(),this.moduleType=t}create(t){return new nu(this.moduleType,t,[])}}function zT(){return this._results[Symbol.iterator]()}class ou{get changes(){return this._changes||(this._changes=new ae)}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=ou.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=zT)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){const i=this;i.dirty=!1;const r=function en(e){return e.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function w0(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],o=t[i];if(n&&(r=n(r),o=n(o)),o!==r)return!1}return!0}(i._results,r,n))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function WT(e,t,n,i=!0){const r=t[me];if(function uw(e,t,n,i){const r=_t+i,o=n.length;i>0&&(n[r-1][an]=t),i<o-_t?(t[an]=n[r],Gh(n,_t+i,t)):(n.push(t),t[an]=null),t[ot]=n;const u=t[Or];null!==u&&n!==u&&function fw(e,t){const n=e[Ii];t[ft]!==t[ot][ot][ft]&&(e[Gf]=!0),null===n?e[Ii]=[t]:n.push(t)}(u,t);const m=t[vn];null!==m&&m.insertView(e),t[ke]|=128}(r,t,e,n),i){const o=jl(n,e),u=t[Pe],m=ps(u,e[yn]);null!==m&&function aw(e,t,n,i,r,o){i[lt]=r,i[St]=t,Xr(e,i,n,1,r,o)}(r,e[St],u,t,m,o)}}let Bn=(()=>{class t{}return t.__NG_ELEMENT_ID__=XT,t})();const GT=Bn,YT=class extends GT{constructor(t,n,i){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,n){return this.createEmbeddedViewImpl(t,n)}createEmbeddedViewImpl(t,n,i){const r=function $T(e,t,n,i){const r=t.tView,m=ks(e,r,n,4096&e[ke]?4096:16,null,t,null,null,null,i?.injector??null,i?.hydrationInfo??null);m[Or]=e[t.index];const D=e[vn];return null!==D&&(m[vn]=D.createEmbeddedView(r)),Ic(r,m,n),m}(this._declarationLView,this._declarationTContainer,t,{injector:n,hydrationInfo:i});return new ro(r)}};function XT(){return Ks(wt(),ie())}function Ks(e,t){return 4&e.type?new YT(t,e,er(e,t)):null}let xn=(()=>{class t{}return t.__NG_ELEMENT_ID__=ex,t})();function ex(){return av(wt(),ie())}const tx=xn,ov=class extends tx{constructor(t,n,i){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=i}get element(){return er(this._hostTNode,this._hostLView)}get injector(){return new At(this._hostTNode,this._hostLView)}get parentInjector(){const t=ns(this._hostTNode,this._hostLView);if(gl(t)){const n=Vr(t,this._hostLView),i=Br(t);return new At(n[me].data[i+8],n)}return new At(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=sv(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-_t}createEmbeddedView(t,n,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const m=t.createEmbeddedViewImpl(n||{},o,null);return this.insertImpl(m,r,false),m}createComponent(t,n,i,r,o){const u=t&&!function Ur(e){return"function"==typeof e}(t);let m;if(u)m=n;else{const q=n||{};m=q.index,i=q.injector,r=q.projectableNodes,o=q.environmentInjector||q.ngModuleRef}const C=u?t:new oo(Ue(t)),D=i||this.parentInjector;if(!o&&null==C.ngModule){const se=(u?D:this.parentInjector).get(kn,null);se&&(o=se)}Ue(C.componentType??{});const k=C.create(D,r,null,o);return this.insertImpl(k.hostView,m,false),k}insert(t,n){return this.insertImpl(t,n,!1)}insertImpl(t,n,i){const r=t._lView;if(function FC(e){return Mt(e[ot])}(r)){const C=this.indexOf(t);if(-1!==C)this.detach(C);else{const D=r[ot],E=new ov(D,D[St],D[ot]);E.detach(E.indexOf(t))}}const u=this._adjustIndex(n),m=this._lContainer;return WT(m,r,u,!i),t.attachToViewContainerRef(),Gh(su(m),u,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=sv(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),i=gs(this._lContainer,n);i&&(rs(su(this._lContainer),n),Rl(i[me],i))}detach(t){const n=this._adjustIndex(t,-1),i=gs(this._lContainer,n);return i&&null!=rs(su(this._lContainer),n)?new ro(i):null}_adjustIndex(t,n=0){return t??this.length+n}};function sv(e){return e[8]}function su(e){return e[8]||(e[8]=[])}function av(e,t){let n;const i=t[e.index];return Mt(i)?n=i:(n=Lg(i,t,null,e),t[e.index]=n,Ns(t,n)),lv(n,t,e,i),new ov(n,e,t)}let lv=function cv(e,t,n,i){if(e[yn])return;let r;r=8&n.type?nt(i):function nx(e,t){const n=e[Pe],i=n.createComment(""),r=Bt(t,e);return ui(n,ps(n,r),i,function pw(e,t){return e.nextSibling(t)}(n,r),!1),i}(t,n),e[yn]=r};class au{constructor(t){this.queryList=t,this.matches=null}clone(){return new au(this.queryList)}setDirty(){this.queryList.setDirty()}}class lu{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const i=null!==t.contentQueries?t.contentQueries[0]:n.length,r=[];for(let o=0;o<i;o++){const u=n.getByIndex(o);r.push(this.queries[u.indexInDeclarationView].clone())}return new lu(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==gv(t,n).matches&&this.queries[n].setDirty()}}class uv{constructor(t,n,i=null){this.predicate=t,this.flags=n,this.read=i}}class cu{constructor(t=[]){this.queries=t}elementStart(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let i=0;i<this.length;i++){const r=null!==n?n.length:0,o=this.getByIndex(i).embeddedTView(t,r);o&&(o.indexInDeclarationView=i,null!==n?n.push(o):n=[o])}return null!==n?new cu(n):null}template(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class uu{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new uu(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==n;)i=i.parent;return n===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(t,n,ox(n,o)),this.matchTNodeWithReadOption(t,n,is(n,t,o,!1,!1))}else i===Bn?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,is(n,t,i,!1,!1))}matchTNodeWithReadOption(t,n,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===hi||r===xn||r===Bn&&4&n.type)this.addMatch(n.index,-2);else{const o=is(n,t,r,!1,!1);null!==o&&this.addMatch(n.index,o)}else this.addMatch(n.index,i)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function ox(e,t){const n=e.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===t)return n[i+1];return null}function ax(e,t,n,i){return-1===n?function sx(e,t){return 11&e.type?er(e,t):4&e.type?Ks(e,t):null}(t,e):-2===n?function lx(e,t,n){return n===hi?er(t,e):n===Bn?Ks(t,e):n===xn?av(t,e):void 0}(e,t,i):ci(e,e[me],n,t)}function fv(e,t,n,i){const r=t[vn].queries[i];if(null===r.matches){const o=e.data,u=n.matches,m=[];for(let C=0;C<u.length;C+=2){const D=u[C];m.push(D<0?null:ax(t,o[D],u[C+1],n.metadata.read))}r.matches=m}return r.matches}function fu(e,t,n,i){const r=e.queries.getByIndex(n),o=r.matches;if(null!==o){const u=fv(e,t,r,n);for(let m=0;m<o.length;m+=2){const C=o[m];if(C>0)i.push(u[m/2]);else{const D=o[m+1],E=t[-C];for(let x=_t;x<E.length;x++){const A=E[x];A[Or]===A[ot]&&fu(A[me],A,D,i)}if(null!==E[Ii]){const x=E[Ii];for(let A=0;A<x.length;A++){const k=x[A];fu(k[me],k,D,i)}}}}}return i}function Js(e){const t=ie(),n=ze(),i=Eh();cl(i+1);const r=gv(n,i);if(e.dirty&&function AC(e){return 4==(4&e[ke])}(t)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const o=r.crossesNgTemplate?fu(n,t,i,[]):fv(n,t,r,i);e.reset(o,mb),e.notifyOnChanges()}return!0}return!1}function ea(e,t,n){const i=ze();i.firstCreatePass&&(function dv(e,t,n){null===e.queries&&(e.queries=new cu),e.queries.track(new uu(t,n))}(i,new uv(e,t,n),-1),2==(2&t)&&(i.staticViewQueries=!0)),function hv(e,t,n){const i=new ou(4==(4&n));(function Zb(e,t,n,i){const r=Bg(t);r.push(n),e.firstCreatePass&&Vg(e).push(i,r.length-1)})(e,t,i,i.destroy),null===t[vn]&&(t[vn]=new lu),t[vn].queries.push(new au(i))}(i,ie(),t)}function ta(){return function ux(e,t){return e[vn].queries[t].queryList}(ie(),Eh())}function gv(e,t){return e.queries.getByIndex(t)}const Fx=new Fe("Application Initializer");let mu=(()=>{var e;class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r}),this.appInits=tt(Fx,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const i=[];for(const o of this.appInits){const u=o();if(Hc(u))i.push(u);else if(wp(u)){const m=new Promise((C,D)=>{u.subscribe({complete:C,error:D})});i.push(m)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(i).then(()=>{r()}).catch(o=>{this.reject(o)}),0===i.length&&r(),this.initialized=!0}}return(e=t).\u0275fac=function(i){return new(i||e)},e.\u0275prov=Ke({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const Vn=new Fe("LocaleId",{providedIn:"root",factory:()=>tt(Vn,Ve.Optional|Ve.SkipSelf)||function kx(){return typeof $localize<"u"&&$localize.locale||pr}()});let jx=(()=>{var e;class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new M_(!1)}add(){this.hasPendingTasks.next(!0);const i=this.taskId++;return this.pendingTasks.add(i),i}remove(i){this.pendingTasks.delete(i),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(e=t).\u0275fac=function(i){return new(i||e)},e.\u0275prov=Ke({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const kv=new Fe(""),ra=new Fe("");let wu,_u=(()=>{var e;class t{constructor(i,r,o){this._ngZone=i,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,wu||(function oM(e){wu=e}(o),o.addToWindow(r)),this._watchAngularEvents(),i.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{at.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let i=this._callbacks.pop();clearTimeout(i.timeoutId),i.doneCb(this._didWork)}this._didWork=!1});else{let i=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(i)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(i=>({source:i.source,creationLocation:i.creationLocation,data:i.data})):[]}addCallback(i,r,o){let u=-1;r&&r>0&&(u=setTimeout(()=>{this._callbacks=this._callbacks.filter(m=>m.timeoutId!==u),i(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:i,timeoutId:u,updateCb:o})}whenStable(i,r,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(i,r,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(i){this.registry.registerApplication(i,this)}unregisterApplication(i){this.registry.unregisterApplication(i)}findProviders(i,r,o){return[]}}return(e=t).\u0275fac=function(i){return new(i||e)(He(at),He(Cu),He(ra))},e.\u0275prov=Ke({token:e,factory:e.\u0275fac}),t})(),Cu=(()=>{var e;class t{constructor(){this._applications=new Map}registerApplication(i,r){this._applications.set(i,r)}unregisterApplication(i){this._applications.delete(i)}unregisterAllApplications(){this._applications.clear()}getTestability(i){return this._applications.get(i)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(i,r=!0){return wu?.findTestabilityInTree(this,i,r)??null}}return(e=t).\u0275fac=function(i){return new(i||e)},e.\u0275prov=Ke({token:e,factory:e.\u0275fac,providedIn:"platform"}),t})(),ti=null;const Nv=new Fe("AllowMultipleToken"),bu=new Fe("PlatformDestroyListeners"),Lv=new Fe("appBootstrapListener");function Vv(e,t,n=[]){const i=`Platform: ${t}`,r=new Fe(i);return(o=[])=>{let u=Du();if(!u||u.injector.get(Nv,!1)){const m=[...n,...o,{provide:r,useValue:!0}];e?e(m):function lM(e){if(ti&&!ti.get(Nv,!1))throw new ye(400,!1);(function jv(){!function yC(e){rh=e}(()=>{throw new ye(600,!1)})})(),ti=e;const t=e.get(Uv);(function Bv(e){e.get(Zd,null)?.forEach(n=>n())})(e)}(function Hv(e=[],t){return bn.create({name:t,providers:[{provide:Zl,useValue:"platform"},{provide:bu,useValue:new Set([()=>ti=null])},...e]})}(m,i))}return function uM(e){const t=Du();if(!t)throw new ye(401,!1);return t}()}}function Du(){return ti?.get(Uv)??null}let Uv=(()=>{var e;class t{constructor(i){this._injector=i,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(i,r){const o=function fM(e="zone.js",t){return"noop"===e?new Ab:"zone.js"===e?new at(t):e}(r?.ngZone,function zv(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return o.run(()=>{const u=function gT(e,t,n){return new nu(e,t,n)}(i.moduleType,this.injector,function Xv(e){return[{provide:at,useFactory:e},{provide:ws,multi:!0,useFactory:()=>{const t=tt(dM,{optional:!0});return()=>t.initialize()}},{provide:Yv,useFactory:hM},{provide:gg,useFactory:pg}]}(()=>o)),m=u.injector.get(Nn,null);return o.runOutsideAngular(()=>{const C=o.onError.subscribe({next:D=>{m.handleError(D)}});u.onDestroy(()=>{oa(this._modules,u),C.unsubscribe()})}),function $v(e,t,n){try{const i=n();return Hc(i)?i.catch(r=>{throw t.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>e.handleError(i)),i}}(m,o,()=>{const C=u.injector.get(mu);return C.runInitializers(),C.donePromise.then(()=>(function ym(e){Qt(e,"Expected localeId to be defined"),"string"==typeof e&&(vm=e.toLowerCase().replace(/_/g,"-"))}(u.injector.get(Vn,pr)||pr),this._moduleDoBootstrap(u),u))})})}bootstrapModule(i,r=[]){const o=Wv({},r);return function sM(e,t,n){const i=new iu(n);return Promise.resolve(i)}(0,0,i).then(u=>this.bootstrapModuleFactory(u,o))}_moduleDoBootstrap(i){const r=i.injector.get(wo);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(o=>r.bootstrap(o));else{if(!i.instance.ngDoBootstrap)throw new ye(-403,!1);i.instance.ngDoBootstrap(r)}this._modules.push(i)}onDestroy(i){this._destroyListeners.push(i)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ye(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const i=this._injector.get(bu,null);i&&(i.forEach(r=>r()),i.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(e=t).\u0275fac=function(i){return new(i||e)(He(bn))},e.\u0275prov=Ke({token:e,factory:e.\u0275fac,providedIn:"platform"}),t})();function Wv(e,t){return Array.isArray(t)?t.reduce(Wv,e):{...e,...t}}let wo=(()=>{var e;class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=tt(Yv),this.zoneIsStable=tt(gg),this.componentTypes=[],this.components=[],this.isStable=tt(jx).hasPendingTasks.pipe(function O_(e,t){return O((n,i)=>{let r=null,o=0,u=!1;const m=()=>u&&!r&&i.complete();n.subscribe(B(i,C=>{r?.unsubscribe();let D=0;const E=o++;Mn(e(C,E)).subscribe(r=B(i,x=>i.next(t?t(C,x,E,D++):x),()=>{r=null,m()}))},()=>{u=!0,m()}))})}(i=>i?function I_(...e){return wf(e,vf(e))}(!1):this.zoneIsStable),function A_(e,t=ce){return e=e??P_,O((n,i)=>{let r,o=!0;n.subscribe(B(i,u=>{const m=t(u);(o||!e(r,m))&&(o=!1,r=m,i.next(u))}))})}(),bf()),this._injector=tt(kn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(i,r){const o=i instanceof tg;if(!this._injector.get(mu).done)throw!o&&function xr(e){const t=Ue(e)||yt(e)||xt(e);return null!==t&&t.standalone}(i),new ye(405,!1);let m;m=o?i:this._injector.get(Ps).resolveComponentFactory(i),this.componentTypes.push(m.componentType);const C=function aM(e){return e.isBoundToModule}(m)?void 0:this._injector.get(vi),E=m.create(bn.NULL,[],r||m.selector,C),x=E.location.nativeElement,A=E.injector.get(kv,null);return A?.registerApplication(x),E.onDestroy(()=>{this.detachView(E.hostView),oa(this.components,E),A?.unregisterApplication(x)}),this._loadComponent(E),E}tick(){if(this._runningTick)throw new ye(101,!1);try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1}}attachView(i){const r=i;this._views.push(r),r.attachToAppRef(this)}detachView(i){const r=i;oa(this._views,r),r.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i);const r=this._injector.get(Lv,[]);r.push(...this._bootstrapListeners),r.forEach(o=>o(i))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(i=>i()),this._views.slice().forEach(i=>i.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(i){return this._destroyListeners.push(i),()=>oa(this._destroyListeners,i)}destroy(){if(this._destroyed)throw new ye(406,!1);const i=this._injector;i.destroy&&!i.destroyed&&i.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(e=t).\u0275fac=function(i){return new(i||e)},e.\u0275prov=Ke({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function oa(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Yv=new Fe("",{providedIn:"root",factory:()=>tt(Nn).handleError.bind(void 0)});function hM(){const e=tt(at),t=tt(Nn);return n=>e.runOutsideAngular(()=>t.handleError(n))}let dM=(()=>{var e;class t{constructor(){this.zone=tt(at),this.applicationRef=tt(wo)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(e=t).\u0275fac=function(i){return new(i||e)},e.\u0275prov=Ke({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();class ty{constructor(){}supports(t){return t instanceof Map||Oc(t)}create(){return new TM}}class TM{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||Oc(t)))throw new ye(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(n&&n.key===r)this._maybeAddToChanges(n,i),this._appendAfter=n,n=n._next;else{const o=this._getOrCreateRecordForKey(r,i);n=this._insertBeforeOrAppend(n,o)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let i=n;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const i=t._prev;return n._next=t,n._prev=i,t._prev=n,i&&(i._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,n);const o=r._prev,u=r._next;return o&&(o._next=u),u&&(u._prev=o),r._next=null,r._prev=null,r}const i=new xM(t);return this._records.set(t,i),i.currentValue=n,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(i=>n(t[i],i))}}class xM{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function iy(){return new yr([new ty])}let yr=(()=>{var e;class t{constructor(i){this.factories=i}static create(i,r){if(r){const o=r.factories.slice();i=i.concat(o)}return new t(i)}static extend(i){return{provide:t,useFactory:r=>t.create(i,r||iy()),deps:[[t,new Sl,new Dl]]}}find(i){const r=this.factories.find(o=>o.supports(i));if(r)return r;throw new ye(901,!1)}}return(e=t).\u0275prov=Ke({token:e,providedIn:"root",factory:iy}),t})();const OM=Vv(null,"core",[]);let AM=(()=>{var e;class t{constructor(i){}}return(e=t).\u0275fac=function(i){return new(i||e)(He(wo))},e.\u0275mod=Si({type:e}),e.\u0275inj=oi({}),t})(),Iu=null;function Ou(){return Iu}class $M{}const _i=new Fe("DocumentToken");let Dy=(()=>{var e;class t{constructor(i,r){this._viewContainer=i,this._context=new kI,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(i){this._context.$implicit=this._context.ngIf=i,this._updateView()}set ngIfThen(i){Sy("ngIfThen",i),this._thenTemplateRef=i,this._thenViewRef=null,this._updateView()}set ngIfElse(i){Sy("ngIfElse",i),this._elseTemplateRef=i,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(i,r){return!0}}return(e=t).\u0275fac=function(i){return new(i||e)(Ne(xn),Ne(Bn))},e.\u0275dir=Gt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class kI{constructor(){this.$implicit=null,this.ngIf=null}}function Sy(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${gt(t)}'.`)}let Wu=(()=>{var e;class t{}return(e=t).\u0275fac=function(i){return new(i||e)},e.\u0275mod=Si({type:e}),e.\u0275inj=oi({}),t})();function My(e){return"server"===e}class F1 extends $M{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Xu extends F1{static makeCurrent(){!function zM(e){Iu||(Iu=e)}(new Xu)}onAndCancel(t,n,i){return t.addEventListener(n,i),()=>{t.removeEventListener(n,i)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function R1(){return Eo=Eo||document.querySelector("base"),Eo?Eo.getAttribute("href"):null}();return null==n?null:function k1(e){ba=ba||document.createElement("a"),ba.setAttribute("href",e);const t=ba.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){Eo=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function OI(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const i=n.indexOf("="),[r,o]=-1==i?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===t)return decodeURIComponent(o)}return null}(document.cookie,t)}}let ba,Eo=null,L1=(()=>{var e;class t{build(){return new XMLHttpRequest}}return(e=t).\u0275fac=function(i){return new(i||e)},e.\u0275prov=Ke({token:e,factory:e.\u0275fac}),t})();const qu=new Fe("EventManagerPlugins");let Fy=(()=>{var e;class t{constructor(i,r){this._zone=r,this._eventNameToPlugin=new Map,i.forEach(o=>{o.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,r,o){return this._findPluginFor(r).addEventListener(i,r,o)}getZone(){return this._zone}_findPluginFor(i){let r=this._eventNameToPlugin.get(i);if(r)return r;if(r=this._plugins.find(u=>u.supports(i)),!r)throw new ye(5101,!1);return this._eventNameToPlugin.set(i,r),r}}return(e=t).\u0275fac=function(i){return new(i||e)(He(qu),He(at))},e.\u0275prov=Ke({token:e,factory:e.\u0275fac}),t})();class Ry{constructor(t){this._doc=t}}const Zu="ng-app-id";let ky=(()=>{var e;class t{constructor(i,r,o,u={}){this.doc=i,this.appId=r,this.nonce=o,this.platformId=u,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=My(u),this.resetHostNodes()}addStyles(i){for(const r of i)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(i){for(const r of i)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const i=this.styleNodesInDOM;i&&(i.forEach(r=>r.remove()),i.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(const r of this.getAllStyles())this.addStyleToHost(i,r)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(const r of this.hostNodes)this.addStyleToHost(r,i)}onStyleRemoved(i){const r=this.styleRef;r.get(i)?.elements?.forEach(o=>o.remove()),r.delete(i)}collectServerRenderedStyles(){const i=this.doc.head?.querySelectorAll(`style[${Zu}="${this.appId}"]`);if(i?.length){const r=new Map;return i.forEach(o=>{null!=o.textContent&&r.set(o.textContent,o)}),r}return null}changeUsageCount(i,r){const o=this.styleRef;if(o.has(i)){const u=o.get(i);return u.usage+=r,u.usage}return o.set(i,{usage:r,elements:[]}),r}getStyleElement(i,r){const o=this.styleNodesInDOM,u=o?.get(r);if(u?.parentNode===i)return o.delete(r),u.removeAttribute(Zu),u;{const m=this.doc.createElement("style");return this.nonce&&m.setAttribute("nonce",this.nonce),m.textContent=r,this.platformIsServer&&m.setAttribute(Zu,this.appId),m}}addStyleToHost(i,r){const o=this.getStyleElement(i,r);i.appendChild(o);const u=this.styleRef,m=u.get(r)?.elements;m?m.push(o):u.set(r,{elements:[o],usage:1})}resetHostNodes(){const i=this.hostNodes;i.clear(),i.add(this.doc.head)}}return(e=t).\u0275fac=function(i){return new(i||e)(He(_i),He(Ts),He(Kd,8),He(Ki))},e.\u0275prov=Ke({token:e,factory:e.\u0275fac}),t})();const Ku={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Qu=/%COMP%/g,H1=new Fe("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function Ly(e,t){return t.map(n=>n.replace(Qu,e))}let jy=(()=>{var e;class t{constructor(i,r,o,u,m,C,D,E=null){this.eventManager=i,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=u,this.doc=m,this.platformId=C,this.ngZone=D,this.nonce=E,this.rendererByCompId=new Map,this.platformIsServer=My(C),this.defaultRenderer=new Ju(i,m,D,this.platformIsServer)}createRenderer(i,r){if(!i||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===on.ShadowDom&&(r={...r,encapsulation:on.Emulated});const o=this.getOrCreateRenderer(i,r);return o instanceof Vy?o.applyToHost(i):o instanceof ef&&o.applyStyles(),o}getOrCreateRenderer(i,r){const o=this.rendererByCompId;let u=o.get(r.id);if(!u){const m=this.doc,C=this.ngZone,D=this.eventManager,E=this.sharedStylesHost,x=this.removeStylesOnCompDestroy,A=this.platformIsServer;switch(r.encapsulation){case on.Emulated:u=new Vy(D,E,r,this.appId,x,m,C,A);break;case on.ShadowDom:return new W1(D,E,i,r,m,C,this.nonce,A);default:u=new ef(D,E,r,x,m,C,A)}o.set(r.id,u)}return u}ngOnDestroy(){this.rendererByCompId.clear()}}return(e=t).\u0275fac=function(i){return new(i||e)(He(Fy),He(ky),He(Ts),He(H1),He(_i),He(Ki),He(at),He(Kd))},e.\u0275prov=Ke({token:e,factory:e.\u0275fac}),t})();class Ju{constructor(t,n,i,r){this.eventManager=t,this.doc=n,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?this.doc.createElementNS(Ku[n]||n,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,n){(By(t)?t.content:t).appendChild(n)}insertBefore(t,n,i){t&&(By(t)?t.content:t).insertBefore(n,i)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let i="string"==typeof t?this.doc.querySelector(t):t;if(!i)throw new ye(-5104,!1);return n||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,i,r){if(r){n=r+":"+n;const o=Ku[r];o?t.setAttributeNS(o,n,i):t.setAttribute(n,i)}else t.setAttribute(n,i)}removeAttribute(t,n,i){if(i){const r=Ku[i];r?t.removeAttributeNS(r,n):t.removeAttribute(`${i}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,i,r){r&(Kn.DashCase|Kn.Important)?t.style.setProperty(n,i,r&Kn.Important?"important":""):t.style[n]=i}removeStyle(t,n,i){i&Kn.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,i){t[n]=i}setValue(t,n){t.nodeValue=n}listen(t,n,i){if("string"==typeof t&&!(t=Ou().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${n}`);return this.eventManager.addEventListener(t,n,this.decoratePreventDefault(i))}decoratePreventDefault(t){return n=>{if("__ngUnwrap__"===n)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(n)):t(n))&&n.preventDefault()}}}function By(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class W1 extends Ju{constructor(t,n,i,r,o,u,m,C){super(t,o,u,C),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const D=Ly(r.id,r.styles);for(const E of D){const x=document.createElement("style");m&&x.setAttribute("nonce",m),x.textContent=E,this.shadowRoot.appendChild(x)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,i){return super.insertBefore(this.nodeOrShadowRoot(t),n,i)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class ef extends Ju{constructor(t,n,i,r,o,u,m,C){super(t,o,u,m),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=r,this.styles=C?Ly(C,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Vy extends ef{constructor(t,n,i,r,o,u,m,C){const D=r+"-"+i.id;super(t,n,i,o,u,m,C,D),this.contentAttr=function U1(e){return"_ngcontent-%COMP%".replace(Qu,e)}(D),this.hostAttr=function z1(e){return"_nghost-%COMP%".replace(Qu,e)}(D)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,n){const i=super.createElement(t,n);return super.setAttribute(i,this.contentAttr,""),i}}let G1=(()=>{var e;class t extends Ry{constructor(i){super(i)}supports(i){return!0}addEventListener(i,r,o){return i.addEventListener(r,o,!1),()=>this.removeEventListener(i,r,o)}removeEventListener(i,r,o){return i.removeEventListener(r,o)}}return(e=t).\u0275fac=function(i){return new(i||e)(He(_i))},e.\u0275prov=Ke({token:e,factory:e.\u0275fac}),t})();const Hy=["alt","control","meta","shift"],Y1={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},X1={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let q1=(()=>{var e;class t extends Ry{constructor(i){super(i)}supports(i){return null!=t.parseEventName(i)}addEventListener(i,r,o){const u=t.parseEventName(r),m=t.eventCallback(u.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ou().onAndCancel(i,u.domEventName,m))}static parseEventName(i){const r=i.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const u=t._normalizeKey(r.pop());let m="",C=r.indexOf("code");if(C>-1&&(r.splice(C,1),m="code."),Hy.forEach(E=>{const x=r.indexOf(E);x>-1&&(r.splice(x,1),m+=E+".")}),m+=u,0!=r.length||0===u.length)return null;const D={};return D.domEventName=o,D.fullKey=m,D}static matchEventFullKeyCode(i,r){let o=Y1[i.key]||i.key,u="";return r.indexOf("code.")>-1&&(o=i.code,u="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),Hy.forEach(m=>{m!==o&&(0,X1[m])(i)&&(u+=m+".")}),u+=o,u===r)}static eventCallback(i,r,o){return u=>{t.matchEventFullKeyCode(u,i)&&o.runGuarded(()=>r(u))}}static _normalizeKey(i){return"esc"===i?"escape":i}}return(e=t).\u0275fac=function(i){return new(i||e)(He(_i))},e.\u0275prov=Ke({token:e,factory:e.\u0275fac}),t})();const zy=[{provide:Ki,useValue:"browser"},{provide:Zd,useValue:function Z1(){Xu.makeCurrent()},multi:!0},{provide:_i,useFactory:function Q1(){return function Dw(e){Hl=e}(document),document},deps:[]}],J1=Vv(OM,"browser",zy),eO=new Fe(""),$y=[{provide:ra,useClass:class N1{addToWindow(t){et.getAngularTestability=(i,r=!0)=>{const o=t.findTestabilityInTree(i,r);if(null==o)throw new ye(5103,!1);return o},et.getAllAngularTestabilities=()=>t.getAllTestabilities(),et.getAllAngularRootElements=()=>t.getAllRootElements(),et.frameworkStabilizers||(et.frameworkStabilizers=[]),et.frameworkStabilizers.push(i=>{const r=et.getAllAngularTestabilities();let o=r.length,u=!1;const m=function(C){u=u||C,o--,0==o&&i(u)};r.forEach(C=>{C.whenStable(m)})})}findTestabilityInTree(t,n,i){return null==n?null:t.getTestability(n)??(i?Ou().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null)}},deps:[]},{provide:kv,useClass:_u,deps:[at,Cu,ra]},{provide:_u,useClass:_u,deps:[at,Cu,ra]}],Wy=[{provide:Zl,useValue:"root"},{provide:Nn,useFactory:function K1(){return new Nn},deps:[]},{provide:qu,useClass:G1,multi:!0,deps:[_i,at,Ki]},{provide:qu,useClass:q1,multi:!0,deps:[_i]},jy,ky,Fy,{provide:ig,useExisting:jy},{provide:class u1{},useClass:L1,deps:[]},[]];let tO=(()=>{var e;class t{constructor(i){}static withServerTransition(i){return{ngModule:t,providers:[{provide:Ts,useValue:i.appId}]}}}return(e=t).\u0275fac=function(i){return new(i||e)(He(eO,12))},e.\u0275mod=Si({type:e}),e.\u0275inj=oi({providers:[...Wy,...$y],imports:[Wu,AM]}),t})();function To(e){return(To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function V(e,t,n){return(t=function cO(e){var t=function lO(e,t){if("object"!==To(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==To(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===To(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}typeof window<"u"&&window;var xo=Ci(369),qy=function(){if(typeof Map<"u")return Map;function e(t,n){var i=-1;return t.some(function(r,o){return r[0]===n&&(i=o,!0)}),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(n){var i=e(this.__entries__,n),r=this.__entries__[i];return r&&r[1]},t.prototype.set=function(n,i){var r=e(this.__entries__,n);~r?this.__entries__[r][1]=i:this.__entries__.push([n,i])},t.prototype.delete=function(n){var i=this.__entries__,r=e(i,n);~r&&i.splice(r,1)},t.prototype.has=function(n){return!!~e(this.__entries__,n)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(n,i){void 0===i&&(i=null);for(var r=0,o=this.__entries__;r<o.length;r++){var u=o[r];n.call(i,u[1],u[0])}},t}()}(),nf=typeof window<"u"&&typeof document<"u"&&window.document===document,Da=typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")(),uO="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Da):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)},gO=["top","right","bottom","left","width","height","size","weight"],pO=typeof MutationObserver<"u",mO=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function hO(e,t){var n=!1,i=!1,r=0;function o(){n&&(n=!1,e()),i&&m()}function u(){uO(o)}function m(){var C=Date.now();if(n){if(C-r<2)return;i=!0}else n=!0,i=!1,setTimeout(u,t);r=C}return m}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var n=this.observers_,i=n.indexOf(t);~i&&n.splice(i,1),!n.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return t.forEach(function(n){return n.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!nf||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),pO?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!nf||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var n=t.propertyName,i=void 0===n?"":n;gO.some(function(o){return!!~i.indexOf(o)})&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),Zy=function(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];Object.defineProperty(e,r,{value:t[r],enumerable:!1,writable:!1,configurable:!0})}return e},Cr=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||Da},Ky=Ea(0,0,0,0);function Sa(e){return parseFloat(e)||0}function Qy(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(i,r){return i+Sa(e["border-"+r+"-width"])},0)}var CO=typeof SVGGraphicsElement<"u"?function(e){return e instanceof Cr(e).SVGGraphicsElement}:function(e){return e instanceof Cr(e).SVGElement&&"function"==typeof e.getBBox};function bO(e){return nf?CO(e)?function yO(e){var t=e.getBBox();return Ea(0,0,t.width,t.height)}(e):function _O(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return Ky;var i=Cr(e).getComputedStyle(e),r=function vO(e){for(var n={},i=0,r=["top","right","bottom","left"];i<r.length;i++){var o=r[i];n[o]=Sa(e["padding-"+o])}return n}(i),o=r.left+r.right,u=r.top+r.bottom,m=Sa(i.width),C=Sa(i.height);if("border-box"===i.boxSizing&&(Math.round(m+o)!==t&&(m-=Qy(i,"left","right")+o),Math.round(C+u)!==n&&(C-=Qy(i,"top","bottom")+u)),!function wO(e){return e===Cr(e).document.documentElement}(e)){var D=Math.round(m+o)-t,E=Math.round(C+u)-n;1!==Math.abs(D)&&(m-=D),1!==Math.abs(E)&&(C-=E)}return Ea(r.left,r.top,m,C)}(e):Ky}function Ea(e,t,n,i){return{x:e,y:t,width:n,height:i}}var SO=function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Ea(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=bO(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e}(),EO=function e(t,n){var i=function DO(e){var t=e.x,n=e.y,i=e.width,r=e.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,u=Object.create(o.prototype);return Zy(u,{x:t,y:n,width:i,height:r,top:n,right:t+i,bottom:r+n,left:t}),u}(n);Zy(this,{target:t,contentRect:i})},TO=function(){function e(t,n,i){if(this.activeObservations_=[],this.observations_=new qy,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=i}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u")&&Element instanceof Object){if(!(t instanceof Cr(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)||(n.set(t,new SO(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u")&&Element instanceof Object){if(!(t instanceof Cr(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)&&(n.delete(t),n.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&t.activeObservations_.push(n)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,n=this.activeObservations_.map(function(i){return new EO(i.target,i.broadcastRect())});this.callback_.call(t,n,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),Jy=typeof WeakMap<"u"?new WeakMap:new qy,e_=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=mO.getInstance(),i=new TO(t,n,this);Jy.set(this,i)};["observe","unobserve","disconnect"].forEach(function(e){e_.prototype[e]=function(){var t;return(t=Jy.get(this))[e].apply(t,arguments)}});const MO=typeof Da.ResizeObserver<"u"?Da.ResizeObserver:e_,t_=new Fe("FABRIC_CONFIG"),IO=["drop","dragover","dragenter","dragleave","mouseup","mousedown","mouseover","mouseout","mousemove","mousewheel","mousedblclick","mouseupBefore","mousedownBefore","mousemoveBefore","mouseUp","mouseDown","mouseOver","mouseOut","mouseMove","mouseWheel","mouseDblclick","mouseUpBefore","mouseDownBefore","mouseMoveBefore","pathCreated","alterRender","objectAdded","objectMoved","objectScaled","objectSkewed","objectRotated","objectRemoved","objectModified","objectSelected","objectMoving","objectScaling","objectSkewing","objectRotating","selectionCleared","selectionCreated","selectionUpdated","beforeTransform","beforeSelectionCleared"];class OO{constructor(t={}){V(this,"allowTouchScrolling",void 0),V(this,"altActionKey",void 0),V(this,"altSelectionKey",void 0),V(this,"backgroundColor",void 0),V(this,"backgroundImage",void 0),V(this,"backgroundVpt",void 0),V(this,"centeredKey",void 0),V(this,"centeredRotation",void 0),V(this,"centeredScaling",void 0),V(this,"clipTo",void 0),V(this,"containerClass",void 0),V(this,"controlsAboveOverlay",void 0),V(this,"defaultCursor",void 0),V(this,"enableRetinaScaling",void 0),V(this,"fireMiddleClick",void 0),V(this,"fireRightClick",void 0),V(this,"freeDrawingCursor",void 0),V(this,"FX_DURATION",void 0),V(this,"hoverCursor",void 0),V(this,"imageSmoothingEnabled",void 0),V(this,"includeDefaultValues",void 0),V(this,"interactive",void 0),V(this,"isDrawingMode",void 0),V(this,"moveCursor",void 0),V(this,"notAllowedCursor",void 0),V(this,"overlayColor",void 0),V(this,"overlayImage",void 0),V(this,"overlayVpt",void 0),V(this,"perPixelTargetFind",void 0),V(this,"preserveObjectStacking",void 0),V(this,"renderOnAddRemove",void 0),V(this,"rotationCursor",void 0),V(this,"selection",void 0),V(this,"selectionBorderColor",void 0),V(this,"selectionColor",void 0),V(this,"selectionDashArray",void 0),V(this,"selectionKey",void 0),V(this,"selectionLineWidth",void 0),V(this,"skipOffscreen",void 0),V(this,"skipTargetFind",void 0),V(this,"snapAngle",void 0),V(this,"snapThreshold",void 0),V(this,"stateful",void 0),V(this,"stopContextMenu",void 0),V(this,"svgViewportTransformation",void 0),V(this,"targetFindToTolerance",void 0),V(this,"uniScaleKey",void 0),V(this,"uniScaleTransform",void 0),V(this,"viewportTransform",void 0),V(this,"vptCoords",void 0),this.assign(t)}assign(t={}){for(const n in t)this[n]=t[n]}}let Ta=(()=>{var e;class t{set zoom(i){this.setZoom(i)}set width(i){this.setWidth(i)}set height(i){this.setHeight(i)}constructor(i,r,o,u){V(this,"zone",void 0),V(this,"elementRef",void 0),V(this,"differs",void 0),V(this,"defaults",void 0),V(this,"instance",null),V(this,"ro",null),V(this,"objectsJSON",null),V(this,"initialZoom",null),V(this,"initialWidth",null),V(this,"initialHeight",null),V(this,"configDiff",null),V(this,"disabled",!1),V(this,"config",void 0),V(this,"drop",new ae),V(this,"dragover",new ae),V(this,"dragenter",new ae),V(this,"dragleave",new ae),V(this,"mouseup",new ae),V(this,"mousedown",new ae),V(this,"mouseover",new ae),V(this,"mouseout",new ae),V(this,"mousemove",new ae),V(this,"mousewheel",new ae),V(this,"mousedblclick",new ae),V(this,"mouseupBefore",new ae),V(this,"mousedownBefore",new ae),V(this,"mousemoveBefore",new ae),V(this,"mouseUp",new ae),V(this,"mouseDown",new ae),V(this,"mouseOver",new ae),V(this,"mouseOut",new ae),V(this,"mouseMove",new ae),V(this,"mouseWheel",new ae),V(this,"mouseDblclick",new ae),V(this,"mouseUpBefore",new ae),V(this,"mouseDownBefore",new ae),V(this,"mouseMoveBefore",new ae),V(this,"pathCreated",new ae),V(this,"alterRender",new ae),V(this,"objectAdded",new ae),V(this,"objectMoved",new ae),V(this,"objectScaled",new ae),V(this,"objectSkewed",new ae),V(this,"objectRotated",new ae),V(this,"objectRemoved",new ae),V(this,"objectModified",new ae),V(this,"objectSelected",new ae),V(this,"objectMoving",new ae),V(this,"objectScaling",new ae),V(this,"objectSkewing",new ae),V(this,"objectRotating",new ae),V(this,"selectionCleared",new ae),V(this,"selectionCreated",new ae),V(this,"selectionUpdated",new ae),V(this,"beforeTransform",new ae),V(this,"beforeSelectionCleared",new ae),this.zone=i,this.elementRef=r,this.differs=o,this.defaults=u}ngOnInit(){const i=new OO(this.defaults);i.assign(this.config),Object.keys(i).forEach(r=>void 0===i[r]&&delete i[r]),this.zone.runOutsideAngular(()=>{this.instance=this.disabled?new xo.fabric.StaticCanvas(this.elementRef.nativeElement,i):new xo.fabric.Canvas(this.elementRef.nativeElement,i),this.initialZoom&&this.setZoom(this.initialZoom),this.initialWidth&&this.setWidth(this.initialWidth),this.initialHeight&&this.setHeight(this.initialHeight),null!==this.objectsJSON&&this.loadFromJSON(this.objectsJSON)}),IO.forEach(r=>{const o=r.replace(/([A-Z])/g,u=>`:${u.toLowerCase()}`);this.instance&&this.instance.on(o,u=>{this.zone.run(()=>{this[r].observers.length&&this[r].emit(u)})})}),this.configDiff||(this.configDiff=this.differs.find(this.config||{}).create(),this.configDiff.diff(this.config||{})),this.zone.runOutsideAngular(()=>{this.ro=new MO((r,o)=>{const u=this.elementRef.nativeElement.parentElement.parentElement;this.initialWidth||this.setWidth(u.offsetWidth),this.initialHeight||this.setHeight(u.offsetHeight)}),this.ro.observe(this.elementRef.nativeElement.parentElement.parentElement)})}ngOnDestroy(){this.ro&&this.ro.disconnect(),this.instance&&(this.objectsJSON=this.instance.toObject(),this.instance.dispose(),delete this.instance,this.instance=null)}ngDoCheck(){this.configDiff&&this.configDiff.diff(this.config||{})&&(this.ngOnDestroy(),this.ngOnInit())}ngOnChanges(i){this.instance&&i.disabled&&i.disabled.currentValue!==i.disabled.previousValue&&(this.ngOnDestroy(),this.ngOnInit())}fabric(){return this.instance}clear(){this.instance&&this.instance.clear()}render(){this.instance&&this.instance.renderAll()}setZoom(i){this.initialZoom=i,this.instance&&this.instance.setZoom(i)}setWidth(i){this.initialWidth=i,this.instance&&this.instance.setWidth(i)}setHeight(i){this.initialHeight=i,this.instance&&this.instance.setHeight(i)}loadFromJSON(i,r,o){this.instance&&this.instance.loadFromJSON(i,()=>{let u=!0;r&&(u=r()),u&&this.instance&&this.instance.renderAll()},o)}}return e=t,V(t,"\u0275fac",function(i){return new(i||e)(Ne(at),Ne(hi),Ne(yr),Ne(t_,8))}),V(t,"\u0275dir",Gt({type:e,selectors:[["","fabric",""]],inputs:{zoom:"zoom",width:"width",height:"height",disabled:"disabled",config:["fabric","config"]},outputs:{drop:"drop",dragover:"dragover",dragenter:"dragenter",dragleave:"dragleave",mouseup:"mouseup",mousedown:"mousedown",mouseover:"mouseover",mouseout:"mouseout",mousemove:"mousemove",mousewheel:"mousewheel",mousedblclick:"mousedblclick",mouseupBefore:"mouseupBefore",mousedownBefore:"mousedownBefore",mousemoveBefore:"mousemoveBefore",mouseUp:"mouseUp",mouseDown:"mouseDown",mouseOver:"mouseOver",mouseOut:"mouseOut",mouseMove:"mouseMove",mouseWheel:"mouseWheel",mouseDblclick:"mouseDblclick",mouseUpBefore:"mouseUpBefore",mouseDownBefore:"mouseDownBefore",mouseMoveBefore:"mouseMoveBefore",pathCreated:"pathCreated",alterRender:"alterRender",objectAdded:"objectAdded",objectMoved:"objectMoved",objectScaled:"objectScaled",objectSkewed:"objectSkewed",objectRotated:"objectRotated",objectRemoved:"objectRemoved",objectModified:"objectModified",objectSelected:"objectSelected",objectMoving:"objectMoving",objectScaling:"objectScaling",objectSkewing:"objectSkewing",objectRotating:"objectRotating",selectionCleared:"selectionCleared",selectionCreated:"selectionCreated",selectionUpdated:"selectionUpdated",beforeTransform:"beforeTransform",beforeSelectionCleared:"beforeSelectionCleared"},exportAs:["ngxFabric"],features:[Nr]})),t})(),n_=(()=>{var e;class t{set data(i){this.setJSON(i)}constructor(){V(this,"json",null),V(this,"zoom",null),V(this,"width",null),V(this,"height",null),V(this,"disabled",!1),V(this,"config",void 0),V(this,"useFabricClass",!0),V(this,"dataLoaded",new ae),V(this,"drop",new ae),V(this,"dragover",new ae),V(this,"dragenter",new ae),V(this,"dragleave",new ae),V(this,"mouseup",new ae),V(this,"mousedown",new ae),V(this,"mouseover",new ae),V(this,"mouseout",new ae),V(this,"mousemove",new ae),V(this,"mousewheel",new ae),V(this,"mousedblclick",new ae),V(this,"mouseupBefore",new ae),V(this,"mousedownBefore",new ae),V(this,"mousemoveBefore",new ae),V(this,"mouseUp",new ae),V(this,"mouseDown",new ae),V(this,"mouseOver",new ae),V(this,"mouseOut",new ae),V(this,"mouseMove",new ae),V(this,"mouseWheel",new ae),V(this,"mouseDblclick",new ae),V(this,"mouseUpBefore",new ae),V(this,"mouseDownBefore",new ae),V(this,"mouseMoveBefore",new ae),V(this,"pathCreated",new ae),V(this,"alterRender",new ae),V(this,"objectAdded",new ae),V(this,"objectMoved",new ae),V(this,"objectScaled",new ae),V(this,"objectSkewed",new ae),V(this,"objectRotated",new ae),V(this,"objectRemoved",new ae),V(this,"objectModified",new ae),V(this,"objectSelected",new ae),V(this,"objectMoving",new ae),V(this,"objectScaling",new ae),V(this,"objectSkewing",new ae),V(this,"objectRotating",new ae),V(this,"selectionCleared",new ae),V(this,"selectionCreated",new ae),V(this,"selectionUpdated",new ae),V(this,"beforeTransform",new ae),V(this,"beforeSelectionCleared",new ae),V(this,"directiveRef",void 0)}ngAfterViewInit(){null!=this.json&&this.setJSON(this.json,!0)}setJSON(i,r){(r||i!==this.json)&&(this.directiveRef&&this.directiveRef.loadFromJSON(i,()=>{this.directiveRef&&this.directiveRef.fabric()&&this.dataLoaded.emit(this.directiveRef.fabric())}),this.json=i)}}return e=t,V(t,"\u0275fac",function(i){return new(i||e)}),V(t,"\u0275cmp",Xa({type:e,selectors:[["fabric"]],viewQuery:function(i,r){if(1&i&&ea(Ta,7),2&i){let o;Js(o=ta())&&(r.directiveRef=o.first)}},hostVars:2,hostBindings:function(i,r){2&i&&Gc("fabric",r.useFabricClass)},inputs:{data:"data",zoom:"zoom",width:"width",height:"height",disabled:"disabled",config:"config",useFabricClass:"useFabricClass"},outputs:{dataLoaded:"dataLoaded",drop:"drop",dragover:"dragover",dragenter:"dragenter",dragleave:"dragleave",mouseup:"mouseup",mousedown:"mousedown",mouseover:"mouseover",mouseout:"mouseout",mousemove:"mousemove",mousewheel:"mousewheel",mousedblclick:"mousedblclick",mouseupBefore:"mouseupBefore",mousedownBefore:"mousedownBefore",mousemoveBefore:"mousemoveBefore",mouseUp:"mouseUp",mouseDown:"mouseDown",mouseOver:"mouseOver",mouseOut:"mouseOut",mouseMove:"mouseMove",mouseWheel:"mouseWheel",mouseDblclick:"mouseDblclick",mouseUpBefore:"mouseUpBefore",mouseDownBefore:"mouseDownBefore",mouseMoveBefore:"mouseMoveBefore",pathCreated:"pathCreated",alterRender:"alterRender",objectAdded:"objectAdded",objectMoved:"objectMoved",objectScaled:"objectScaled",objectSkewed:"objectSkewed",objectRotated:"objectRotated",objectRemoved:"objectRemoved",objectModified:"objectModified",objectSelected:"objectSelected",objectMoving:"objectMoving",objectScaling:"objectScaling",objectSkewing:"objectSkewing",objectRotating:"objectRotating",selectionCleared:"selectionCleared",selectionCreated:"selectionCreated",selectionUpdated:"selectionUpdated",beforeTransform:"beforeTransform",beforeSelectionCleared:"beforeSelectionCleared"},exportAs:["ngxFabric"],decls:1,vars:5,consts:[[3,"fabric","zoom","width","height","disabled","drop","dragover","dragenter","dragleave","mouseup","mousedown","mouseover","mouseout","mousemove","mousewheel","mousedblclick","mouseupBefore","mousedownBefore","mousemoveBefore","mouseUp","mouseDown","mouseOver","mouseOut","mouseMove","mouseWheel","mouseDblclick","mouseUpBefore","mouseDownBefore","mouseMoveBefore","pathCreated","alterRender","objectAdded","objectMoved","objectScaled","objectSkewed","objectRotated","objectRemoved","objectModified","objectSelected","objectMoving","objectScaling","objectSkewing","objectRotating","selectionCleared","selectionCreated","selectionUpdated","beforeTransform","beforeSelectionCleared"]],template:function(i,r){1&i&&(bt(0,"canvas",0),cn("drop",function(u){return r.drop.emit(u)})("dragover",function(u){return r.dragover.emit(u)})("dragenter",function(u){return r.dragenter.emit(u)})("dragleave",function(u){return r.dragleave.emit(u)})("mouseup",function(u){return r.mouseup.emit(u)})("mousedown",function(u){return r.mousedown.emit(u)})("mouseover",function(u){return r.mouseover.emit(u)})("mouseout",function(u){return r.mouseout.emit(u)})("mousemove",function(u){return r.mousemove.emit(u)})("mousewheel",function(u){return r.mousewheel.emit(u)})("mousedblclick",function(u){return r.mousedblclick.emit(u)})("mouseupBefore",function(u){return r.mouseupBefore.emit(u)})("mousedownBefore",function(u){return r.mousedownBefore.emit(u)})("mousemoveBefore",function(u){return r.mousemoveBefore.emit(u)})("mouseUp",function(u){return r.mouseUp.emit(u)})("mouseDown",function(u){return r.mouseDown.emit(u)})("mouseOver",function(u){return r.mouseOver.emit(u)})("mouseOut",function(u){return r.mouseOut.emit(u)})("mouseMove",function(u){return r.mouseMove.emit(u)})("mouseWheel",function(u){return r.mouseWheel.emit(u)})("mouseDblclick",function(u){return r.mouseDblclick.emit(u)})("mouseUpBefore",function(u){return r.mouseUpBefore.emit(u)})("mouseDownBefore",function(u){return r.mouseDownBefore.emit(u)})("mouseMoveBefore",function(u){return r.mouseMoveBefore.emit(u)})("pathCreated",function(u){return r.pathCreated.emit(u)})("alterRender",function(u){return r.alterRender.emit(u)})("objectAdded",function(u){return r.objectAdded.emit(u)})("objectMoved",function(u){return r.objectMoved.emit(u)})("objectScaled",function(u){return r.objectScaled.emit(u)})("objectSkewed",function(u){return r.objectSkewed.emit(u)})("objectRotated",function(u){return r.objectRotated.emit(u)})("objectRemoved",function(u){return r.objectRemoved.emit(u)})("objectModified",function(u){return r.objectModified.emit(u)})("objectSelected",function(u){return r.objectSelected.emit(u)})("objectMoving",function(u){return r.objectMoving.emit(u)})("objectScaling",function(u){return r.objectScaling.emit(u)})("objectSkewing",function(u){return r.objectSkewing.emit(u)})("objectRotating",function(u){return r.objectRotating.emit(u)})("selectionCleared",function(u){return r.selectionCleared.emit(u)})("selectionCreated",function(u){return r.selectionCreated.emit(u)})("selectionUpdated",function(u){return r.selectionUpdated.emit(u)})("beforeTransform",function(u){return r.beforeTransform.emit(u)})("beforeSelectionCleared",function(u){return r.beforeSelectionCleared.emit(u)}),Dt()),2&i&&gi("fabric",r.config)("zoom",r.zoom)("width",r.width)("height",r.height)("disabled",r.disabled)},dependencies:[Ta],styles:["fabric.flex{display:flex;flex-direction:column;min-width:0;min-height:0}fabric.fabric{width:100%;height:100%}\n"],encapsulation:2})),t})(),AO=(()=>{var e;class t{}return e=t,V(t,"\u0275fac",function(i){return new(i||e)}),V(t,"\u0275mod",Si({type:e})),V(t,"\u0275inj",oi({imports:[Wu,Wu]})),t})();function PO(e,t){if(1&e){const n=Vc();bt(0,"fabric",11),cn("dataLoaded",function(r){return Fi(n),Ri(Jn().onDataLoaded(r))})("objectAdded",function(r){return Fi(n),Ri(Jn().onObjectAdded(r))})("selectionCreated",function(r){return Fi(n),Ri(Jn().onSelectionCreated(r))}),Dt()}if(2&e){const n=Jn();gi("data",n.data)("config",n.config)("disabled",n.disabled)}}function FO(e,t){if(1&e){const n=Vc();bt(0,"div",12)(1,"canvas",13),cn("objectAdded",function(r){return Fi(n),Ri(Jn().onObjectAdded(r))})("selectionCreated",function(r){return Fi(n),Ri(Jn().onSelectionCreated(r))}),Dt()()}if(2&e){const n=Jn();to(1),gi("fabric",n.config)("disabled",n.disabled)}}let RO=(()=>{var e;class t{constructor(){V(this,"show",!0),V(this,"data",{objects:[{type:"group",top:22,left:72,width:200,height:60,objects:[{type:"rect",top:-30,left:-100,width:200,height:60,fill:"#cfcfcf"},{type:"text",width:200,height:60,fontSize:24,text:"Example object",originX:"center",originY:"center",styles:{}}]}]}),V(this,"type","component"),V(this,"disabled",!1),V(this,"config",{renderOnAddRemove:!0}),V(this,"componentRef",void 0),V(this,"directiveRef",void 0)}toggleType(){this.type="component"===this.type?"directive":"component"}addLine(){const i=new xo.fabric.Line([44,100,300,100],{fill:"#000000",stroke:"#000000",strokeWidth:3});"directive"===this.type&&this.directiveRef?this.directiveRef.fabric().add(i):"component"===this.type&&this.componentRef&&this.componentRef.directiveRef&&this.componentRef.directiveRef.fabric().add(i)}addText(){const i=new xo.fabric.Text("Angular",{top:120,left:105,fill:"#000000"});"directive"===this.type&&this.directiveRef?this.directiveRef.fabric().add(i):"component"===this.type&&this.componentRef&&this.componentRef.directiveRef&&this.componentRef.directiveRef.fabric().add(i)}addImage(){xo.fabric.Image.fromURL("https://angular.io/assets/images/logos/angular/angular.png",i=>{i.scale(.5),i.set({left:110,top:180}),"directive"===this.type&&this.directiveRef?this.directiveRef.fabric().add(i):"component"===this.type&&this.componentRef&&this.componentRef.directiveRef&&this.componentRef.directiveRef.fabric().add(i)})}toggleDisabled(){this.disabled=!this.disabled}resetCanvasObjects(){"directive"===this.type&&this.directiveRef?this.directiveRef.clear():"component"===this.type&&this.componentRef&&this.componentRef.directiveRef&&this.componentRef.directiveRef.clear(),this.data=Object.assign({},this.data)}onDataLoaded(i){console.log("Data loaded:",i)}onObjectAdded(i){console.log("Object added:",i)}onSelectionCreated(i){console.log("Selection created:",i)}}return e=t,V(t,"\u0275fac",function(i){return new(i||e)}),V(t,"\u0275cmp",Xa({type:e,selectors:[["my-app"]],viewQuery:function(i,r){if(1&i&&(ea(n_,5),ea(Ta,5)),2&i){let o;Js(o=ta())&&(r.componentRef=o.first),Js(o=ta())&&(r.directiveRef=o.first)}},decls:28,vars:3,consts:[[1,"box-container","flex-col"],[1,"app-title"],[1,"info-container"],[1,"horizontal-container","flex","content-stretch","flex-col","md:flex-row"],[1,"vertical-container","flex-1","flex-col","content-stretch",2,"min-width","0"],[1,"box-title"],[1,"action-container","flex-col","content-stretch"],[1,"action-button","flex","items-center","justify-center",3,"click"],[1,"content-container","flex","flex-col","content-stretch"],["class","flex",3,"data","config","disabled","dataLoaded","objectAdded","selectionCreated",4,"ngIf"],["class","flex flex-1",4,"ngIf"],[1,"flex",3,"data","config","disabled","dataLoaded","objectAdded","selectionCreated"],[1,"flex","flex-1"],[1,"fabric-canvas",3,"fabric","disabled","objectAdded","selectionCreated"]],template:function(i,r){1&i&&(bt(0,"div",0)(1,"div",1),hn(2,"Simple example app for the ngx-fabric-wrapper"),Dt(),bt(3,"div",2),hn(4," This example only shows some of the available features, to see all check Fabric demos / documentation. "),Dt(),bt(5,"div",3)(6,"div",4)(7,"div",5),hn(8,"Settings"),Dt(),bt(9,"div",6)(10,"div",7),cn("click",function(){return r.toggleType()}),hn(11),Dt(),bt(12,"div",7),cn("click",function(){return r.toggleDisabled()}),hn(13,"Toggle disabled state"),Dt(),bt(14,"div",7),cn("click",function(){return r.addLine()}),hn(15,"Add line object"),Dt(),bt(16,"div",7),cn("click",function(){return r.addText()}),hn(17,"Add text object"),Dt(),bt(18,"div",7),cn("click",function(){return r.addImage()}),hn(19,"Add image object"),Dt(),bt(20,"div",7),cn("click",function(){return r.resetCanvasObjects()}),hn(21,"Reset the canvas"),Dt()()(),bt(22,"div",4)(23,"div",5),hn(24,"Fabric"),Dt(),bt(25,"div",8),Nc(26,PO,1,3,"fabric",9),Nc(27,FO,2,2,"div",10),Dt()()()()),2&i&&(to(11),Xc("component"===r.type?"Switch to directive":"Switch to component"),to(15),gi("ngIf","component"===r.type&&r.show),to(1),gi("ngIf","directive"===r.type&&r.show))},dependencies:[Dy,n_,Ta],styles:[".app-title[_ngcontent-%COMP%]{font-size:24px}.box-title[_ngcontent-%COMP%]{font-size:20px}.box-container[_ngcontent-%COMP%]{box-sizing:border-box;width:800px;height:500px;max-width:90%;max-height:90%;padding:24px;margin:24px auto;border-radius:4px;color:#555;background-color:#eee;box-shadow:0 6px 20px #0000002e,0 6px 6px #00000040}.info-container[_ngcontent-%COMP%]{padding:12px 16px;line-height:24px}.action-container[_ngcontent-%COMP%]{overflow:auto;padding:16px}.content-container[_ngcontent-%COMP%]{overflow:visible}.action-container[_ngcontent-%COMP%], .content-container[_ngcontent-%COMP%]{position:relative;height:300px;min-height:0;margin:8px 16px;border-radius:4px;background-color:#fff}.action-button[_ngcontent-%COMP%]{box-sizing:border-box;width:calc(100% - 16px);min-height:35px;padding:4px 16px;margin:8px;border:1px solid #555;border-radius:4px;cursor:pointer;font-size:14px;font-weight:700;line-height:14px;text-align:center}.action-button[_ngcontent-%COMP%]:hover{color:#fff;background-color:#555}.quill-editor[_ngcontent-%COMP%]{display:flex}"]})),t})();const kO={allowTouchScrolling:!0};let NO=(()=>{var e;class t{}return e=t,V(t,"\u0275fac",function(i){return new(i||e)}),V(t,"\u0275mod",Si({type:e,bootstrap:[RO]})),V(t,"\u0275inj",oi({providers:[{provide:t_,useValue:kO}],imports:[AO,tO]})),t})();J1().bootstrapModule(NO)},369:(Mo,Ie,Ci)=>{var y,h,p,d,a,c,w=w||{version:"5.3.0"};if(Ie.fabric=w,typeof document<"u"&&typeof window<"u")w.document=document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?document:document.implementation.createHTMLDocument(""),w.window=window;else{var wi=new(Ci(960).JSDOM)(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;w.document=wi.document,w.jsdomImplForWrapper=Ci(759).implForWrapper,w.nodeCanvas=Ci(272).Canvas,w.window=wi,DOMParser=w.window.DOMParser}function kt(y,h){var p=y.canvas,d=h.targetCanvas,a=d.getContext("2d");a.translate(0,d.height),a.scale(1,-1),a.drawImage(p,0,p.height-d.height,d.width,d.height,0,0,d.width,d.height)}function bi(y,h){var d=h.targetCanvas.getContext("2d"),a=h.destinationWidth,c=h.destinationHeight,s=a*c*4,f=new Uint8Array(this.imageBuffer,0,s),g=new Uint8ClampedArray(this.imageBuffer,0,s);y.readPixels(0,0,a,c,y.RGBA,y.UNSIGNED_BYTE,f);var l=new ImageData(g,a,c);d.putImageData(l,0,0)}w.isTouchSupported="ontouchstart"in w.window||"ontouchstart"in w.document||w.window&&w.window.navigator&&w.window.navigator.maxTouchPoints>0,w.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",w.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],w.DPI=96,w.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",w.commaWsp="(?:\\s+,?\\s*|,\\s*)",w.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,w.reNonWord=/[ \n\.,;!\?\-]/,w.fontPaths={},w.iMatrix=[1,0,0,1,0,0],w.svgNS="http://www.w3.org/2000/svg",w.perfLimitSizeTotal=2097152,w.maxCacheSideLimit=4096,w.minCacheSideLimit=256,w.charWidthsCache={},w.textureSize=2048,w.disableStyleCopyPaste=!1,w.enableGLFiltering=!0,w.devicePixelRatio=w.window.devicePixelRatio||w.window.webkitDevicePixelRatio||w.window.mozDevicePixelRatio||1,w.browserShadowBlurConstant=1,w.arcToSegmentsCache={},w.boundsOfCurveCache={},w.cachesBoundsOfCurve=!0,w.forceGLPutImageData=!1,w.initFilterBackend=function(){return w.enableGLFiltering&&w.isWebglSupported&&w.isWebglSupported(w.textureSize)?(console.log("max texture size: "+w.maxTextureSize),new w.WebglFilterBackend({tileSize:w.textureSize})):w.Canvas2dFilterBackend?new w.Canvas2dFilterBackend:void 0},typeof document<"u"&&typeof window<"u"&&(window.fabric=w),function(){function y(s,f){if(this.__eventListeners[s]){var g=this.__eventListeners[s];f?g[g.indexOf(f)]=!1:w.util.array.fill(g,!1)}}function p(s,f){var g=function(){f.apply(this,arguments),this.off(s,g)}.bind(this);this.on(s,g)}w.Observable={fire:function c(s,f){if(!this.__eventListeners)return this;var g=this.__eventListeners[s];if(!g)return this;for(var l=0,v=g.length;l<v;l++)g[l]&&g[l].call(this,f||{});return this.__eventListeners[s]=g.filter(function(_){return!1!==_}),this},on:function h(s,f){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var g in s)this.on(g,s[g]);else this.__eventListeners[s]||(this.__eventListeners[s]=[]),this.__eventListeners[s].push(f);return this},once:function d(s,f){if(1===arguments.length)for(var g in s)p.call(this,g,s[g]);else p.call(this,s,f);return this},off:function a(s,f){if(!this.__eventListeners)return this;if(0===arguments.length)for(s in this.__eventListeners)y.call(this,s);else if(1===arguments.length&&"object"==typeof arguments[0])for(var g in s)y.call(this,g,s[g]);else y.call(this,s,f);return this}}}(),w.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var y=0,h=arguments.length;y<h;y++)this._onObjectAdded(arguments[y]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(y,h,p){var d=this._objects;return p?d[h]=y:d.splice(h,0,y),this._onObjectAdded&&this._onObjectAdded(y),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var h,y=this._objects,p=!1,d=0,a=arguments.length;d<a;d++)-1!==(h=y.indexOf(arguments[d]))&&(p=!0,y.splice(h,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[d]));return this.renderOnAddRemove&&p&&this.requestRenderAll(),this},forEachObject:function(y,h){for(var p=this.getObjects(),d=0,a=p.length;d<a;d++)y.call(h,p[d],d,p);return this},getObjects:function(y){return typeof y>"u"?this._objects.concat():this._objects.filter(function(h){return h.type===y})},item:function(y){return this._objects[y]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(y,h){return this._objects.indexOf(y)>-1||!!h&&this._objects.some(function(p){return"function"==typeof p.contains&&p.contains(y,!0)})},complexity:function(){return this._objects.reduce(function(y,h){return y+(h.complexity?h.complexity():0)},0)}},w.CommonMethods={_setOptions:function(y){for(var h in y)this.set(h,y[h])},_initGradient:function(y,h){y&&y.colorStops&&!(y instanceof w.Gradient)&&this.set(h,new w.Gradient(y))},_initPattern:function(y,h,p){!y||!y.source||y instanceof w.Pattern?p&&p():this.set(h,new w.Pattern(y,p))},_setObject:function(y){for(var h in y)this._set(h,y[h])},set:function(y,h){return"object"==typeof y?this._setObject(y):this._set(y,h),this},_set:function(y,h){this[y]=h},toggle:function(y){var h=this.get(y);return"boolean"==typeof h&&this.set(y,!h),this},get:function(y){return this[y]}},y=Ie,h=Math.sqrt,p=Math.atan2,d=Math.pow,a=Math.PI/180,c=Math.PI/2,w.util={cos:function(s){if(0===s)return 1;switch(s<0&&(s=-s),s/c){case 1:case 3:return 0;case 2:return-1}return Math.cos(s)},sin:function(s){if(0===s)return 0;var g=1;switch(s<0&&(g=-1),s/c){case 1:return g;case 2:return 0;case 3:return-g}return Math.sin(s)},removeFromArray:function(s,f){var g=s.indexOf(f);return-1!==g&&s.splice(g,1),s},getRandomInt:function(s,f){return Math.floor(Math.random()*(f-s+1))+s},degreesToRadians:function(s){return s*a},radiansToDegrees:function(s){return s/a},rotatePoint:function(s,f,g){var l=new w.Point(s.x-f.x,s.y-f.y),v=w.util.rotateVector(l,g);return new w.Point(v.x,v.y).addEquals(f)},rotateVector:function(s,f){var g=w.util.sin(f),l=w.util.cos(f);return{x:s.x*l-s.y*g,y:s.x*g+s.y*l}},createVector:function(s,f){return new w.Point(f.x-s.x,f.y-s.y)},calcAngleBetweenVectors:function(s,f){return Math.acos((s.x*f.x+s.y*f.y)/(Math.hypot(s.x,s.y)*Math.hypot(f.x,f.y)))},getHatVector:function(s){return new w.Point(s.x,s.y).multiply(1/Math.hypot(s.x,s.y))},getBisector:function(s,f,g){var l=w.util.createVector(s,f),v=w.util.createVector(s,g),_=w.util.calcAngleBetweenVectors(l,v),b=w.util.calcAngleBetweenVectors(w.util.rotateVector(l,_),v);return{vector:w.util.getHatVector(w.util.rotateVector(l,_*(0===b?1:-1)/2)),angle:_}},projectStrokeOnPoints:function(s,f,g){var l=[],v=f.strokeWidth/2,_=f.strokeUniform?new w.Point(1/f.scaleX,1/f.scaleY):new w.Point(1,1),b=function(S){var T=v/Math.hypot(S.x,S.y);return new w.Point(S.x*T*_.x,S.y*T*_.y)};return s.length<=1||s.forEach(function(S,T){var P,j,M=new w.Point(S.x,S.y);0===T?(j=s[T+1],P=g?b(w.util.createVector(j,M)).addEquals(M):s[s.length-1]):T===s.length-1?(P=s[T-1],j=g?b(w.util.createVector(P,M)).addEquals(M):s[0]):(P=s[T-1],j=s[T+1]);var ge,pe,G=w.util.getBisector(M,P,j),re=G.vector;if("miter"===f.strokeLineJoin&&(ge=-v/Math.sin(G.angle/2),pe=new w.Point(re.x*ge*_.x,re.y*ge*_.y),Math.hypot(pe.x,pe.y)/v<=f.strokeMiterLimit))return l.push(M.add(pe)),void l.push(M.subtract(pe));ge=-v*Math.SQRT2,pe=new w.Point(re.x*ge*_.x,re.y*ge*_.y),l.push(M.add(pe)),l.push(M.subtract(pe))}),l},transformPoint:function(s,f,g){return g?new w.Point(f[0]*s.x+f[2]*s.y,f[1]*s.x+f[3]*s.y):new w.Point(f[0]*s.x+f[2]*s.y+f[4],f[1]*s.x+f[3]*s.y+f[5])},makeBoundingBoxFromPoints:function(s,f){if(f)for(var g=0;g<s.length;g++)s[g]=w.util.transformPoint(s[g],f);var l=[s[0].x,s[1].x,s[2].x,s[3].x],v=w.util.array.min(l),b=w.util.array.max(l)-v,S=[s[0].y,s[1].y,s[2].y,s[3].y],T=w.util.array.min(S);return{left:v,top:T,width:b,height:w.util.array.max(S)-T}},invertTransform:function(s){var f=1/(s[0]*s[3]-s[1]*s[2]),g=[f*s[3],-f*s[1],-f*s[2],f*s[0]],l=w.util.transformPoint({x:s[4],y:s[5]},g,!0);return g[4]=-l.x,g[5]=-l.y,g},toFixed:function(s,f){return parseFloat(Number(s).toFixed(f))},parseUnit:function(s,f){var g=/\D{0,2}$/.exec(s),l=parseFloat(s);switch(f||(f=w.Text.DEFAULT_SVG_FONT_SIZE),g[0]){case"mm":return l*w.DPI/25.4;case"cm":return l*w.DPI/2.54;case"in":return l*w.DPI;case"pt":return l*w.DPI/72;case"pc":return l*w.DPI/72*12;case"em":return l*f;default:return l}},falseFunction:function(){return!1},getKlass:function(s,f){return s=w.util.string.camelize(s.charAt(0).toUpperCase()+s.slice(1)),w.util.resolveNamespace(f)[s]},getSvgAttributes:function(s){var f=["instantiated_by_use","style","id","class"];switch(s){case"linearGradient":f=f.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":f=f.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":f=f.concat(["offset","stop-color","stop-opacity"])}return f},resolveNamespace:function(s){if(!s)return w;var l,f=s.split("."),g=f.length,v=y||w.window;for(l=0;l<g;++l)v=v[f[l]];return v},loadImage:function(s,f,g,l){if(s){var v=w.util.createImage(),_=function(){f&&f.call(g,v,!1),v=v.onload=v.onerror=null};v.onload=_,v.onerror=function(){w.log("Error loading "+v.src),f&&f.call(g,null,!0),v=v.onload=v.onerror=null},0!==s.indexOf("data")&&null!=l&&(v.crossOrigin=l),"data:image/svg"===s.substring(0,14)&&(v.onload=null,w.util.loadImageInDom(v,_)),v.src=s}else f&&f.call(g,s)},loadImageInDom:function(s,f){var g=w.document.createElement("div");g.style.width=g.style.height="1px",g.style.left=g.style.top="-100%",g.style.position="absolute",g.appendChild(s),w.document.querySelector("body").appendChild(g),s.onload=function(){f(),g.parentNode.removeChild(g),g=null}},enlivenObjects:function(s,f,g,l){var v=[],_=0,b=(s=s||[]).length;function S(){++_===b&&f&&f(v.filter(function(T){return T}))}b?s.forEach(function(T,M){T&&T.type?w.util.getKlass(T.type,g).fromObject(T,function(j,G){G||(v[M]=j),l&&l(T,j,G),S()}):S()}):f&&f(v)},enlivenObjectEnlivables:function(s,f,g){var l=w.Object.ENLIVEN_PROPS.filter(function(v){return!!s[v]});w.util.enlivenObjects(l.map(function(v){return s[v]}),function(v){var _={};l.forEach(function(b,S){_[b]=v[S],f&&(f[b]=v[S])}),g&&g(_)})},enlivenPatterns:function(s,f){function g(){++v===_&&f&&f(l)}var l=[],v=0,_=(s=s||[]).length;_?s.forEach(function(b,S){b&&b.source?new w.Pattern(b,function(T){l[S]=T,g()}):(l[S]=b,g())}):f&&f(l)},groupSVGElements:function(s,f,g){var l;return s&&1===s.length?(typeof g<"u"&&(s[0].sourcePath=g),s[0]):(f&&(f.width&&f.height?f.centerPoint={x:f.width/2,y:f.height/2}:(delete f.width,delete f.height)),l=new w.Group(s,f),typeof g<"u"&&(l.sourcePath=g),l)},populateWithProperties:function(s,f,g){if(g&&Array.isArray(g))for(var l=0,v=g.length;l<v;l++)g[l]in s&&(f[g[l]]=s[g[l]])},createCanvasElement:function(){return w.document.createElement("canvas")},copyCanvasElement:function(s){var f=w.util.createCanvasElement();return f.width=s.width,f.height=s.height,f.getContext("2d").drawImage(s,0,0),f},toDataURL:function(s,f,g){return s.toDataURL("image/"+f,g)},createImage:function(){return w.document.createElement("img")},multiplyTransformMatrices:function(s,f,g){return[s[0]*f[0]+s[2]*f[1],s[1]*f[0]+s[3]*f[1],s[0]*f[2]+s[2]*f[3],s[1]*f[2]+s[3]*f[3],g?0:s[0]*f[4]+s[2]*f[5]+s[4],g?0:s[1]*f[4]+s[3]*f[5]+s[5]]},qrDecompose:function(s){var f=p(s[1],s[0]),g=d(s[0],2)+d(s[1],2),l=h(g),v=(s[0]*s[3]-s[2]*s[1])/l,_=p(s[0]*s[2]+s[1]*s[3],g);return{angle:f/a,scaleX:l,scaleY:v,skewX:_/a,skewY:0,translateX:s[4],translateY:s[5]}},calcRotateMatrix:function(s){if(!s.angle)return w.iMatrix.concat();var f=w.util.degreesToRadians(s.angle),g=w.util.cos(f),l=w.util.sin(f);return[g,l,-l,g,0,0]},calcDimensionsMatrix:function(s){var f=typeof s.scaleX>"u"?1:s.scaleX,g=typeof s.scaleY>"u"?1:s.scaleY,l=[s.flipX?-f:f,0,0,s.flipY?-g:g,0,0],v=w.util.multiplyTransformMatrices,_=w.util.degreesToRadians;return s.skewX&&(l=v(l,[1,0,Math.tan(_(s.skewX)),1],!0)),s.skewY&&(l=v(l,[1,Math.tan(_(s.skewY)),0,1],!0)),l},composeMatrix:function(s){var f=[1,0,0,1,s.translateX||0,s.translateY||0],g=w.util.multiplyTransformMatrices;return s.angle&&(f=g(f,w.util.calcRotateMatrix(s))),(1!==s.scaleX||1!==s.scaleY||s.skewX||s.skewY||s.flipX||s.flipY)&&(f=g(f,w.util.calcDimensionsMatrix(s))),f},resetObjectTransform:function(s){s.scaleX=1,s.scaleY=1,s.skewX=0,s.skewY=0,s.flipX=!1,s.flipY=!1,s.rotate(0)},saveObjectTransform:function(s){return{scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,angle:s.angle,left:s.left,flipX:s.flipX,flipY:s.flipY,top:s.top}},isTransparent:function(s,f,g,l){l>0&&(f>l?f-=l:f=0,g>l?g-=l:g=0);var _,v=!0,S=s.getImageData(f,g,2*l||1,2*l||1),T=S.data.length;for(_=3;_<T&&0!=(v=S.data[_]<=0);_+=4);return S=null,v},parsePreserveAspectRatioAttribute:function(s){var _,f="meet",v=s.split(" ");return v&&v.length&&("meet"!==(f=v.pop())&&"slice"!==f?(_=f,f="meet"):v.length&&(_=v.pop())),{meetOrSlice:f,alignX:"none"!==_?_.slice(1,4):"none",alignY:"none"!==_?_.slice(5,8):"none"}},clearFabricFontCache:function(s){(s=(s||"").toLowerCase())?w.charWidthsCache[s]&&delete w.charWidthsCache[s]:w.charWidthsCache={}},limitDimsByArea:function(s,f){var g=Math.sqrt(f*s),l=Math.floor(f/g);return{x:Math.floor(g),y:l}},capValue:function(s,f,g){return Math.max(s,Math.min(f,g))},findScaleToFit:function(s,f){return Math.min(f.width/s.width,f.height/s.height)},findScaleToCover:function(s,f){return Math.max(f.width/s.width,f.height/s.height)},matrixToSVG:function(s){return"matrix("+s.map(function(f){return w.util.toFixed(f,w.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(s,f){var g=w.util.invertTransform(f),l=w.util.multiplyTransformMatrices(g,s.calcOwnMatrix());w.util.applyTransformToObject(s,l)},addTransformToObject:function(s,f){w.util.applyTransformToObject(s,w.util.multiplyTransformMatrices(f,s.calcOwnMatrix()))},applyTransformToObject:function(s,f){var g=w.util.qrDecompose(f),l=new w.Point(g.translateX,g.translateY);s.flipX=!1,s.flipY=!1,s.set("scaleX",g.scaleX),s.set("scaleY",g.scaleY),s.skewX=g.skewX,s.skewY=g.skewY,s.angle=g.angle,s.setPositionByOrigin(l,"center","center")},sizeAfterTransform:function(s,f,g){var l=s/2,v=f/2,_=[{x:-l,y:-v},{x:l,y:-v},{x:-l,y:v},{x:l,y:v}],b=w.util.calcDimensionsMatrix(g),S=w.util.makeBoundingBoxFromPoints(_,b);return{x:S.width,y:S.height}},mergeClipPaths:function(s,f){var g=s,l=f;g.inverted&&!l.inverted&&(g=f,l=s),w.util.applyTransformToObject(l,w.util.multiplyTransformMatrices(w.util.invertTransform(g.calcTransformMatrix()),l.calcTransformMatrix()));var v=g.inverted&&l.inverted;return v&&(g.inverted=l.inverted=!1),new w.Group([g],{clipPath:l,inverted:v})},hasStyleChanged:function(s,f,g){return g=g||!1,s.fill!==f.fill||s.stroke!==f.stroke||s.strokeWidth!==f.strokeWidth||s.fontSize!==f.fontSize||s.fontFamily!==f.fontFamily||s.fontWeight!==f.fontWeight||s.fontStyle!==f.fontStyle||s.textBackgroundColor!==f.textBackgroundColor||s.deltaY!==f.deltaY||g&&(s.overline!==f.overline||s.underline!==f.underline||s.linethrough!==f.linethrough)},stylesToArray:function(g,f){g=w.util.object.clone(g,!0);for(var l=f.split("\n"),v=-1,_={},b=[],S=0;S<l.length;S++)if(g[S])for(var T=0;T<l[S].length;T++){v++;var M=g[S][T];M&&Object.keys(M).length>0&&(w.util.hasStyleChanged(_,M,!0)?b.push({start:v,end:v+1,style:M}):b[b.length-1].end++),_=M||{}}else v+=l[S].length;return b},stylesFromArray:function(s,f){if(!Array.isArray(s))return s;for(var g=f.split("\n"),l=-1,v=0,_={},b=0;b<g.length;b++)for(var S=0;S<g[b].length;S++)l++,s[v]&&s[v].start<=l&&l<s[v].end&&(_[b]=_[b]||{},_[b][S]=Object.assign({},s[v].style),l===s[v].end-1&&v++);return _}},function(){var y=Array.prototype.join,h={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},p={m:"l",M:"L"};function d(I,N,L,R,$,F,O,B,U,K,W){var te=w.util.cos(I),oe=w.util.sin(I),he=w.util.cos(N),Y=w.util.sin(N),H=L*$*he-R*F*Y+O,J=R*$*he+L*F*Y+B;return["C",K+U*(-L*$*oe-R*F*te),W+U*(-R*$*oe+L*F*te),H+U*(L*$*Y+R*F*he),J+U*(R*$*Y-L*F*he),H,J]}function c(I,N,L,R){var $=Math.atan2(N,I),F=Math.atan2(R,L);return F>=$?F-$:2*Math.PI-($-F)}function f(I,N,L){for(var W=function a(I,N,L,R,$,F,O){var B=Math.PI,U=O*B/180,K=w.util.sin(U),W=w.util.cos(U),te=0,oe=0,he=-W*I*.5-K*N*.5,Y=-W*N*.5+K*I*.5,H=(L=Math.abs(L))*L,J=(R=Math.abs(R))*R,ee=Y*Y,X=he*he,ne=H*J-H*ee-J*X,de=0;if(ne<0){var xe=Math.sqrt(1-ne/(H*J));L*=xe,R*=xe}else de=($===F?-1:1)*Math.sqrt(ne/(H*ee+J*X));var we=de*L*Y/R,Q=-de*R*he/L,be=W*we-K*Q+.5*I,Oe=K*we+W*Q+.5*N,Le=c(1,0,(he-we)/L,(Y-Q)/R),Je=c((he-we)/L,(Y-Q)/R,(-he-we)/L,(-Y-Q)/R);0===F&&Je>0?Je-=2*B:1===F&&Je<0&&(Je+=2*B);for(var We=Math.ceil(Math.abs(Je/B*2)),vt=[],qe=Je/We,pn=8/3*Math.sin(qe/4)*Math.sin(qe/4)/Math.sin(qe/2),ii=Le+qe,$t=0;$t<We;$t++)vt[$t]=d(Le,ii,W,K,L,R,be,Oe,pn,te,oe),te=vt[$t][5],oe=vt[$t][6],Le=ii,ii+=qe;return vt}(L[6]-I,L[7]-N,L[1],L[2],L[4],L[5],L[3]),te=0,oe=W.length;te<oe;te++)W[te][1]+=I,W[te][2]+=N,W[te][3]+=I,W[te][4]+=N,W[te][5]+=I,W[te][6]+=N;return W}function l(I,N,L,R){return Math.sqrt((L-I)*(L-I)+(R-N)*(R-N))}function T(I,N,L,R,$,F,O,B){return function(U){var K=function v(I){return I*I*I}(U),W=function _(I){return 3*I*I*(1-I)}(U),te=function b(I){return 3*I*(1-I)*(1-I)}(U),oe=function S(I){return(1-I)*(1-I)*(1-I)}(U);return{x:O*K+$*W+L*te+I*oe,y:B*K+F*W+R*te+N*oe}}}function M(I,N,L,R,$,F,O,B){return function(U){var K=1-U;return Math.atan2(3*K*K*(R-N)+6*K*U*(F-R)+3*U*U*(B-F),3*K*K*(L-I)+6*K*U*($-L)+3*U*U*(O-$))}}function re(I,N,L,R,$,F){return function(O){var B=function P(I){return I*I}(O),U=function j(I){return 2*I*(1-I)}(O),K=function G(I){return(1-I)*(1-I)}(O);return{x:$*B+L*U+I*K,y:F*B+R*U+N*K}}}function le(I,N,L,R,$,F){return function(O){var B=1-O;return Math.atan2(2*B*(R-N)+2*O*(F-R),2*B*(L-I)+2*O*($-L))}}function ge(I,N,L){var $,O,R={x:N,y:L},F=0;for(O=1;O<=100;O+=1)$=I(O/100),F+=l(R.x,R.y,$.x,$.y),R=$;return F}function ce(I){for(var R,K,W,te,N=0,L=I.length,$=0,F=0,O=0,B=0,U=[],oe=0;oe<L;oe++){switch(W={x:$,y:F,command:(R=I[oe])[0]},R[0]){case"M":W.length=0,O=$=R[1],B=F=R[2];break;case"L":W.length=l($,F,R[1],R[2]),$=R[1],F=R[2];break;case"C":K=T($,F,R[1],R[2],R[3],R[4],R[5],R[6]),te=M($,F,R[1],R[2],R[3],R[4],R[5],R[6]),W.iterator=K,W.angleFinder=te,W.length=ge(K,$,F),$=R[5],F=R[6];break;case"Q":K=re($,F,R[1],R[2],R[3],R[4]),te=le($,F,R[1],R[2],R[3],R[4]),W.iterator=K,W.angleFinder=te,W.length=ge(K,$,F),$=R[3],F=R[4];break;case"Z":case"z":W.destX=O,W.destY=B,W.length=l($,F,O,B),$=O,F=B}N+=W.length,U.push(W)}return U.push({length:N,x:$,y:F}),U}w.util.joinPath=function(I){return I.map(function(N){return N.join(" ")}).join(" ")},w.util.parsePath=function _e(I){var R,$,te,oe,he,N=[],L=[],F=w.rePathCommand,O="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",B="("+O+")"+w.commaWsp,U="([01])"+w.commaWsp+"?",W=new RegExp(B+"?"+B+"?"+B+U+U+B+"?("+O+")","g");if(!I||!I.match)return N;for(var H,Y=0,J=(he=I.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;Y<J;Y++){oe=(R=he[Y]).slice(1).trim(),L.length=0;var ee=R.charAt(0);if(H=[ee],"a"===ee.toLowerCase())for(var X;X=W.exec(oe);)for(var ne=1;ne<X.length;ne++)L.push(X[ne]);else for(;te=F.exec(oe);)L.push(te[0]);ne=0;for(var de=L.length;ne<de;ne++)$=parseFloat(L[ne]),isNaN($)||H.push($);var xe=h[ee.toLowerCase()],we=p[ee]||ee;if(H.length-1>xe)for(var Q=1,be=H.length;Q<be;Q+=xe)N.push([ee].concat(H.slice(Q,Q+xe))),ee=we;else N.push(H)}return N},w.util.makePathSimpler=function g(I){var O,B,U,W,te,oe,N=0,L=0,R=I.length,$=0,F=0,K=[];for(B=0;B<R;++B){switch(U=!1,(O=I[B].slice(0))[0]){case"l":O[0]="L",O[1]+=N,O[2]+=L;case"L":N=O[1],L=O[2];break;case"h":O[1]+=N;case"H":O[0]="L",O[2]=L,N=O[1];break;case"v":O[1]+=L;case"V":O[0]="L",L=O[1],O[1]=N,O[2]=L;break;case"m":O[0]="M",O[1]+=N,O[2]+=L;case"M":N=O[1],L=O[2],$=O[1],F=O[2];break;case"c":O[0]="C",O[1]+=N,O[2]+=L,O[3]+=N,O[4]+=L,O[5]+=N,O[6]+=L;case"C":te=O[3],oe=O[4],N=O[5],L=O[6];break;case"s":O[0]="S",O[1]+=N,O[2]+=L,O[3]+=N,O[4]+=L;case"S":"C"===W?(te=2*N-te,oe=2*L-oe):(te=N,oe=L),N=O[3],L=O[4],O[0]="C",O[5]=O[3],O[6]=O[4],O[3]=O[1],O[4]=O[2],O[1]=te,O[2]=oe,te=O[3],oe=O[4];break;case"q":O[0]="Q",O[1]+=N,O[2]+=L,O[3]+=N,O[4]+=L;case"Q":te=O[1],oe=O[2],N=O[3],L=O[4];break;case"t":O[0]="T",O[1]+=N,O[2]+=L;case"T":"Q"===W?(te=2*N-te,oe=2*L-oe):(te=N,oe=L),O[0]="Q",N=O[1],L=O[2],O[1]=te,O[2]=oe,O[3]=N,O[4]=L;break;case"a":O[0]="A",O[6]+=N,O[7]+=L;case"A":U=!0,K=K.concat(f(N,L,O)),N=O[6],L=O[7];break;case"z":case"Z":N=$,L=F}U||K.push(O),W=O[0]}return K},w.util.getSmoothPathFromPoints=function ve(I,N){var R,L=[],$=new w.Point(I[0].x,I[0].y),F=new w.Point(I[1].x,I[1].y),O=I.length,B=1,U=0,K=O>2;for(K&&(B=I[2].x<F.x?-1:I[2].x===F.x?0:1,U=I[2].y<F.y?-1:I[2].y===F.y?0:1),L.push(["M",$.x-B*(N=N||0),$.y-U*N]),R=1;R<O;R++){if(!$.eq(F)){var W=$.midPointFrom(F);L.push(["Q",$.x,$.y,W.x,W.y])}$=I[R],R+1<I.length&&(F=I[R+1])}return K&&(B=$.x>I[R-2].x?1:$.x===I[R-2].x?0:-1,U=$.y>I[R-2].y?1:$.y===I[R-2].y?0:-1),L.push(["L",$.x+B*N,$.y+U*N]),L},w.util.getPathSegmentsInfo=ce,w.util.getBoundsOfCurve=function s(I,N,L,R,$,F,O,B){var U;if(w.cachesBoundsOfCurve&&(U=y.call(arguments),w.boundsOfCurveCache[U]))return w.boundsOfCurveCache[U];var H,J,ee,X,ne,de,xe,we,K=Math.sqrt,W=Math.min,te=Math.max,oe=Math.abs,he=[],Y=[[],[]];J=6*I-12*L+6*$,H=-3*I+9*L-9*$+3*O,ee=3*L-3*I;for(var Q=0;Q<2;++Q)if(Q>0&&(J=6*N-12*R+6*F,H=-3*N+9*R-9*F+3*B,ee=3*R-3*N),oe(H)<1e-12){if(oe(J)<1e-12)continue;0<(X=-ee/J)&&X<1&&he.push(X)}else!((xe=J*J-4*ee*H)<0)&&(0<(ne=(-J+(we=K(xe)))/(2*H))&&ne<1&&he.push(ne),0<(de=(-J-we)/(2*H))&&de<1&&he.push(de));for(var We,Le=he.length,Je=Le;Le--;)Y[0][Le]=(We=1-(X=he[Le]))*We*We*I+3*We*We*X*L+3*We*X*X*$+X*X*X*O,Y[1][Le]=We*We*We*N+3*We*We*X*R+3*We*X*X*F+X*X*X*B;Y[0][Je]=I,Y[1][Je]=N,Y[0][Je+1]=O,Y[1][Je+1]=B;var vt=[{x:W.apply(null,Y[0]),y:W.apply(null,Y[1])},{x:te.apply(null,Y[0]),y:te.apply(null,Y[1])}];return w.cachesBoundsOfCurve&&(w.boundsOfCurveCache[U]=vt),vt},w.util.getPointOnPath=function fe(I,N,L){L||(L=ce(I));for(var R=0;N-L[R].length>0&&R<L.length-2;)N-=L[R].length,R++;var U,$=L[R],F=N/$.length,B=I[R];switch($.command){case"M":return{x:$.x,y:$.y,angle:0};case"Z":case"z":return(U=new w.Point($.x,$.y).lerp(new w.Point($.destX,$.destY),F)).angle=Math.atan2($.destY-$.y,$.destX-$.x),U;case"L":return(U=new w.Point($.x,$.y).lerp(new w.Point(B[1],B[2]),F)).angle=Math.atan2(B[2]-$.y,B[1]-$.x),U;case"C":case"Q":return function pe(I,N){for(var O,B,W,L=0,R=0,$=I.iterator,F={x:I.x,y:I.y},U=.01,K=I.angleFinder;R<N&&U>1e-4;)O=$(L),W=L,(B=l(F.x,F.y,O.x,O.y))+R>N?(L-=U,U/=2):(F=O,L+=U,R+=B);return O.angle=K(W),O}($,N)}},w.util.transformPath=function Ce(I,N,L){return L&&(N=w.util.multiplyTransformMatrices(N,[1,0,0,1,-L.x,-L.y])),I.map(function(R){for(var $=R.slice(0),F={},O=1;O<R.length-1;O+=2)F.x=R[O],F.y=R[O+1],F=w.util.transformPoint(F,N),$[O]=F.x,$[O+1]=F.y;return $})}}(),function(){var y=Array.prototype.slice;function c(s,f,g){if(s&&0!==s.length){var l=s.length-1,v=f?s[l][f]:s[l];if(f)for(;l--;)g(s[l][f],v)&&(v=s[l][f]);else for(;l--;)g(s[l],v)&&(v=s[l]);return v}}w.util.array={fill:function a(s,f){for(var g=s.length;g--;)s[g]=f;return s},invoke:function h(s,f){for(var g=y.call(arguments,2),l=[],v=0,_=s.length;v<_;v++)l[v]=g.length?s[v][f].apply(s[v],g):s[v][f].call(s[v]);return l},min:function d(s,f){return c(s,f,function(g,l){return g<l})},max:function p(s,f){return c(s,f,function(g,l){return g>=l})}}}(),function(){function y(p,d,a){if(a)if(!w.isLikelyNode&&d instanceof Element)p=d;else if(d instanceof Array){p=[];for(var c=0,s=d.length;c<s;c++)p[c]=y({},d[c],a)}else if(d&&"object"==typeof d)for(var f in d)"canvas"===f||"group"===f?p[f]=null:d.hasOwnProperty(f)&&(p[f]=y({},d[f],a));else p=d;else for(var f in d)p[f]=d[f];return p}w.util.object={extend:y,clone:function h(p,d){return y({},p,d)}},w.util.object.extend(w.util,w.Observable)}(),function(){function a(c,s){var f=c.charCodeAt(s);if(isNaN(f))return"";if(f<55296||f>57343)return c.charAt(s);if(55296<=f&&f<=56319){if(c.length<=s+1)throw"High surrogate without following low surrogate";var g=c.charCodeAt(s+1);if(56320>g||g>57343)throw"High surrogate without following low surrogate";return c.charAt(s)+c.charAt(s+1)}if(0===s)throw"Low surrogate without preceding high surrogate";var l=c.charCodeAt(s-1);if(55296>l||l>56319)throw"Low surrogate without preceding high surrogate";return!1}w.util.string={camelize:function y(c){return c.replace(/-+(.)?/g,function(s,f){return f?f.toUpperCase():""})},capitalize:function h(c,s){return c.charAt(0).toUpperCase()+(s?c.slice(1):c.slice(1).toLowerCase())},escapeXml:function p(c){return c.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function d(c){var f,s=0,g=[];for(s=0;s<c.length;s++)!1!==(f=a(c,s))&&g.push(f);return g}}}(),function(){var y=Array.prototype.slice,h=function(){},p=function(){for(var f in{toString:1})if("toString"===f)return!1;return!0}(),d=function(f,g,l){for(var v in g)f.prototype[v]=v in f.prototype&&"function"==typeof f.prototype[v]&&(g[v]+"").indexOf("callSuper")>-1?function(_){return function(){var b=this.constructor.superclass;this.constructor.superclass=l;var S=g[_].apply(this,arguments);if(this.constructor.superclass=b,"initialize"!==_)return S}}(v):g[v],p&&(g.toString!==Object.prototype.toString&&(f.prototype.toString=g.toString),g.valueOf!==Object.prototype.valueOf&&(f.prototype.valueOf=g.valueOf))};function a(){}function c(f){for(var g=null,l=this;l.constructor.superclass;){var v=l.constructor.superclass.prototype[f];if(l[f]!==v){g=v;break}l=l.constructor.superclass.prototype}return g?arguments.length>1?g.apply(this,y.call(arguments,1)):g.call(this):console.log("tried to callSuper "+f+", method not found in prototype chain",this)}w.util.createClass=function s(){var f=null,g=y.call(arguments,0);function l(){this.initialize.apply(this,arguments)}"function"==typeof g[0]&&(f=g.shift()),l.superclass=f,l.subclasses=[],f&&(a.prototype=f.prototype,l.prototype=new a,f.subclasses.push(l));for(var v=0,_=g.length;v<_;v++)d(l,g[v],f);return l.prototype.initialize||(l.prototype.initialize=h),l.prototype.constructor=l,l.prototype.callSuper=c,l}}(),function(){var y=!!w.document.createElement("div").attachEvent,h=["touchstart","touchmove","touchend"];w.util.addListener=function(d,a,c,s){d&&d.addEventListener(a,c,!y&&s)},w.util.removeListener=function(d,a,c,s){d&&d.removeEventListener(a,c,!y&&s)},w.util.getPointer=function(d){var c=w.util.getScrollLeftTop(d.target),s=function p(d){var a=d.changedTouches;return a&&a[0]?a[0]:d}(d);return{x:s.clientX+c.left,y:s.clientY+c.top}},w.util.isTouchEvent=function(d){return h.indexOf(d.type)>-1||"touch"===d.pointerType}}(),function(){var h=w.document.createElement("div"),a=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,c=function(s){return s};"string"==typeof h.style.opacity?c=function(s,f){return s.style.opacity=f,s}:"string"==typeof h.style.filter&&(c=function(s,f){var g=s.style;return s.currentStyle&&!s.currentStyle.hasLayout&&(g.zoom=1),a.test(g.filter)?g.filter=g.filter.replace(a,f=f>=.9999?"":"alpha(opacity="+100*f+")"):g.filter+=" alpha(opacity="+100*f+")",s}),w.util.setStyle=function y(s,f){var g=s.style;if(!g)return s;if("string"==typeof f)return s.style.cssText+=";"+f,f.indexOf("opacity")>-1?c(s,f.match(/opacity:\s*(\d?\.?\d*)/)[1]):s;for(var l in f)"opacity"===l?c(s,f[l]):g.setProperty("float"===l||"cssFloat"===l?typeof g.styleFloat>"u"?"cssFloat":"styleFloat":l,f[l]);return s}}(),function(){var p,l,S,T,y=Array.prototype.slice,d=function(S){return y.call(S,0)};try{p=d(w.document.childNodes)instanceof Array}catch{}function a(S,T){var M=w.document.createElement(S);for(var P in T)"class"===P?M.className=T[P]:"for"===P?M.htmlFor=T[P]:M.setAttribute(P,T[P]);return M}function f(S){for(var T=0,M=0,P=w.document.documentElement,j=w.document.body||{scrollLeft:0,scrollTop:0};S&&(S.parentNode||S.host)&&((S=S.parentNode||S.host)===w.document?(T=j.scrollLeft||P.scrollLeft||0,M=j.scrollTop||P.scrollTop||0):(T+=S.scrollLeft||0,M+=S.scrollTop||0),1!==S.nodeType||"fixed"!==S.style.position););return{left:T,top:M}}p||(d=function(S){for(var T=new Array(S.length),M=S.length;M--;)T[M]=S[M];return T}),l=w.document.defaultView&&w.document.defaultView.getComputedStyle?function(S,T){var M=w.document.defaultView.getComputedStyle(S,null);return M?M[T]:void 0}:function(S,T){var M=S.style[T];return!M&&S.currentStyle&&(M=S.currentStyle[T]),M},T="userSelect"in(S=w.document.documentElement.style)?"userSelect":"MozUserSelect"in S?"MozUserSelect":"WebkitUserSelect"in S?"WebkitUserSelect":"KhtmlUserSelect"in S?"KhtmlUserSelect":"",w.util.makeElementUnselectable=function M(j){return typeof j.onselectstart<"u"&&(j.onselectstart=w.util.falseFunction),T?j.style[T]="none":"string"==typeof j.unselectable&&(j.unselectable="on"),j},w.util.makeElementSelectable=function P(j){return typeof j.onselectstart<"u"&&(j.onselectstart=null),T?j.style[T]="":"string"==typeof j.unselectable&&(j.unselectable=""),j},w.util.setImageSmoothing=function b(S,T){S.imageSmoothingEnabled=S.imageSmoothingEnabled||S.webkitImageSmoothingEnabled||S.mozImageSmoothingEnabled||S.msImageSmoothingEnabled||S.oImageSmoothingEnabled,S.imageSmoothingEnabled=T},w.util.getById=function h(S){return"string"==typeof S?w.document.getElementById(S):S},w.util.toArray=d,w.util.addClass=function c(S,T){S&&-1===(" "+S.className+" ").indexOf(" "+T+" ")&&(S.className+=(S.className?" ":"")+T)},w.util.makeElement=a,w.util.wrapElement=function s(S,T,M){return"string"==typeof T&&(T=a(T,M)),S.parentNode&&S.parentNode.replaceChild(T,S),T.appendChild(S),T},w.util.getScrollLeftTop=f,w.util.getElementOffset=function g(S){var T,G,M=S&&S.ownerDocument,P={left:0,top:0},j={left:0,top:0},re={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!M)return j;for(var le in re)j[re[le]]+=parseInt(l(S,le),10)||0;return T=M.documentElement,typeof S.getBoundingClientRect<"u"&&(P=S.getBoundingClientRect()),G=f(S),{left:P.left+G.left-(T.clientLeft||0)+j.left,top:P.top+G.top-(T.clientTop||0)+j.top}},w.util.getNodeCanvas=function v(S){var T=w.jsdomImplForWrapper(S);return T._canvas||T._image},w.util.cleanUpJsdomNode=function _(S){if(w.isLikelyNode){var T=w.jsdomImplForWrapper(S);T&&(T._image=null,T._canvas=null,T._currentSrc=null,T._attributes=null,T._classList=null)}}}(),function(){function h(){}w.util.request=function p(d,a){a||(a={});var c=a.method?a.method.toUpperCase():"GET",s=a.onComplete||function(){},f=new w.window.XMLHttpRequest,g=a.body||a.parameters;return f.onreadystatechange=function(){4===f.readyState&&(s(f),f.onreadystatechange=h)},"GET"===c&&(g=null,"string"==typeof a.parameters&&(d=function y(d,a){return d+(/\?/.test(d)?"&":"?")+a}(d,a.parameters))),f.open(c,d,!0),("POST"===c||"PUT"===c)&&f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.send(g),f}}(),w.log=console.log,w.warn=console.warn,function(){var y=w.util.object.extend,h=w.util.object.clone,p=[];function d(){return!1}function a(v,_,b,S){return-b*Math.cos(v/S*(Math.PI/2))+b+_}w.util.object.extend(p,{cancelAll:function(){var v=this.splice(0);return v.forEach(function(_){_.cancel()}),v},cancelByCanvas:function(v){if(!v)return[];var _=this.filter(function(b){return"object"==typeof b.target&&b.target.canvas===v});return _.forEach(function(b){b.cancel()}),_},cancelByTarget:function(v){var _=this.findAnimationsByTarget(v);return _.forEach(function(b){b.cancel()}),_},findAnimationIndex:function(v){return this.indexOf(this.findAnimation(v))},findAnimation:function(v){return this.find(function(_){return _.cancel===v})},findAnimationsByTarget:function(v){return v?this.filter(function(_){return _.target===v}):[]}});var s=w.window.requestAnimationFrame||w.window.webkitRequestAnimationFrame||w.window.mozRequestAnimationFrame||w.window.oRequestAnimationFrame||w.window.msRequestAnimationFrame||function(v){return w.window.setTimeout(v,1e3/60)},f=w.window.cancelAnimationFrame||w.window.clearTimeout;function g(){return s.apply(w.window,arguments)}w.util.animate=function c(v){v||(v={});var b,_=!1,S=function(){var T=w.runningAnimations.indexOf(b);return T>-1&&w.runningAnimations.splice(T,1)[0]};return b=y(h(v),{cancel:function(){return _=!0,S()},currentValue:"startValue"in v?v.startValue:0,completionRate:0,durationRate:0}),w.runningAnimations.push(b),g(function(T){var G,M=T||+new Date,P=v.duration||500,j=M+P,re=v.onChange||d,le=v.abort||d,ge=v.onComplete||d,pe=v.easing||a,ce="startValue"in v&&v.startValue.length>0,fe="startValue"in v?v.startValue:0,_e="endValue"in v?v.endValue:100,ve=v.byValue||(ce?fe.map(function(Ce,I){return _e[I]-fe[I]}):_e-fe);v.onStart&&v.onStart(),function Ce(I){var N=(G=I||+new Date)>j?P:G-M,L=N/P,R=ce?fe.map(function(F,O){return pe(N,fe[O],ve[O],P)}):pe(N,fe,ve,P),$=Math.abs(ce?(R[0]-fe[0])/ve[0]:(R-fe)/ve);if(b.currentValue=ce?R.slice():R,b.completionRate=$,b.durationRate=L,!_){if(le(R,$,L))return void S();if(G>j)return b.currentValue=ce?_e.slice():_e,b.completionRate=1,b.durationRate=1,re(ce?_e.slice():_e,1,1),ge(_e,1,1),void S();re(R,$,L),g(Ce)}}(M)}),b.cancel},w.util.requestAnimFrame=g,w.util.cancelAnimFrame=function l(){return f.apply(w.window,arguments)},w.runningAnimations=p}(),function(){function y(p,d,a){var c="rgba("+parseInt(p[0]+a*(d[0]-p[0]),10)+","+parseInt(p[1]+a*(d[1]-p[1]),10)+","+parseInt(p[2]+a*(d[2]-p[2]),10);return(c+=","+(p&&d?parseFloat(p[3]+a*(d[3]-p[3])):1))+")"}w.util.animateColor=function h(p,d,a,c){var s=new w.Color(p).getSource(),f=new w.Color(d).getSource(),g=c.onComplete,l=c.onChange;return w.util.animate(w.util.object.extend(c=c||{},{duration:a||500,startValue:s,endValue:f,byValue:f,easing:function(v,_,b,S){return y(_,b,c.colorEasing?c.colorEasing(v,S):1-Math.cos(v/S*(Math.PI/2)))},onComplete:function(v,_,b){if(g)return g(y(f,f,0),_,b)},onChange:function(v,_,b){if(l){if(Array.isArray(v))return l(y(v,v,0),_,b);l(v,_,b)}}}))}}(),function(){function y(I,N,L,R){return I<Math.abs(N)?(I=N,R=L/4):R=0===N&&0===I?L/(2*Math.PI)*Math.asin(1):L/(2*Math.PI)*Math.asin(N/I),{a:I,c:N,p:L,s:R}}function h(I,N,L){return I.a*Math.pow(2,10*(N-=1))*Math.sin((N*L-I.s)*(2*Math.PI)/I.p)}function _e(I,N,L,R){return L-ve(R-I,0,L,R)+N}function ve(I,N,L,R){return(I/=R)<1/2.75?L*(7.5625*I*I)+N:I<2/2.75?L*(7.5625*(I-=1.5/2.75)*I+.75)+N:I<2.5/2.75?L*(7.5625*(I-=2.25/2.75)*I+.9375)+N:L*(7.5625*(I-=2.625/2.75)*I+.984375)+N}w.util.ease={easeInQuad:function(I,N,L,R){return L*(I/=R)*I+N},easeOutQuad:function(I,N,L,R){return-L*(I/=R)*(I-2)+N},easeInOutQuad:function(I,N,L,R){return(I/=R/2)<1?L/2*I*I+N:-L/2*(--I*(I-2)-1)+N},easeInCubic:function(I,N,L,R){return L*(I/=R)*I*I+N},easeOutCubic:function p(I,N,L,R){return L*((I=I/R-1)*I*I+1)+N},easeInOutCubic:function d(I,N,L,R){return(I/=R/2)<1?L/2*I*I*I+N:L/2*((I-=2)*I*I+2)+N},easeInQuart:function a(I,N,L,R){return L*(I/=R)*I*I*I+N},easeOutQuart:function c(I,N,L,R){return-L*((I=I/R-1)*I*I*I-1)+N},easeInOutQuart:function s(I,N,L,R){return(I/=R/2)<1?L/2*I*I*I*I+N:-L/2*((I-=2)*I*I*I-2)+N},easeInQuint:function f(I,N,L,R){return L*(I/=R)*I*I*I*I+N},easeOutQuint:function g(I,N,L,R){return L*((I=I/R-1)*I*I*I*I+1)+N},easeInOutQuint:function l(I,N,L,R){return(I/=R/2)<1?L/2*I*I*I*I*I+N:L/2*((I-=2)*I*I*I*I+2)+N},easeInSine:function v(I,N,L,R){return-L*Math.cos(I/R*(Math.PI/2))+L+N},easeOutSine:function _(I,N,L,R){return L*Math.sin(I/R*(Math.PI/2))+N},easeInOutSine:function b(I,N,L,R){return-L/2*(Math.cos(Math.PI*I/R)-1)+N},easeInExpo:function S(I,N,L,R){return 0===I?N:L*Math.pow(2,10*(I/R-1))+N},easeOutExpo:function T(I,N,L,R){return I===R?N+L:L*(1-Math.pow(2,-10*I/R))+N},easeInOutExpo:function M(I,N,L,R){return 0===I?N:I===R?N+L:(I/=R/2)<1?L/2*Math.pow(2,10*(I-1))+N:L/2*(2-Math.pow(2,-10*--I))+N},easeInCirc:function P(I,N,L,R){return-L*(Math.sqrt(1-(I/=R)*I)-1)+N},easeOutCirc:function j(I,N,L,R){return L*Math.sqrt(1-(I=I/R-1)*I)+N},easeInOutCirc:function G(I,N,L,R){return(I/=R/2)<1?-L/2*(Math.sqrt(1-I*I)-1)+N:L/2*(Math.sqrt(1-(I-=2)*I)+1)+N},easeInElastic:function re(I,N,L,R){var F=0;return 0===I?N:1==(I/=R)?N+L:(F||(F=.3*R),-h(y(L,L,F,1.70158),I,R)+N)},easeOutElastic:function le(I,N,L,R){var F=0;if(0===I)return N;if(1==(I/=R))return N+L;F||(F=.3*R);var B=y(L,L,F,1.70158);return B.a*Math.pow(2,-10*I)*Math.sin((I*R-B.s)*(2*Math.PI)/B.p)+B.c+N},easeInOutElastic:function ge(I,N,L,R){var F=0;if(0===I)return N;if(2==(I/=R/2))return N+L;F||(F=R*(.3*1.5));var B=y(L,L,F,1.70158);return I<1?-.5*h(B,I,R)+N:B.a*Math.pow(2,-10*(I-=1))*Math.sin((I*R-B.s)*(2*Math.PI)/B.p)*.5+B.c+N},easeInBack:function pe(I,N,L,R,$){return void 0===$&&($=1.70158),L*(I/=R)*I*(($+1)*I-$)+N},easeOutBack:function ce(I,N,L,R,$){return void 0===$&&($=1.70158),L*((I=I/R-1)*I*(($+1)*I+$)+1)+N},easeInOutBack:function fe(I,N,L,R,$){return void 0===$&&($=1.70158),(I/=R/2)<1?L/2*(I*I*((1+($*=1.525))*I-$))+N:L/2*((I-=2)*I*((1+($*=1.525))*I+$)+2)+N},easeInBounce:_e,easeOutBounce:ve,easeInOutBounce:function Ce(I,N,L,R){return I<R/2?.5*_e(2*I,0,L,R)+N:.5*ve(2*I-R,0,L,R)+.5*L+N}}}(),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.object.extend,d=h.util.object.clone,a=h.util.toFixed,c=h.util.parseUnit,s=h.util.multiplyTransformMatrices,_={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},b={stroke:"strokeOpacity",fill:"fillOpacity"},S="font-size",T="clip-path";function M(F){return F in _?_[F]:F}function P(F,O,B,U){var W,K=Array.isArray(O);if("fill"!==F&&"stroke"!==F||"none"!==O){if("strokeUniform"===F)return"non-scaling-stroke"===O;if("strokeDashArray"===F)O="none"===O?null:O.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===F)O=B&&B.transformMatrix?s(B.transformMatrix,h.parseTransformAttribute(O)):h.parseTransformAttribute(O);else if("visible"===F)O="none"!==O&&"hidden"!==O,B&&!1===B.visible&&(O=!1);else if("opacity"===F)O=parseFloat(O),B&&typeof B.opacity<"u"&&(O*=B.opacity);else if("textAnchor"===F)O="start"===O?"left":"end"===O?"right":"center";else if("charSpacing"===F)W=c(O,U)/U*1e3;else if("paintFirst"===F){var te=O.indexOf("fill"),oe=O.indexOf("stroke");O="fill",(te>-1&&oe>-1&&oe<te||-1===te&&oe>-1)&&(O="stroke")}else{if("href"===F||"xlink:href"===F||"font"===F)return O;if("imageSmoothing"===F)return"optimizeQuality"===O;W=K?O.map(c):c(O,U)}}else O="";return!K&&isNaN(W)?O:W}function j(F){return new RegExp("^("+F.join("|")+")\\b","i")}function re(F,O){var K,W,te,U=[];for(W=0,te=O.length;W<te;W++)K=F.getElementsByTagName(O[W]),U=U.concat(Array.prototype.slice.call(K));return U}function ce(F,O){var B,U=!0;return(B=_e(F,O.pop()))&&O.length&&(U=function fe(F,O){for(var B,U=!0;F.parentNode&&1===F.parentNode.nodeType&&O.length;)U&&(B=O.pop()),U=_e(F=F.parentNode,B);return 0===O.length}(F,O)),B&&U&&0===O.length}function _e(F,O){var W,te,B=F.nodeName,U=F.getAttribute("class"),K=F.getAttribute("id");if(W=new RegExp("^"+B,"i"),O=O.replace(W,""),K&&O.length&&(W=new RegExp("#"+K+"(?![a-zA-Z\\-]+)","i"),O=O.replace(W,"")),U&&O.length)for(te=(U=U.split(" ")).length;te--;)W=new RegExp("\\."+U[te]+"(?![a-zA-Z\\-]+)","i"),O=O.replace(W,"");return 0===O.length}function ve(F,O){var B;if(F.getElementById&&(B=F.getElementById(O)),B)return B;var U,K,W,te=F.getElementsByTagName("*");for(K=0,W=te.length;K<W;K++)if(O===(U=te[K]).getAttribute("id"))return U}h.svgValidTagNamesRegEx=j(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),h.svgViewBoxElementsRegEx=j(["symbol","image","marker","pattern","view","svg"]),h.svgInvalidAncestorsRegEx=j(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),h.svgValidParentsRegEx=j(["symbol","g","a","svg","clipPath","defs"]),h.cssRules={},h.gradientDefs={},h.clipPaths={},h.parseTransformAttribute=function(){function B(Q,be,Oe){Q[Oe]=Math.tan(h.util.degreesToRadians(be[0]))}var K=h.iMatrix,W=h.reNum,te=h.commaWsp,X="(?:(?:(matrix)\\s*\\(\\s*("+W+")"+te+"("+W+")"+te+"("+W+")"+te+"("+W+")"+te+"("+W+")"+te+"("+W+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+W+")(?:"+te+"("+W+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+W+")(?:"+te+"("+W+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+W+")(?:"+te+"("+W+")"+te+"("+W+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+W+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+W+")\\s*\\)))",xe=new RegExp("^\\s*(?:(?:"+X+"(?:"+te+"*"+X+")*)?)\\s*$"),we=new RegExp(X,"g");return function(Q){var be=K.concat(),Oe=[];if(!Q||Q&&!xe.test(Q))return be;Q.replace(we,function(Je){var We=new RegExp(X).exec(Je).filter(function(pn){return!!pn}),vt=We[1],qe=We.slice(2).map(parseFloat);switch(vt){case"translate":!function U(Q,be){Q[4]=be[0],2===be.length&&(Q[5]=be[1])}(be,qe);break;case"rotate":qe[0]=h.util.degreesToRadians(qe[0]),function F(Q,be){var Oe=h.util.cos(be[0]),Le=h.util.sin(be[0]),Je=0,We=0;3===be.length&&(Je=be[1],We=be[2]),Q[0]=Oe,Q[1]=Le,Q[2]=-Le,Q[3]=Oe,Q[4]=Je-(Oe*Je-Le*We),Q[5]=We-(Le*Je+Oe*We)}(be,qe);break;case"scale":!function O(Q,be){var Le=2===be.length?be[1]:be[0];Q[0]=be[0],Q[3]=Le}(be,qe);break;case"skewX":B(be,qe,2);break;case"skewY":B(be,qe,1);break;case"matrix":be=qe}Oe.push(be.concat()),be=K.concat()});for(var Le=Oe[0];Oe.length>1;)Oe.shift(),Le=h.util.multiplyTransformMatrices(Le,Oe[0]);return Le}}();var I=new RegExp("^\\s*("+h.reNum+"+)\\s*,?\\s*("+h.reNum+"+)\\s*,?\\s*("+h.reNum+"+)\\s*,?\\s*("+h.reNum+"+)\\s*$");function N(F){if(!h.svgViewBoxElementsRegEx.test(F.nodeName))return{};var K,W,te,oe,he,Y,O=F.getAttribute("viewBox"),B=1,U=1,H=F.getAttribute("width"),J=F.getAttribute("height"),ee=F.getAttribute("x")||0,X=F.getAttribute("y")||0,ne=F.getAttribute("preserveAspectRatio")||"",de=!O||!(O=O.match(I)),xe=!H||!J||"100%"===H||"100%"===J,we=de&&xe,Q={},be="",Oe=0,Le=0;if(Q.width=0,Q.height=0,Q.toBeParsed=we,de&&(ee||X)&&F.parentNode&&"#document"!==F.parentNode.nodeName&&(be=" translate("+c(ee)+" "+c(X)+") ",he=(F.getAttribute("transform")||"")+be,F.setAttribute("transform",he),F.removeAttribute("x"),F.removeAttribute("y")),we)return Q;if(de)return Q.width=c(H),Q.height=c(J),Q;if(K=-parseFloat(O[1]),W=-parseFloat(O[2]),te=parseFloat(O[3]),oe=parseFloat(O[4]),Q.minX=K,Q.minY=W,Q.viewBoxWidth=te,Q.viewBoxHeight=oe,xe?(Q.width=te,Q.height=oe):(Q.width=c(H),Q.height=c(J),B=Q.width/te,U=Q.height/oe),"none"!==(ne=h.util.parsePreserveAspectRatioAttribute(ne)).alignX&&("meet"===ne.meetOrSlice&&(U=B=B>U?U:B),"slice"===ne.meetOrSlice&&(U=B=B>U?B:U),Oe=Q.width-te*B,Le=Q.height-oe*B,"Mid"===ne.alignX&&(Oe/=2),"Mid"===ne.alignY&&(Le/=2),"Min"===ne.alignX&&(Oe=0),"Min"===ne.alignY&&(Le=0)),1===B&&1===U&&0===K&&0===W&&0===ee&&0===X)return Q;if((ee||X)&&"#document"!==F.parentNode.nodeName&&(be=" translate("+c(ee)+" "+c(X)+") "),he=be+" matrix("+B+" 0 0 "+U+" "+(K*B+Oe)+" "+(W*U+Le)+") ","svg"===F.nodeName){for(Y=F.ownerDocument.createElementNS(h.svgNS,"g");F.firstChild;)Y.appendChild(F.firstChild);F.appendChild(Y)}else(Y=F).removeAttribute("x"),Y.removeAttribute("y"),he=Y.getAttribute("transform")+he;return Y.setAttribute("transform",he),Q}function R(F,O){var U="xlink:href",W=ve(F,O.getAttribute(U).slice(1));if(W&&W.getAttribute(U)&&R(F,W),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach(function(oe){W&&!O.hasAttribute(oe)&&W.hasAttribute(oe)&&O.setAttribute(oe,W.getAttribute(oe))}),!O.children.length)for(var te=W.cloneNode(!0);te.firstChild;)O.appendChild(te.firstChild);O.removeAttribute(U)}h.parseSVGDocument=function(F,O,B,U){if(F){!function Ce(F){for(var O=re(F,["use","svg:use"]),B=0;O.length&&B<O.length;){var U=O[B],K=U.getAttribute("xlink:href")||U.getAttribute("href");if(null===K)return;var ee,X,ne,de,W=K.slice(1),te=U.getAttribute("x")||0,oe=U.getAttribute("y")||0,he=ve(F,W).cloneNode(!0),Y=(he.getAttribute("transform")||"")+" translate("+te+", "+oe+")",J=O.length,xe=h.svgNS;if(N(he),/^svg$/i.test(he.nodeName)){var we=he.ownerDocument.createElementNS(xe,"g");for(X=0,de=(ne=he.attributes).length;X<de;X++)ee=ne.item(X),we.setAttributeNS(xe,ee.nodeName,ee.nodeValue);for(;he.firstChild;)we.appendChild(he.firstChild);he=we}for(X=0,de=(ne=U.attributes).length;X<de;X++)"x"!==(ee=ne.item(X)).nodeName&&"y"!==ee.nodeName&&"xlink:href"!==ee.nodeName&&"href"!==ee.nodeName&&("transform"===ee.nodeName?Y=ee.nodeValue+" "+Y:he.setAttribute(ee.nodeName,ee.nodeValue));he.setAttribute("transform",Y),he.setAttribute("instantiated_by_use","1"),he.removeAttribute("id"),U.parentNode.replaceChild(he,U),O.length===J&&B++}}(F);var W,te,K=h.Object.__uid++,oe=N(F),he=h.util.toArray(F.getElementsByTagName("*"));if(oe.crossOrigin=U&&U.crossOrigin,oe.svgUid=K,0===he.length&&h.isLikelyNode){var Y=[];for(W=0,te=(he=F.selectNodes('//*[name(.)!="svg"]')).length;W<te;W++)Y[W]=he[W];he=Y}var H=he.filter(function(ee){return N(ee),h.svgValidTagNamesRegEx.test(ee.nodeName.replace("svg:",""))&&!function L(F,O){for(;F&&(F=F.parentNode);)if(F.nodeName&&O.test(F.nodeName.replace("svg:",""))&&!F.getAttribute("instantiated_by_use"))return!0;return!1}(ee,h.svgInvalidAncestorsRegEx)});if(!H||H&&!H.length)return void(O&&O([],{}));var J={};he.filter(function(ee){return"clipPath"===ee.nodeName.replace("svg:","")}).forEach(function(ee){var X=ee.getAttribute("id");J[X]=h.util.toArray(ee.getElementsByTagName("*")).filter(function(ne){return h.svgValidTagNamesRegEx.test(ne.nodeName.replace("svg:",""))})}),h.gradientDefs[K]=h.getGradientDefs(F),h.cssRules[K]=h.getCSSRules(F),h.clipPaths[K]=J,h.parseElements(H,function(ee,X){O&&(O(ee,oe,X,he),delete h.gradientDefs[K],delete h.cssRules[K],delete h.clipPaths[K])},d(oe),B,U)}};var $=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+h.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+h.reNum+"))?\\s+(.*)");p(h,{parseFontDeclaration:function(F,O){var B=F.match($);if(B){var U=B[1],K=B[3],W=B[4],te=B[5],oe=B[6];U&&(O.fontStyle=U),K&&(O.fontWeight=isNaN(parseFloat(K))?K:parseFloat(K)),W&&(O.fontSize=c(W)),oe&&(O.fontFamily=oe),te&&(O.lineHeight="normal"===te?1:te)}},getGradientDefs:function(F){var U,B=re(F,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),K=0,W={};for(K=B.length;K--;)(U=B[K]).getAttribute("xlink:href")&&R(F,U),W[U.getAttribute("id")]=U;return W},parseAttributes:function(F,O,B){if(F){var U,W,te,K={};typeof B>"u"&&(B=F.getAttribute("svgUid")),F.parentNode&&h.svgValidParentsRegEx.test(F.parentNode.nodeName)&&(K=h.parseAttributes(F.parentNode,O,B));var oe=O.reduce(function(ne,de){return(U=F.getAttribute(de))&&(ne[de]=U),ne},{}),he=p(function pe(F,O){var B={};for(var U in h.cssRules[O])if(ce(F,U.split(" ")))for(var K in h.cssRules[O][U])B[K]=h.cssRules[O][U][K];return B}(F,B),h.parseStyleAttribute(F));oe=p(oe,he),he[T]&&F.setAttribute(T,he[T]),W=te=K.fontSize||h.Text.DEFAULT_SVG_FONT_SIZE,oe[S]&&(oe[S]=W=c(oe[S],te));var Y,H,J={};for(var ee in oe)H=P(Y=M(ee),oe[ee],K,W),J[Y]=H;J&&J.font&&h.parseFontDeclaration(J.font,J);var X=p(K,J);return h.svgValidParentsRegEx.test(F.nodeName)?X:function G(F){for(var O in b)if(!(typeof F[b[O]]>"u"||""===F[O])){if(typeof F[O]>"u"){if(!h.Object.prototype[O])continue;F[O]=h.Object.prototype[O]}if(0!==F[O].indexOf("url(")){var B=new h.Color(F[O]);F[O]=B.setAlpha(a(B.getAlpha()*F[b[O]],2)).toRgba()}}return F}(X)}},parseElements:function(F,O,B,U,K){new h.ElementsParser(F,O,B,U,K).parse()},parseStyleAttribute:function(F){var O={},B=F.getAttribute("style");return B&&("string"==typeof B?function le(F,O){var B,U;F.replace(/;\s*$/,"").split(";").forEach(function(K){var W=K.split(":");B=W[0].trim().toLowerCase(),U=W[1].trim(),O[B]=U})}(B,O):function ge(F,O){for(var K in F)typeof F[K]>"u"||(O[K.toLowerCase()]=F[K])}(B,O)),O},parsePointsAttribute:function(F){if(!F)return null;var B,U,O=[];for(B=0,U=(F=(F=F.replace(/,/g," ").trim()).split(/\s+/)).length;B<U;B+=2)O.push({x:parseFloat(F[B]),y:parseFloat(F[B+1])});return O},getCSSRules:function(F){var B,U,O=F.getElementsByTagName("style"),K={};for(B=0,U=O.length;B<U;B++){var te=O[B].textContent;""!==(te=te.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&te.split("}").filter(function(oe){return oe.trim()}).forEach(function(oe){var he=oe.split("{"),Y={},J=he[1].trim().split(";").filter(function(de){return de.trim()});for(B=0,U=J.length;B<U;B++){var ee=J[B].split(":"),X=ee[0].trim(),ne=ee[1].trim();Y[X]=ne}(oe=he[0].trim()).split(",").forEach(function(de){""!==(de=de.replace(/^svg/i,"").trim())&&(K[de]?h.util.object.extend(K[de],Y):K[de]=h.util.object.clone(Y))})})}return K},loadSVGFromURL:function(F,O,B,U){F=F.replace(/^\n\s*/,"").trim(),new h.util.request(F,{method:"get",onComplete:function K(W){var te=W.responseXML;if(!te||!te.documentElement)return O&&O(null),!1;h.parseSVGDocument(te.documentElement,function(oe,he,Y,H){O&&O(oe,he,Y,H)},B,U)}})},loadSVGFromString:function(F,O,B,U){var W=(new h.window.DOMParser).parseFromString(F.trim(),"text/xml");h.parseSVGDocument(W.documentElement,function(te,oe,he,Y){O(te,oe,he,Y)},B,U)}})}(Ie),w.ElementsParser=function(y,h,p,d,a,c){this.elements=y,this.callback=h,this.options=p,this.reviver=d,this.svgUid=p&&p.svgUid||0,this.parsingOptions=a,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=c},function(y){y.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},y.createObjects=function(){var h=this;this.elements.forEach(function(p,d){p.setAttribute("svgUid",h.svgUid),h.createObject(p,d)})},y.findTag=function(h){return w[w.util.string.capitalize(h.tagName.replace("svg:",""))]},y.createObject=function(h,p){var d=this.findTag(h);if(d&&d.fromElement)try{d.fromElement(h,this.createCallback(p,h),this.options)}catch(a){w.log(a)}else this.checkIfDone()},y.createCallback=function(h,p){var d=this;return function(a){var c;d.resolveGradient(a,p,"fill"),d.resolveGradient(a,p,"stroke"),a instanceof w.Image&&a._originalElement&&(c=a.parsePreserveAspectRatioAttribute(p)),a._removeTransformMatrix(c),d.resolveClipPath(a,p),d.reviver&&d.reviver(p,a),d.instances[h]=a,d.checkIfDone()}},y.extractPropertyDefinition=function(h,p,d){var a=h[p],c=this.regexUrl;if(c.test(a)){c.lastIndex=0;var s=c.exec(a)[1];return c.lastIndex=0,w[d][this.svgUid][s]}},y.resolveGradient=function(h,p,d){var a=this.extractPropertyDefinition(h,d,"gradientDefs");if(a){var c=p.getAttribute(d+"-opacity"),s=w.Gradient.fromElement(a,h,c,this.options);h.set(d,s)}},y.createClipPathCallback=function(h,p){return function(d){d._removeTransformMatrix(),d.fillRule=d.clipRule,p.push(d)}},y.resolveClipPath=function(h,p){var a,s,f,g,d=this.extractPropertyDefinition(h,"clipPath","clipPaths");if(d){f=[],s=w.util.invertTransform(h.calcTransformMatrix());for(var v=d[0].parentNode,_=p;_.parentNode&&_.getAttribute("clip-path")!==h.clipPath;)_=_.parentNode;_.parentNode.appendChild(v);for(var b=0;b<d.length;b++)this.findTag(a=d[b]).fromElement(a,this.createClipPathCallback(h,f),this.options);d=1===f.length?f[0]:new w.Group(f),g=w.util.multiplyTransformMatrices(s,d.calcTransformMatrix()),d.clipPath&&this.resolveClipPath(d,_);var l=w.util.qrDecompose(g);d.flipX=!1,d.flipY=!1,d.set("scaleX",l.scaleX),d.set("scaleY",l.scaleY),d.angle=l.angle,d.skewX=l.skewX,d.skewY=0,d.setPositionByOrigin({x:l.translateX,y:l.translateY},"center","center"),h.clipPath=d}else delete h.clipPath},y.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter(function(h){return null!=h}),this.callback(this.instances,this.elements))}}(w.ElementsParser.prototype),function(y){"use strict";var h=y.fabric||(y.fabric={});function p(d,a){this.x=d,this.y=a}h.Point?h.warn("fabric.Point is already defined"):(h.Point=p,p.prototype={type:"point",constructor:p,add:function(d){return new p(this.x+d.x,this.y+d.y)},addEquals:function(d){return this.x+=d.x,this.y+=d.y,this},scalarAdd:function(d){return new p(this.x+d,this.y+d)},scalarAddEquals:function(d){return this.x+=d,this.y+=d,this},subtract:function(d){return new p(this.x-d.x,this.y-d.y)},subtractEquals:function(d){return this.x-=d.x,this.y-=d.y,this},scalarSubtract:function(d){return new p(this.x-d,this.y-d)},scalarSubtractEquals:function(d){return this.x-=d,this.y-=d,this},multiply:function(d){return new p(this.x*d,this.y*d)},multiplyEquals:function(d){return this.x*=d,this.y*=d,this},divide:function(d){return new p(this.x/d,this.y/d)},divideEquals:function(d){return this.x/=d,this.y/=d,this},eq:function(d){return this.x===d.x&&this.y===d.y},lt:function(d){return this.x<d.x&&this.y<d.y},lte:function(d){return this.x<=d.x&&this.y<=d.y},gt:function(d){return this.x>d.x&&this.y>d.y},gte:function(d){return this.x>=d.x&&this.y>=d.y},lerp:function(d,a){return typeof a>"u"&&(a=.5),a=Math.max(Math.min(1,a),0),new p(this.x+(d.x-this.x)*a,this.y+(d.y-this.y)*a)},distanceFrom:function(d){var a=this.x-d.x,c=this.y-d.y;return Math.sqrt(a*a+c*c)},midPointFrom:function(d){return this.lerp(d)},min:function(d){return new p(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new p(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},setXY:function(d,a){return this.x=d,this.y=a,this},setX:function(d){return this.x=d,this},setY:function(d){return this.y=d,this},setFromPoint:function(d){return this.x=d.x,this.y=d.y,this},swap:function(d){var a=this.x,c=this.y;this.x=d.x,this.y=d.y,d.x=a,d.y=c},clone:function(){return new p(this.x,this.y)}})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={});function p(d){this.status=d,this.points=[]}h.Intersection?h.warn("fabric.Intersection is already defined"):(h.Intersection=p,h.Intersection.prototype={constructor:p,appendPoint:function(d){return this.points.push(d),this},appendPoints:function(d){return this.points=this.points.concat(d),this}},h.Intersection.intersectLineLine=function(d,a,c,s){var f,g=(s.x-c.x)*(d.y-c.y)-(s.y-c.y)*(d.x-c.x),l=(a.x-d.x)*(d.y-c.y)-(a.y-d.y)*(d.x-c.x),v=(s.y-c.y)*(a.x-d.x)-(s.x-c.x)*(a.y-d.y);if(0!==v){var _=g/v,b=l/v;0<=_&&_<=1&&0<=b&&b<=1?(f=new p("Intersection")).appendPoint(new h.Point(d.x+_*(a.x-d.x),d.y+_*(a.y-d.y))):f=new p}else f=new p(0===g||0===l?"Coincident":"Parallel");return f},h.Intersection.intersectLinePolygon=function(d,a,c){var v,_,s=new p,f=c.length;for(_=0;_<f;_++)v=p.intersectLineLine(d,a,c[_],c[(_+1)%f]),s.appendPoints(v.points);return s.points.length>0&&(s.status="Intersection"),s},h.Intersection.intersectPolygonPolygon=function(d,a){var f,c=new p,s=d.length;for(f=0;f<s;f++){var v=p.intersectLinePolygon(d[f],d[(f+1)%s],a);c.appendPoints(v.points)}return c.points.length>0&&(c.status="Intersection"),c},h.Intersection.intersectPolygonRectangle=function(d,a,c){var s=a.min(c),f=a.max(c),g=new h.Point(f.x,s.y),l=new h.Point(s.x,f.y),v=p.intersectLinePolygon(s,g,d),_=p.intersectLinePolygon(g,f,d),b=p.intersectLinePolygon(f,l,d),S=p.intersectLinePolygon(l,s,d),T=new p;return T.appendPoints(v.points),T.appendPoints(_.points),T.appendPoints(b.points),T.appendPoints(S.points),T.points.length>0&&(T.status="Intersection"),T})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={});function p(a){a?this._tryParsingColor(a):this.setSource([0,0,0,1])}function d(a,c,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?a+6*(c-a)*s:s<.5?c:s<2/3?a+(c-a)*(2/3-s)*6:a}h.Color?h.warn("fabric.Color is already defined."):(h.Color=p,h.Color.prototype={_tryParsingColor:function(a){var c;a in p.colorNameMap&&(a=p.colorNameMap[a]),"transparent"===a&&(c=[255,255,255,0]),c||(c=p.sourceFromHex(a)),c||(c=p.sourceFromRgb(a)),c||(c=p.sourceFromHsl(a)),c||(c=[0,0,0,1]),c&&this.setSource(c)},_rgbToHsl:function(a,c,s){var f,g,l,v=h.util.array.max([a/=255,c/=255,s/=255]),_=h.util.array.min([a,c,s]);if(l=(v+_)/2,v===_)f=g=0;else{var b=v-_;switch(g=l>.5?b/(2-v-_):b/(v+_),v){case a:f=(c-s)/b+(c<s?6:0);break;case c:f=(s-a)/b+2;break;case s:f=(a-c)/b+4}f/=6}return[Math.round(360*f),Math.round(100*g),Math.round(100*l)]},getSource:function(){return this._source},setSource:function(a){this._source=a},toRgb:function(){var a=this.getSource();return"rgb("+a[0]+","+a[1]+","+a[2]+")"},toRgba:function(){var a=this.getSource();return"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")"},toHsl:function(){var a=this.getSource(),c=this._rgbToHsl(a[0],a[1],a[2]);return"hsl("+c[0]+","+c[1]+"%,"+c[2]+"%)"},toHsla:function(){var a=this.getSource(),c=this._rgbToHsl(a[0],a[1],a[2]);return"hsla("+c[0]+","+c[1]+"%,"+c[2]+"%,"+a[3]+")"},toHex:function(){var c,s,f,a=this.getSource();return c=1===(c=a[0].toString(16)).length?"0"+c:c,s=1===(s=a[1].toString(16)).length?"0"+s:s,f=1===(f=a[2].toString(16)).length?"0"+f:f,c.toUpperCase()+s.toUpperCase()+f.toUpperCase()},toHexa:function(){var c,a=this.getSource();return c=1===(c=(c=Math.round(255*a[3])).toString(16)).length?"0"+c:c,this.toHex()+c.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(a){var c=this.getSource();return c[3]=a,this.setSource(c),this},toGrayscale:function(){var a=this.getSource(),c=parseInt((.3*a[0]+.59*a[1]+.11*a[2]).toFixed(0),10);return this.setSource([c,c,c,a[3]]),this},toBlackWhite:function(a){var c=this.getSource(),s=(.3*c[0]+.59*c[1]+.11*c[2]).toFixed(0),f=c[3];return a=a||127,s=Number(s)<Number(a)?0:255,this.setSource([s,s,s,f]),this},overlayWith:function(a){a instanceof p||(a=new p(a));var v,c=[],s=this.getAlpha(),g=this.getSource(),l=a.getSource();for(v=0;v<3;v++)c.push(Math.round(.5*g[v]+.5*l[v]));return c[3]=s,this.setSource(c),this}},h.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,h.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,h.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,h.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},h.Color.fromRgb=function(a){return p.fromSource(p.sourceFromRgb(a))},h.Color.sourceFromRgb=function(a){var c=a.match(p.reRGBa);if(c){var s=parseInt(c[1],10)/(/%$/.test(c[1])?100:1)*(/%$/.test(c[1])?255:1),f=parseInt(c[2],10)/(/%$/.test(c[2])?100:1)*(/%$/.test(c[2])?255:1),g=parseInt(c[3],10)/(/%$/.test(c[3])?100:1)*(/%$/.test(c[3])?255:1);return[parseInt(s,10),parseInt(f,10),parseInt(g,10),c[4]?parseFloat(c[4]):1]}},h.Color.fromRgba=p.fromRgb,h.Color.fromHsl=function(a){return p.fromSource(p.sourceFromHsl(a))},h.Color.sourceFromHsl=function(a){var c=a.match(p.reHSLa);if(c){var l,v,_,s=(parseFloat(c[1])%360+360)%360/360,f=parseFloat(c[2])/(/%$/.test(c[2])?100:1),g=parseFloat(c[3])/(/%$/.test(c[3])?100:1);if(0===f)l=v=_=g;else{var b=g<=.5?g*(f+1):g+f-g*f,S=2*g-b;l=d(S,b,s+1/3),v=d(S,b,s),_=d(S,b,s-1/3)}return[Math.round(255*l),Math.round(255*v),Math.round(255*_),c[4]?parseFloat(c[4]):1]}},h.Color.fromHsla=p.fromHsl,h.Color.fromHex=function(a){return p.fromSource(p.sourceFromHex(a))},h.Color.sourceFromHex=function(a){if(a.match(p.reHex)){var c=a.slice(a.indexOf("#")+1),s=3===c.length||4===c.length,f=8===c.length||4===c.length,g=s?c.charAt(0)+c.charAt(0):c.substring(0,2),l=s?c.charAt(1)+c.charAt(1):c.substring(2,4),v=s?c.charAt(2)+c.charAt(2):c.substring(4,6),_=f?s?c.charAt(3)+c.charAt(3):c.substring(6,8):"FF";return[parseInt(g,16),parseInt(l,16),parseInt(v,16),parseFloat((parseInt(_,16)/255).toFixed(2))]}},h.Color.fromSource=function(a){var c=new p;return c.setSource(a),c})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=["e","se","s","sw","w","nw","n","ne","e"],d=["ns","nesw","ew","nwse"],a={},c="left",s="top",f="right",g="bottom",l="center",v={top:g,bottom:s,left:f,right:c,center:l},_=h.util.radiansToDegrees,b=Math.sign||function(Y){return(Y>0)-(Y<0)||+Y};function S(Y,H){var J=Y.angle+_(Math.atan2(H.y,H.x))+360;return Math.round(J%360/45)}function T(Y,H){var J=H.transform.target,ee=J.canvas,X=h.util.object.clone(H);X.target=J,ee&&ee.fire("object:"+Y,X),J.fire(Y,H)}function M(Y,H){var J=H.canvas,X=Y[J.uniScaleKey];return J.uniformScaling&&!X||!J.uniformScaling&&X}function P(Y){return Y.originX===l&&Y.originY===l}function j(Y,H,J){var ee=Y.lockScalingX,X=Y.lockScalingY;return!!(ee&&X||!H&&(ee||X)&&J||ee&&"x"===H||X&&"y"===H)}function ce(Y,H,J,ee){return{e:Y,transform:H,pointer:{x:J,y:ee}}}function fe(Y){return function(H,J,ee,X){var ne=J.target,de=ne.getCenterPoint(),xe=ne.translateToOriginPoint(de,J.originX,J.originY),we=Y(H,J,ee,X);return ne.setPositionByOrigin(xe,J.originX,J.originY),we}}function _e(Y,H){return function(J,ee,X,ne){var de=H(J,ee,X,ne);return de&&T(Y,ce(J,ee,X,ne)),de}}function ve(Y,H,J,ee,X){var ne=Y.target,de=ne.controls[Y.corner],xe=ne.canvas.getZoom(),we=ne.padding/xe,Q=ne.toLocalPoint(new h.Point(ee,X),H,J);return Q.x>=we&&(Q.x-=we),Q.x<=-we&&(Q.x+=we),Q.y>=we&&(Q.y-=we),Q.y<=we&&(Q.y+=we),Q.x-=de.offsetX,Q.y-=de.offsetY,Q}function Ce(Y){return Y.flipX!==Y.flipY}function I(Y,H,J,ee,X){if(0!==Y[H]){var ne=Y._getTransformedDimensions()[ee];Y.set(J,X/ne*Y[J])}}function N(Y,H,J,ee){var Q,X=H.target,ne=X._getTransformedDimensions(0,X.skewY),de=ve(H,H.originX,H.originY,J,ee),xe=Math.abs(2*de.x)-ne.x,we=X.skewX;xe<2?Q=0:(Q=_(Math.atan2(xe/X.scaleX,ne.y/X.scaleY)),H.originX===c&&H.originY===g&&(Q=-Q),H.originX===f&&H.originY===s&&(Q=-Q),Ce(X)&&(Q=-Q));var be=we!==Q;if(be){var Oe=X._getTransformedDimensions().y;X.set("skewX",Q),I(X,"skewY","scaleY","y",Oe)}return be}function L(Y,H,J,ee){var Q,X=H.target,ne=X._getTransformedDimensions(X.skewX,0),de=ve(H,H.originX,H.originY,J,ee),xe=Math.abs(2*de.y)-ne.y,we=X.skewY;xe<2?Q=0:(Q=_(Math.atan2(xe/X.scaleY,ne.x/X.scaleX)),H.originX===c&&H.originY===g&&(Q=-Q),H.originX===f&&H.originY===s&&(Q=-Q),Ce(X)&&(Q=-Q));var be=we!==Q;if(be){var Oe=X._getTransformedDimensions().x;X.set("skewY",Q),I(X,"skewX","scaleX","x",Oe)}return be}function O(Y,H,J,ee,X){var Q,be,Oe,Le,vt,qe,ne=H.target,de=ne.lockScalingX,xe=ne.lockScalingY,we=(X=X||{}).by,Je=M(Y,ne),We=j(ne,we,Je),pn=H.gestureScale;if(We)return!1;if(pn)be=H.scaleX*pn,Oe=H.scaleY*pn;else{if(Q=ve(H,H.originX,H.originY,J,ee),vt="y"!==we?b(Q.x):1,qe="x"!==we?b(Q.y):1,H.signX||(H.signX=vt),H.signY||(H.signY=qe),ne.lockScalingFlip&&(H.signX!==vt||H.signY!==qe))return!1;if(Le=ne._getTransformedDimensions(),Je&&!we){var ii=Math.abs(Q.x)+Math.abs(Q.y),$t=H.original,Oo=ii/(Math.abs(Le.x*$t.scaleX/ne.scaleX)+Math.abs(Le.y*$t.scaleY/ne.scaleY));be=$t.scaleX*Oo,Oe=$t.scaleY*Oo}else be=Math.abs(Q.x*ne.scaleX/Le.x),Oe=Math.abs(Q.y*ne.scaleY/Le.y);P(H)&&(be*=2,Oe*=2),H.signX!==vt&&"y"!==we&&(H.originX=v[H.originX],be*=-1,H.signX=vt),H.signY!==qe&&"x"!==we&&(H.originY=v[H.originY],Oe*=-1,H.signY=qe)}var Ma=ne.scaleX,Ia=ne.scaleY;return we?("x"===we&&ne.set("scaleX",be),"y"===we&&ne.set("scaleY",Oe)):(!de&&ne.set("scaleX",be),!xe&&ne.set("scaleY",Oe)),Ma!==ne.scaleX||Ia!==ne.scaleY}a.scaleCursorStyleHandler=function G(Y,H,J){var X=M(Y,J),ne="";if(0!==H.x&&0===H.y?ne="x":0===H.x&&0!==H.y&&(ne="y"),j(J,ne,X))return"not-allowed";var de=S(J,H);return p[de]+"-resize"},a.skewCursorStyleHandler=function re(Y,H,J){if(0!==H.x&&J.lockSkewingY||0!==H.y&&J.lockSkewingX)return"not-allowed";var X=S(J,H)%4;return d[X]+"-resize"},a.scaleSkewCursorStyleHandler=function le(Y,H,J){return Y[J.canvas.altActionKey]?a.skewCursorStyleHandler(Y,H,J):a.scaleCursorStyleHandler(Y,H,J)},a.rotationWithSnapping=_e("rotating",fe(function F(Y,H,J,ee){var X=H,ne=X.target,de=ne.translateToOriginPoint(ne.getCenterPoint(),X.originX,X.originY);if(ne.lockRotation)return!1;var be,xe=Math.atan2(X.ey-de.y,X.ex-de.x),we=Math.atan2(ee-de.y,J-de.x),Q=_(we-xe+X.theta);if(ne.snapAngle>0){var Oe=ne.snapAngle,Le=ne.snapThreshold||Oe,Je=Math.ceil(Q/Oe)*Oe,We=Math.floor(Q/Oe)*Oe;Math.abs(Q-We)<Le?Q=We:Math.abs(Q-Je)<Le&&(Q=Je)}return Q<0&&(Q=360+Q),be=ne.angle!==(Q%=360),ne.angle=Q,be})),a.scalingEqually=_e("scaling",fe(function B(Y,H,J,ee){return O(Y,H,J,ee)})),a.scalingX=_e("scaling",fe(function U(Y,H,J,ee){return O(Y,H,J,ee,{by:"x"})})),a.scalingY=_e("scaling",fe(function K(Y,H,J,ee){return O(Y,H,J,ee,{by:"y"})})),a.scalingYOrSkewingX=function W(Y,H,J,ee){return Y[H.target.canvas.altActionKey]?a.skewHandlerX(Y,H,J,ee):a.scalingY(Y,H,J,ee)},a.scalingXOrSkewingY=function te(Y,H,J,ee){return Y[H.target.canvas.altActionKey]?a.skewHandlerY(Y,H,J,ee):a.scalingX(Y,H,J,ee)},a.changeWidth=_e("resizing",fe(function oe(Y,H,J,ee){var X=H.target,ne=ve(H,H.originX,H.originY,J,ee),de=X.strokeWidth/(X.strokeUniform?X.scaleX:1),xe=P(H)?2:1,we=X.width,Q=Math.abs(ne.x*xe/X.scaleX)-de;return X.set("width",Math.max(Q,0)),we!==Q})),a.skewHandlerX=function R(Y,H,J,ee){var de,X=H.target,ne=X.skewX,xe=H.originY;return!X.lockSkewingX&&(0===ne?de=ve(H,l,l,J,ee).x>0?c:f:(ne>0&&(de=xe===s?c:f),ne<0&&(de=xe===s?f:c),Ce(X)&&(de=de===c?f:c)),H.originX=de,_e("skewing",fe(N))(Y,H,J,ee))},a.skewHandlerY=function $(Y,H,J,ee){var de,X=H.target,ne=X.skewY,xe=H.originX;return!X.lockSkewingY&&(0===ne?de=ve(H,l,l,J,ee).y>0?s:g:(ne>0&&(de=xe===c?s:g),ne<0&&(de=xe===c?g:s),Ce(X)&&(de=de===s?g:s)),H.originY=de,_e("skewing",fe(L))(Y,H,J,ee))},a.dragHandler=function he(Y,H,J,ee){var X=H.target,ne=J-H.offsetX,de=ee-H.offsetY,xe=!X.get("lockMovementX")&&X.left!==ne,we=!X.get("lockMovementY")&&X.top!==de;return xe&&X.set("left",ne),we&&X.set("top",de),(xe||we)&&T("moving",ce(Y,H,J,ee)),xe||we},a.scaleOrSkewActionName=function ge(Y,H,J){var ee=Y[J.canvas.altActionKey];return 0===H.x?ee?"skewX":"scaleY":0===H.y?ee?"skewY":"scaleX":void 0},a.rotationStyleHandler=function pe(Y,H,J){return J.lockRotation?"not-allowed":H.cursorStyle},a.fireEvent=T,a.wrapWithFixedAnchor=fe,a.wrapWithFireEvent=_e,a.getLocalPoint=ve,h.controlsUtils=a}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.degreesToRadians,d=h.controlsUtils;d.renderCircleControl=function a(s,f,g,l,v){l=l||{};var G,_=this.sizeX||l.cornerSize||v.cornerSize,b=this.sizeY||l.cornerSize||v.cornerSize,S=typeof l.transparentCorners<"u"?l.transparentCorners:v.transparentCorners,T=S?"stroke":"fill",M=!S&&(l.cornerStrokeColor||v.cornerStrokeColor),P=f,j=g;s.save(),s.fillStyle=l.cornerColor||v.cornerColor,s.strokeStyle=l.cornerStrokeColor||v.cornerStrokeColor,_>b?(G=_,s.scale(1,b/_),j=g*_/b):b>_?(G=b,s.scale(_/b,1),P=f*b/_):G=_,s.lineWidth=1,s.beginPath(),s.arc(P,j,G/2,0,2*Math.PI,!1),s[T](),M&&s.stroke(),s.restore()},d.renderSquareControl=function c(s,f,g,l,v){l=l||{};var _=this.sizeX||l.cornerSize||v.cornerSize,b=this.sizeY||l.cornerSize||v.cornerSize,S=typeof l.transparentCorners<"u"?l.transparentCorners:v.transparentCorners,T=S?"stroke":"fill",M=!S&&(l.cornerStrokeColor||v.cornerStrokeColor),P=_/2,j=b/2;s.save(),s.fillStyle=l.cornerColor||v.cornerColor,s.strokeStyle=l.cornerStrokeColor||v.cornerStrokeColor,s.lineWidth=1,s.translate(f,g),s.rotate(p(v.angle)),s[T+"Rect"](-P,-j,_,b),M&&s.strokeRect(-P,-j,_,b),s.restore()}}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={});h.Control=function p(d){for(var a in d)this[a]=d[a]},h.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(d,a){return a.cursorStyle},getActionName:function(d,a){return a.actionName},getVisibility:function(d,a){var c=d._controlsVisibility;return c&&typeof c[a]<"u"?c[a]:this.visible},setVisibility:function(d){this.visible=d},positionHandler:function(d,a){return h.util.transformPoint({x:this.x*d.x+this.offsetX,y:this.y*d.y+this.offsetY},a)},calcCornerCoords:function(d,a,c,s,f){var g,l,v,_,b=f?this.touchSizeX:this.sizeX,S=f?this.touchSizeY:this.sizeY;if(b&&S&&b!==S){var T=Math.atan2(S,b),M=Math.sqrt(b*b+S*S)/2,P=T-h.util.degreesToRadians(d),j=Math.PI/2-T-h.util.degreesToRadians(d);g=M*h.util.cos(P),l=M*h.util.sin(P),v=M*h.util.cos(j),_=M*h.util.sin(j)}else M=.7071067812*(b&&S?b:a),P=h.util.degreesToRadians(45-d),g=v=M*h.util.cos(P),l=_=M*h.util.sin(P);return{tl:{x:c-_,y:s-v},tr:{x:c+g,y:s-l},bl:{x:c-g,y:s+l},br:{x:c+_,y:s+v}}},render:function(d,a,c,s,f){"circle"===((s=s||{}).cornerStyle||f.cornerStyle)?h.controlsUtils.renderCircleControl.call(this,d,a,c,s,f):h.controlsUtils.renderSquareControl.call(this,d,a,c,s,f)}}}(Ie),function(){function y(c,s){var l,v,_,b,f=c.getAttribute("style"),g=c.getAttribute("offset")||0;if(g=(g=parseFloat(g)/(/%$/.test(g)?100:1))<0?0:g>1?1:g,f){var S=f.split(/\s*;\s*/);for(""===S[S.length-1]&&S.pop(),b=S.length;b--;){var T=S[b].split(/\s*:\s*/),M=T[0].trim(),P=T[1].trim();"stop-color"===M?l=P:"stop-opacity"===M&&(_=P)}}return l||(l=c.getAttribute("stop-color")||"rgb(0,0,0)"),_||(_=c.getAttribute("stop-opacity")),v=(l=new w.Color(l)).getAlpha(),_=isNaN(parseFloat(_))?1:parseFloat(_),_*=v*s,{offset:g,color:l.toRgb(),opacity:_}}var d=w.util.object.clone;w.Gradient=w.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(c){c||(c={}),c.coords||(c.coords={});var s,f=this;Object.keys(c).forEach(function(g){f[g]=c[g]}),this.id?this.id+="_"+w.Object.__uid++:this.id=w.Object.__uid++,s={x1:c.coords.x1||0,y1:c.coords.y1||0,x2:c.coords.x2||0,y2:c.coords.y2||0},"radial"===this.type&&(s.r1=c.coords.r1||0,s.r2=c.coords.r2||0),this.coords=s,this.colorStops=c.colorStops.slice()},addColorStop:function(c){for(var s in c){var f=new w.Color(c[s]);this.colorStops.push({offset:parseFloat(s),color:f.toRgb(),opacity:f.getAlpha()})}return this},toObject:function(c){var s={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return w.util.populateWithProperties(this,s,c),s},toSVG:function(c,v){var g,l,_,b,f=d(this.coords,!0),S=(v=v||{},d(this.colorStops,!0)),T=f.r1>f.r2,M=this.gradientTransform?this.gradientTransform.concat():w.iMatrix.concat(),P=-this.offsetX,j=-this.offsetY,G=!!v.additionalTransform,re="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(S.sort(function(fe,_e){return fe.offset-_e.offset}),"objectBoundingBox"===re?(P/=c.width,j/=c.height):(P+=c.width/2,j+=c.height/2),"path"===c.type&&"percentage"!==this.gradientUnits&&(P-=c.pathOffset.x,j-=c.pathOffset.y),M[4]-=P,M[5]-=j,b='id="SVGID_'+this.id+'" gradientUnits="'+re+'"',b+=' gradientTransform="'+(G?v.additionalTransform+" ":"")+w.util.matrixToSVG(M)+'" ',"linear"===this.type?_=["<linearGradient ",b,' x1="',f.x1,'" y1="',f.y1,'" x2="',f.x2,'" y2="',f.y2,'">\n']:"radial"===this.type&&(_=["<radialGradient ",b,' cx="',T?f.x1:f.x2,'" cy="',T?f.y1:f.y2,'" r="',T?f.r1:f.r2,'" fx="',T?f.x2:f.x1,'" fy="',T?f.y2:f.y1,'">\n']),"radial"===this.type){if(T)for((S=S.concat()).reverse(),g=0,l=S.length;g<l;g++)S[g].offset=1-S[g].offset;var le=Math.min(f.r1,f.r2);if(le>0){var pe=le/Math.max(f.r1,f.r2);for(g=0,l=S.length;g<l;g++)S[g].offset+=pe*(1-S[g].offset)}}for(g=0,l=S.length;g<l;g++){var ce=S[g];_.push("<stop ",'offset="',100*ce.offset+"%",'" style="stop-color:',ce.color,typeof ce.opacity<"u"?";stop-opacity: "+ce.opacity:";",'"/>\n')}return _.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),_.join("")},toLive:function(c){var s,g,l,f=w.util.object.clone(this.coords);if(this.type){for("linear"===this.type?s=c.createLinearGradient(f.x1,f.y1,f.x2,f.y2):"radial"===this.type&&(s=c.createRadialGradient(f.x1,f.y1,f.r1,f.x2,f.y2,f.r2)),g=0,l=this.colorStops.length;g<l;g++){var v=this.colorStops[g].color,_=this.colorStops[g].opacity,b=this.colorStops[g].offset;typeof _<"u"&&(v=new w.Color(v).setAlpha(_).toRgba()),s.addColorStop(b,v)}return s}}}),w.util.object.extend(w.Gradient,{fromElement:function(c,s,f,g){var l=parseFloat(f)/(/%$/.test(f)?100:1);l=l<0?0:l>1?1:l,isNaN(l)&&(l=1);var _,M,P,re,v=c.getElementsByTagName("stop"),b="userSpaceOnUse"===c.getAttribute("gradientUnits")?"pixels":"percentage",S=c.getAttribute("gradientTransform")||"",T=[],j=0,G=0;for("linearGradient"===c.nodeName||"LINEARGRADIENT"===c.nodeName?(_="linear",M=function h(c){return{x1:c.getAttribute("x1")||0,y1:c.getAttribute("y1")||0,x2:c.getAttribute("x2")||"100%",y2:c.getAttribute("y2")||0}}(c)):(_="radial",M=function p(c){return{x1:c.getAttribute("fx")||c.getAttribute("cx")||"50%",y1:c.getAttribute("fy")||c.getAttribute("cy")||"50%",r1:0,x2:c.getAttribute("cx")||"50%",y2:c.getAttribute("cy")||"50%",r2:c.getAttribute("r")||"50%"}}(c)),P=v.length;P--;)T.push(y(v[P],l));return re=w.parseTransformAttribute(S),function a(c,s,f,g){var l,v;Object.keys(s).forEach(function(_){"Infinity"===(l=s[_])?v=1:"-Infinity"===l?v=0:(v=parseFloat(s[_],10),"string"==typeof l&&/^(\d+\.\d+)%|(\d+)%$/.test(l)&&(v*=.01,"pixels"===g&&(("x1"===_||"x2"===_||"r2"===_)&&(v*=f.viewBoxWidth||f.width),("y1"===_||"y2"===_)&&(v*=f.viewBoxHeight||f.height)))),s[_]=v})}(0,M,g,b),"pixels"===b&&(j=-s.left,G=-s.top),new w.Gradient({id:c.getAttribute("id"),type:_,coords:M,colorStops:T,gradientUnits:b,gradientTransform:re,offsetX:j,offsetY:G})}})}(),function(){"use strict";var y=w.util.toFixed;w.Pattern=w.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(h,p){if(h||(h={}),this.id=w.Object.__uid++,this.setOptions(h),!h.source||h.source&&"string"!=typeof h.source)p&&p(this);else{var d=this;this.source=w.util.createImage(),w.util.loadImage(h.source,function(a,c){d.source=a,p&&p(d,c)},null,this.crossOrigin)}},toObject:function(h){var d,a,p=w.Object.NUM_FRACTION_DIGITS;return"string"==typeof this.source.src?d=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(d=this.source.toDataURL()),a={type:"pattern",source:d,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:y(this.offsetX,p),offsetY:y(this.offsetY,p),patternTransform:this.patternTransform?this.patternTransform.concat():null},w.util.populateWithProperties(this,a,h),a},toSVG:function(h){var p="function"==typeof this.source?this.source():this.source,d=p.width/h.width,a=p.height/h.height,c=this.offsetX/h.width,s=this.offsetY/h.height,f="";return("repeat-x"===this.repeat||"no-repeat"===this.repeat)&&(a=1,s&&(a+=Math.abs(s))),("repeat-y"===this.repeat||"no-repeat"===this.repeat)&&(d=1,c&&(d+=Math.abs(c))),p.src?f=p.src:p.toDataURL&&(f=p.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+c+'" y="'+s+'" width="'+d+'" height="'+a+'">\n<image x="0" y="0" width="'+p.width+'" height="'+p.height+'" xlink:href="'+f+'"></image>\n</pattern>\n'},setOptions:function(h){for(var p in h)this[p]=h[p]},toLive:function(h){var p=this.source;return!p||typeof p.src<"u"&&(!p.complete||0===p.naturalWidth||0===p.naturalHeight)?"":h.createPattern(p,this.repeat)}})}(),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.toFixed;h.Shadow?h.warn("fabric.Shadow is already defined."):(h.Shadow=h.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(d){for(var a in"string"==typeof d&&(d=this._parseShadow(d)),d)this[a]=d[a];this.id=h.Object.__uid++},_parseShadow:function(d){var a=d.trim(),c=h.Shadow.reOffsetsAndBlur.exec(a)||[];return{color:(a.replace(h.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(c[1],10)||0,offsetY:parseFloat(c[2],10)||0,blur:parseFloat(c[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(d){var a=40,c=40,s=h.Object.NUM_FRACTION_DIGITS,f=h.util.rotateVector({x:this.offsetX,y:this.offsetY},h.util.degreesToRadians(-d.angle)),l=new h.Color(this.color);return d.width&&d.height&&(a=100*p((Math.abs(f.x)+this.blur)/d.width,s)+20,c=100*p((Math.abs(f.y)+this.blur)/d.height,s)+20),d.flipX&&(f.x*=-1),d.flipY&&(f.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+c+'%" height="'+(100+2*c)+'%" x="-'+a+'%" width="'+(100+2*a)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+p(this.blur?this.blur/2:0,s)+'"></feGaussianBlur>\n\t<feOffset dx="'+p(f.x,s)+'" dy="'+p(f.y,s)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+l.toRgb()+'" flood-opacity="'+l.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var d={},a=h.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(c){this[c]!==a[c]&&(d[c]=this[c])},this),d}}),h.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(Ie),function(){"use strict";if(w.StaticCanvas)w.warn("fabric.StaticCanvas is already defined.");else{var y=w.util.object.extend,h=w.util.getElementOffset,p=w.util.removeFromArray,d=w.util.toFixed,a=w.util.transformPoint,c=w.util.invertTransform,s=w.util.getNodeCanvas,f=w.util.createCanvasElement,g=new Error("Could not initialize `canvas` element");w.StaticCanvas=w.util.createClass(w.CommonMethods,{initialize:function(l,v){v||(v={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(l,v)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:w.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(l,v){var _=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(l),this._initOptions(v),this.interactive||this._initRetinaScaling(),v.overlayImage&&this.setOverlayImage(v.overlayImage,_),v.backgroundImage&&this.setBackgroundImage(v.backgroundImage,_),v.backgroundColor&&this.setBackgroundColor(v.backgroundColor,_),v.overlayColor&&this.setOverlayColor(v.overlayColor,_),this.calcOffset()},_isRetinaScaling:function(){return w.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,w.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var l=w.devicePixelRatio;this.__initRetinaScaling(l,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(l,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(l,v,_){v.setAttribute("width",this.width*l),v.setAttribute("height",this.height*l),_.scale(l,l)},calcOffset:function(){return this._offset=h(this.lowerCanvasEl),this},setOverlayImage:function(l,v,_){return this.__setBgOverlayImage("overlayImage",l,v,_)},setBackgroundImage:function(l,v,_){return this.__setBgOverlayImage("backgroundImage",l,v,_)},setOverlayColor:function(l,v){return this.__setBgOverlayColor("overlayColor",l,v)},setBackgroundColor:function(l,v){return this.__setBgOverlayColor("backgroundColor",l,v)},__setBgOverlayImage:function(l,v,_,b){return"string"==typeof v?w.util.loadImage(v,function(S,T){if(S){var M=new w.Image(S,b);this[l]=M,M.canvas=this}_&&_(S,T)},this,b&&b.crossOrigin):(b&&v.setOptions(b),this[l]=v,v&&(v.canvas=this),_&&_(v,!1)),this},__setBgOverlayColor:function(l,v,_){return this[l]=v,this._initGradient(v,l),this._initPattern(v,l,_),this},_createCanvasElement:function(){var l=f();if(!l||(l.style||(l.style={}),typeof l.getContext>"u"))throw g;return l},_initOptions:function(l){var v=this.lowerCanvasEl;this._setOptions(l),this.width=this.width||parseInt(v.width,10)||0,this.height=this.height||parseInt(v.height,10)||0,this.lowerCanvasEl.style&&(v.width=this.width,v.height=this.height,v.style.width=this.width+"px",v.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(l){this.lowerCanvasEl=l&&l.getContext?l:w.util.getById(l)||this._createCanvasElement(),w.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(l,v){return this.setDimensions({width:l},v)},setHeight:function(l,v){return this.setDimensions({height:l},v)},setDimensions:function(l,v){var _;for(var b in v=v||{},l)_=l[b],v.cssOnly||(this._setBackstoreDimension(b,l[b]),_+="px",this.hasLostContext=!0),v.backstoreOnly||this._setCssDimension(b,_);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),v.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(l,v){return this.lowerCanvasEl[l]=v,this.upperCanvasEl&&(this.upperCanvasEl[l]=v),this.cacheCanvasEl&&(this.cacheCanvasEl[l]=v),this[l]=v,this},_setCssDimension:function(l,v){return this.lowerCanvasEl.style[l]=v,this.upperCanvasEl&&(this.upperCanvasEl.style[l]=v),this.wrapperEl&&(this.wrapperEl.style[l]=v),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(l){var S,T,M,v=this._activeObject,_=this.backgroundImage,b=this.overlayImage;for(this.viewportTransform=l,T=0,M=this._objects.length;T<M;T++)(S=this._objects[T]).group||S.setCoords(!0);return v&&v.setCoords(),_&&_.setCoords(!0),b&&b.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(l,v){var _=l,b=this.viewportTransform.slice(0);l=a(l,c(this.viewportTransform)),b[0]=v,b[3]=v;var S=a(l,b);return b[4]+=_.x-S.x,b[5]+=_.y-S.y,this.setViewportTransform(b)},setZoom:function(l){return this.zoomToPoint(new w.Point(0,0),l),this},absolutePan:function(l){var v=this.viewportTransform.slice(0);return v[4]=-l.x,v[5]=-l.y,this.setViewportTransform(v)},relativePan:function(l){return this.absolutePan(new w.Point(-l.x-this.viewportTransform[4],-l.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(l){this.stateful&&l.setupState(),l._set("canvas",this),l.setCoords(),this.fire("object:added",{target:l}),l.fire("added")},_onObjectRemoved:function(l){this.fire("object:removed",{target:l}),l.fire("removed"),delete l.canvas},clearContext:function(l){return l.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){return this.renderCanvas(this.contextContainer,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=w.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var l={},v=this.width,_=this.height,b=c(this.viewportTransform);return l.tl=a({x:0,y:0},b),l.br=a({x:v,y:_},b),l.tr=new w.Point(l.br.x,l.tl.y),l.bl=new w.Point(l.tl.x,l.br.y),this.vptCoords=l,l},cancelRequestedRender:function(){this.isRendering&&(w.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(l,v){var _=this.viewportTransform,b=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(l),w.util.setImageSmoothing(l,this.imageSmoothingEnabled),this.fire("before:render",{ctx:l}),this._renderBackground(l),l.save(),l.transform(_[0],_[1],_[2],_[3],_[4],_[5]),this._renderObjects(l,v),l.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(l),b&&(b.canvas=this,b.shouldCache(),b._transformDone=!0,b.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(l)),this._renderOverlay(l),this.controlsAboveOverlay&&this.interactive&&this.drawControls(l),this.fire("after:render",{ctx:l})},drawClipPathOnCanvas:function(l){var v=this.viewportTransform,_=this.clipPath;l.save(),l.transform(v[0],v[1],v[2],v[3],v[4],v[5]),l.globalCompositeOperation="destination-in",_.transform(l),l.scale(1/_.zoomX,1/_.zoomY),l.drawImage(_._cacheCanvas,-_.cacheTranslationX,-_.cacheTranslationY),l.restore()},_renderObjects:function(l,v){var _,b;for(_=0,b=v.length;_<b;++_)v[_]&&v[_].render(l)},_renderBackgroundOrOverlay:function(l,v){var _=this[v+"Color"],b=this[v+"Image"],S=this.viewportTransform,T=this[v+"Vpt"];if(_||b){if(_){l.save(),l.beginPath(),l.moveTo(0,0),l.lineTo(this.width,0),l.lineTo(this.width,this.height),l.lineTo(0,this.height),l.closePath(),l.fillStyle=_.toLive?_.toLive(l,this):_,T&&l.transform(S[0],S[1],S[2],S[3],S[4],S[5]),l.transform(1,0,0,1,_.offsetX||0,_.offsetY||0);var M=_.gradientTransform||_.patternTransform;M&&l.transform(M[0],M[1],M[2],M[3],M[4],M[5]),l.fill(),l.restore()}b&&(l.save(),T&&l.transform(S[0],S[1],S[2],S[3],S[4],S[5]),b.render(l),l.restore())}},_renderBackground:function(l){this._renderBackgroundOrOverlay(l,"background")},_renderOverlay:function(l){this._renderBackgroundOrOverlay(l,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new w.Point(this.width/2,this.height/2)},centerObjectH:function(l){return this._centerObject(l,new w.Point(this.getCenterPoint().x,l.getCenterPoint().y))},centerObjectV:function(l){return this._centerObject(l,new w.Point(l.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(l){var v=this.getCenterPoint();return this._centerObject(l,v)},viewportCenterObject:function(l){var v=this.getVpCenter();return this._centerObject(l,v)},viewportCenterObjectH:function(l){var v=this.getVpCenter();return this._centerObject(l,new w.Point(v.x,l.getCenterPoint().y)),this},viewportCenterObjectV:function(l){var v=this.getVpCenter();return this._centerObject(l,new w.Point(l.getCenterPoint().x,v.y))},getVpCenter:function(){var l=this.getCenterPoint(),v=c(this.viewportTransform);return a(l,v)},_centerObject:function(l,v){return l.setPositionByOrigin(v,"center","center"),l.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(l){return this.toDatalessObject(l)},toObject:function(l){return this._toObjectMethod("toObject",l)},toDatalessObject:function(l){return this._toObjectMethod("toDatalessObject",l)},_toObjectMethod:function(l,v){var _=this.clipPath,b={version:w.version,objects:this._toObjects(l,v)};return _&&!_.excludeFromExport&&(b.clipPath=this._toObject(this.clipPath,l,v)),y(b,this.__serializeBgOverlay(l,v)),w.util.populateWithProperties(this,b,v),b},_toObjects:function(l,v){return this._objects.filter(function(_){return!_.excludeFromExport}).map(function(_){return this._toObject(_,l,v)},this)},_toObject:function(l,v,_){var b;this.includeDefaultValues||(b=l.includeDefaultValues,l.includeDefaultValues=!1);var S=l[v](_);return this.includeDefaultValues||(l.includeDefaultValues=b),S},__serializeBgOverlay:function(l,v){var _={},b=this.backgroundImage,S=this.overlayImage,T=this.backgroundColor,M=this.overlayColor;return T&&T.toObject?T.excludeFromExport||(_.background=T.toObject(v)):T&&(_.background=T),M&&M.toObject?M.excludeFromExport||(_.overlay=M.toObject(v)):M&&(_.overlay=M),b&&!b.excludeFromExport&&(_.backgroundImage=this._toObject(b,l,v)),S&&!S.excludeFromExport&&(_.overlayImage=this._toObject(S,l,v)),_},svgViewportTransformation:!0,toSVG:function(l,v){l||(l={}),l.reviver=v;var _=[];return this._setSVGPreamble(_,l),this._setSVGHeader(_,l),this.clipPath&&_.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(_,"background"),this._setSVGBgOverlayImage(_,"backgroundImage",v),this._setSVGObjects(_,v),this.clipPath&&_.push("</g>\n"),this._setSVGBgOverlayColor(_,"overlay"),this._setSVGBgOverlayImage(_,"overlayImage",v),_.push("</svg>"),_.join("")},_setSVGPreamble:function(l,v){v.suppressPreamble||l.push('<?xml version="1.0" encoding="',v.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(l,v){var S,_=v.width||this.width,b=v.height||this.height,T='viewBox="0 0 '+this.width+" "+this.height+'" ',M=w.Object.NUM_FRACTION_DIGITS;v.viewBox?T='viewBox="'+v.viewBox.x+" "+v.viewBox.y+" "+v.viewBox.width+" "+v.viewBox.height+'" ':this.svgViewportTransformation&&(T='viewBox="'+d(-(S=this.viewportTransform)[4]/S[0],M)+" "+d(-S[5]/S[3],M)+" "+d(this.width/S[0],M)+" "+d(this.height/S[3],M)+'" '),l.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',_,'" ','height="',b,'" ',T,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",w.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(v),"</defs>\n")},createSVGClipPathMarkup:function(l){var v=this.clipPath;return v?(v.clipPathId="CLIPPATH_"+w.Object.__uid++,'<clipPath id="'+v.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(l.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var l=this;return["background","overlay"].map(function(_){var b=l[_+"Color"];if(b&&b.toLive){var S=l[_+"Vpt"],T=l.viewportTransform;return b.toSVG({width:l.width/(S?T[0]:1),height:l.height/(S?T[3]:1)},{additionalTransform:S?w.util.matrixToSVG(T):""})}}).join("")},createSVGFontFacesMarkup:function(){var _,b,S,T,M,j,G,re,l="",v={},le=w.fontPaths,ge=[];for(this._objects.forEach(function ce(fe){ge.push(fe),fe._objects&&fe._objects.forEach(ce)}),G=0,re=ge.length;G<re;G++)if(b=(_=ge[G]).fontFamily,-1!==_.type.indexOf("text")&&!v[b]&&le[b]&&(v[b]=!0,_.styles))for(M in S=_.styles)for(j in T=S[M])!v[b=T[j].fontFamily]&&le[b]&&(v[b]=!0);for(var pe in v)l+=["\t\t@font-face {\n","\t\t\tfont-family: '",pe,"';\n","\t\t\tsrc: url('",le[pe],"');\n","\t\t}\n"].join("");return l&&(l=['\t<style type="text/css">',"<![CDATA[\n",l,"]]>","</style>\n"].join("")),l},_setSVGObjects:function(l,v){var _,b,S,T=this._objects;for(b=0,S=T.length;b<S;b++)!(_=T[b]).excludeFromExport&&this._setSVGObject(l,_,v)},_setSVGObject:function(l,v,_){l.push(v.toSVG(_))},_setSVGBgOverlayImage:function(l,v,_){this[v]&&!this[v].excludeFromExport&&this[v].toSVG&&l.push(this[v].toSVG(_))},_setSVGBgOverlayColor:function(l,v){var _=this[v+"Color"],S=this.width,T=this.height;if(_)if(_.toLive){var M=_.repeat,P=w.util.invertTransform(this.viewportTransform),G=this[v+"Vpt"]?w.util.matrixToSVG(P):"";l.push('<rect transform="'+G+" translate(",S/2,",",T/2,')"',' x="',_.offsetX-S/2,'" y="',_.offsetY-T/2,'" ','width="',"repeat-y"===M||"no-repeat"===M?_.source.width:S,'" height="',"repeat-x"===M||"no-repeat"===M?_.source.height:T,'" fill="url(#SVGID_'+_.id+')"',"></rect>\n")}else l.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',_,'"',"></rect>\n")},sendToBack:function(l){if(!l)return this;var _,b,S,v=this._activeObject;if(l===v&&"activeSelection"===l.type)for(_=(S=v._objects).length;_--;)p(this._objects,b=S[_]),this._objects.unshift(b);else p(this._objects,l),this._objects.unshift(l);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(l){if(!l)return this;var _,b,S,v=this._activeObject;if(l===v&&"activeSelection"===l.type)for(S=v._objects,_=0;_<S.length;_++)p(this._objects,b=S[_]),this._objects.push(b);else p(this._objects,l),this._objects.push(l);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(l,v){if(!l)return this;var b,S,T,M,P,_=this._activeObject,j=0;if(l===_&&"activeSelection"===l.type)for(P=_._objects,b=0;b<P.length;b++)(T=this._objects.indexOf(S=P[b]))>0+j&&(M=T-1,p(this._objects,S),this._objects.splice(M,0,S)),j++;else 0!==(T=this._objects.indexOf(l))&&(M=this._findNewLowerIndex(l,T,v),p(this._objects,l),this._objects.splice(M,0,l));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(l,v,_){var b,S;if(_){for(b=v,S=v-1;S>=0;--S)if(l.intersectsWithObject(this._objects[S])||l.isContainedWithinObject(this._objects[S])||this._objects[S].isContainedWithinObject(l)){b=S;break}}else b=v-1;return b},bringForward:function(l,v){if(!l)return this;var b,S,T,M,P,_=this._activeObject,j=0;if(l===_&&"activeSelection"===l.type)for(b=(P=_._objects).length;b--;)(T=this._objects.indexOf(S=P[b]))<this._objects.length-1-j&&(M=T+1,p(this._objects,S),this._objects.splice(M,0,S)),j++;else(T=this._objects.indexOf(l))!==this._objects.length-1&&(M=this._findNewUpperIndex(l,T,v),p(this._objects,l),this._objects.splice(M,0,l));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(l,v,_){var b,S,T;if(_){for(b=v,S=v+1,T=this._objects.length;S<T;++S)if(l.intersectsWithObject(this._objects[S])||l.isContainedWithinObject(this._objects[S])||this._objects[S].isContainedWithinObject(l)){b=S;break}}else b=v+1;return b},moveTo:function(l,v){return p(this._objects,l),this._objects.splice(v,0,l),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(w.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(l){l.dispose&&l.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),w.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),w.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),y(w.StaticCanvas.prototype,w.Observable),y(w.StaticCanvas.prototype,w.Collection),y(w.StaticCanvas.prototype,w.DataURLExporter),y(w.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(l){var v=f();if(!v||!v.getContext)return null;var _=v.getContext("2d");return _&&"setLineDash"===l?typeof _.setLineDash<"u":null}}),w.StaticCanvas.prototype.toJSON=w.StaticCanvas.prototype.toObject,w.isLikelyNode&&(w.StaticCanvas.prototype.createPNGStream=function(){var l=s(this.lowerCanvasEl);return l&&l.createPNGStream()},w.StaticCanvas.prototype.createJPEGStream=function(l){var v=s(this.lowerCanvasEl);return v&&v.createJPEGStream(l)})}}(),w.BaseBrush=w.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(y){y.strokeStyle=this.color,y.lineWidth=this.width,y.lineCap=this.strokeLineCap,y.miterLimit=this.strokeMiterLimit,y.lineJoin=this.strokeLineJoin,y.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(y){var h=this.canvas.viewportTransform;y.save(),y.transform(h[0],h[1],h[2],h[3],h[4],h[5])},_setShadow:function(){if(this.shadow){var y=this.canvas,h=this.shadow,p=y.contextTop,d=y.getZoom();y&&y._isRetinaScaling()&&(d*=w.devicePixelRatio),p.shadowColor=h.color,p.shadowBlur=h.blur*d,p.shadowOffsetX=h.offsetX*d,p.shadowOffsetY=h.offsetY*d}},needsFullRender:function(){return new w.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var y=this.canvas.contextTop;y.shadowColor="",y.shadowBlur=y.shadowOffsetX=y.shadowOffsetY=0},_isOutSideCanvas:function(y){return y.x<0||y.x>this.canvas.getWidth()||y.y<0||y.y>this.canvas.getHeight()}}),w.PencilBrush=w.util.createClass(w.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(y){this.canvas=y,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(y,h,p){var d=h.midPointFrom(p);return y.quadraticCurveTo(h.x,h.y,d.x,d.y),d},onMouseDown:function(y,h){this.canvas._isMainEvent(h.e)&&(this.drawStraightLine=h.e[this.straightLineKey],this._prepareForDrawing(y),this._captureDrawingPath(y),this._render())},onMouseMove:function(y,h){if(this.canvas._isMainEvent(h.e)&&(this.drawStraightLine=h.e[this.straightLineKey],(!0!==this.limitedToCanvasSize||!this._isOutSideCanvas(y))&&this._captureDrawingPath(y)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var p=this._points,d=p.length,a=this.canvas.contextTop;this._saveAndTransform(a),this.oldEnd&&(a.beginPath(),a.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(a,p[d-2],p[d-1],!0),a.stroke(),a.restore()}},onMouseUp:function(y){return!this.canvas._isMainEvent(y.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(y){var h=new w.Point(y.x,y.y);this._reset(),this._addPoint(h),this.canvas.contextTop.moveTo(h.x,h.y)},_addPoint:function(y){return!(this._points.length>1&&y.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(y),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(y){var h=new w.Point(y.x,y.y);return this._addPoint(h)},_render:function(y){var h,p,d=this._points[0],a=this._points[1];if(this._saveAndTransform(y=y||this.canvas.contextTop),y.beginPath(),2===this._points.length&&d.x===a.x&&d.y===a.y){var c=this.width/1e3;d=new w.Point(d.x,d.y),a=new w.Point(a.x,a.y),d.x-=c,a.x+=c}for(y.moveTo(d.x,d.y),h=1,p=this._points.length;h<p;h++)this._drawSegment(y,d,a),d=this._points[h],a=this._points[h+1];y.lineTo(d.x,d.y),y.stroke(),y.restore()},convertPointsToSVGPath:function(y){return w.util.getSmoothPathFromPoints(y,this.width/1e3)},_isEmptySVGPath:function(y){return"M 0 0 Q 0 0 0 0 L 0 0"===w.util.joinPath(y)},createPath:function(y){var h=new w.Path(y,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,h.shadow=new w.Shadow(this.shadow)),h},decimatePoints:function(y,h){if(y.length<=2)return y;var a,p=this.canvas.getZoom(),d=Math.pow(h/p,2),c=y.length-1,s=y[0],f=[s];for(a=1;a<c-1;a++)Math.pow(s.x-y[a].x,2)+Math.pow(s.y-y[a].y,2)>=d&&f.push(s=y[a]);return f.push(y[c]),f},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var h=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(h))this.canvas.requestRenderAll();else{var p=this.createPath(h);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:p}),this.canvas.add(p),this.canvas.requestRenderAll(),p.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:p})}}}),w.CircleBrush=w.util.createClass(w.BaseBrush,{width:10,initialize:function(y){this.canvas=y,this.points=[]},drawDot:function(y){var h=this.addPoint(y),p=this.canvas.contextTop;this._saveAndTransform(p),this.dot(p,h),p.restore()},dot:function(y,h){y.fillStyle=h.fill,y.beginPath(),y.arc(h.x,h.y,h.radius,0,2*Math.PI,!1),y.closePath(),y.fill()},onMouseDown:function(y){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(y)},_render:function(){var h,p,y=this.canvas.contextTop,d=this.points;for(this._saveAndTransform(y),h=0,p=d.length;h<p;h++)this.dot(y,d[h]);y.restore()},onMouseMove:function(y){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(y)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(y),this._render()):this.drawDot(y))},onMouseUp:function(){var h,p,y=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var d=[];for(h=0,p=this.points.length;h<p;h++){var a=this.points[h],c=new w.Circle({radius:a.radius,left:a.x,top:a.y,originX:"center",originY:"center",fill:a.fill});this.shadow&&(c.shadow=new w.Shadow(this.shadow)),d.push(c)}var s=new w.Group(d);s.canvas=this.canvas,this.canvas.fire("before:path:created",{path:s}),this.canvas.add(s),this.canvas.fire("path:created",{path:s}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=y,this.canvas.requestRenderAll()},addPoint:function(y){var h=new w.Point(y.x,y.y),p=w.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=new w.Color(this.color).setAlpha(w.util.getRandomInt(0,100)/100).toRgba();return h.radius=p,h.fill=d,this.points.push(h),h}}),w.SprayBrush=w.util.createClass(w.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(y){this.canvas=y,this.sprayChunks=[]},onMouseDown:function(y){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(y),this.render(this.sprayChunkPoints)},onMouseMove:function(y){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(y)||(this.addSprayChunk(y),this.render(this.sprayChunkPoints))},onMouseUp:function(){var y=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var h=[],p=0,d=this.sprayChunks.length;p<d;p++)for(var a=this.sprayChunks[p],c=0,s=a.length;c<s;c++){var f=new w.Rect({width:a[c].width,height:a[c].width,left:a[c].x+1,top:a[c].y+1,originX:"center",originY:"center",fill:this.color});h.push(f)}this.optimizeOverlapping&&(h=this._getOptimizedRects(h));var g=new w.Group(h);this.shadow&&g.set("shadow",new w.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:g}),this.canvas.add(g),this.canvas.fire("path:created",{path:g}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=y,this.canvas.requestRenderAll()},_getOptimizedRects:function(y){var p,d,a,h={};for(d=0,a=y.length;d<a;d++)h[p=y[d].left+""+y[d].top]||(h[p]=y[d]);var c=[];for(p in h)c.push(h[p]);return c},render:function(y){var p,d,h=this.canvas.contextTop;for(h.fillStyle=this.color,this._saveAndTransform(h),p=0,d=y.length;p<d;p++){var a=y[p];typeof a.opacity<"u"&&(h.globalAlpha=a.opacity),h.fillRect(a.x,a.y,a.width,a.width)}h.restore()},_render:function(){var h,p,y=this.canvas.contextTop;for(y.fillStyle=this.color,this._saveAndTransform(y),h=0,p=this.sprayChunks.length;h<p;h++)this.render(this.sprayChunks[h]);y.restore()},addSprayChunk:function(y){this.sprayChunkPoints=[];var h,p,d,c,a=this.width/2;for(c=0;c<this.density;c++){h=w.util.getRandomInt(y.x-a,y.x+a),p=w.util.getRandomInt(y.y-a,y.y+a),d=this.dotWidthVariance?w.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var s=new w.Point(h,p);s.width=d,this.randomOpacity&&(s.opacity=w.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(s)}this.sprayChunks.push(this.sprayChunkPoints)}}),w.PatternBrush=w.util.createClass(w.PencilBrush,{getPatternSrc:function(){var p=w.util.createCanvasElement(),d=p.getContext("2d");return p.width=p.height=25,d.fillStyle=this.color,d.beginPath(),d.arc(10,10,10,0,2*Math.PI,!1),d.closePath(),d.fill(),p},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(y){return y.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(y){this.callSuper("_setBrushStyles",y),y.strokeStyle=this.getPattern(y)},createPath:function(y){var h=this.callSuper("createPath",y),p=h._getLeftTopCoords().scalarAdd(h.strokeWidth/2);return h.stroke=new w.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-p.x,offsetY:-p.y}),h}}),function(){var y=w.util.getPointer,h=w.util.degreesToRadians,p=w.util.isTouchEvent;for(var d in w.Canvas=w.util.createClass(w.StaticCanvas,{initialize:function(a,c){c||(c={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(a,c),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=w.PencilBrush&&new w.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var c,s,f,a=this.getActiveObjects();if(a.length>0&&!this.preserveObjectStacking){s=[],f=[];for(var g=0,l=this._objects.length;g<l;g++)-1===a.indexOf(c=this._objects[g])?s.push(c):f.push(c);a.length>1&&(this._activeObject._objects=f),s.push.apply(s,f)}else s=this._objects;return s},renderAll:function(){return this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),this.renderCanvas(this.contextContainer,this._chooseObjectsToRender()),this},renderTopLayer:function(a){a.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(a),this.contextTopDirty=!0),a.restore()},renderTop:function(){var a=this.contextTop;return this.clearContext(a),this.renderTopLayer(a),this.fire("after:render"),this},_normalizePointer:function(a,c){var s=a.calcTransformMatrix(),f=w.util.invertTransform(s),g=this.restorePointerVpt(c);return w.util.transformPoint(g,f)},isTargetTransparent:function(a,c,s){if(a.shouldCache()&&a._cacheCanvas&&a!==this._activeObject){var f=this._normalizePointer(a,{x:c,y:s}),g=Math.max(a.cacheTranslationX+f.x*a.zoomX,0),l=Math.max(a.cacheTranslationY+f.y*a.zoomY,0);return w.util.isTransparent(a._cacheContext,Math.round(g),Math.round(l),this.targetFindTolerance)}var v=this.contextCache,_=a.selectionBackgroundColor,b=this.viewportTransform;return a.selectionBackgroundColor="",this.clearContext(v),v.save(),v.transform(b[0],b[1],b[2],b[3],b[4],b[5]),a.render(v),v.restore(),a.selectionBackgroundColor=_,w.util.isTransparent(v,c,s,this.targetFindTolerance)},_isSelectionKeyPressed:function(a){return Array.isArray(this.selectionKey)?!!this.selectionKey.find(function(s){return!0===a[s]}):a[this.selectionKey]},_shouldClearSelection:function(a,c){var s=this.getActiveObjects(),f=this._activeObject;return!c||c&&f&&s.length>1&&-1===s.indexOf(c)&&f!==c&&!this._isSelectionKeyPressed(a)||c&&!c.evented||c&&!c.selectable&&f&&f!==c},_shouldCenterTransform:function(a,c,s){var f;if(a)return"scale"===c||"scaleX"===c||"scaleY"===c||"resizing"===c?f=this.centeredScaling||a.centeredScaling:"rotate"===c&&(f=this.centeredRotation||a.centeredRotation),f?!s:s},_getOriginFromCorner:function(a,c){var s={x:a.originX,y:a.originY};return"ml"===c||"tl"===c||"bl"===c?s.x="right":("mr"===c||"tr"===c||"br"===c)&&(s.x="left"),"tl"===c||"mt"===c||"tr"===c?s.y="bottom":("bl"===c||"mb"===c||"br"===c)&&(s.y="top"),s},_getActionFromCorner:function(a,c,s,f){if(!c||!a)return"drag";var g=f.controls[c];return g.getActionName(s,g,f)},_setupCurrentTransform:function(a,c,s){if(c){var f=this.getPointer(a),g=c.__corner,l=c.controls[g],v=s&&g?l.getActionHandler(a,c,l):w.controlsUtils.dragHandler,_=this._getActionFromCorner(s,g,a,c),b=this._getOriginFromCorner(c,g),S=a[this.centeredKey],T={target:c,action:_,actionHandler:v,corner:g,scaleX:c.scaleX,scaleY:c.scaleY,skewX:c.skewX,skewY:c.skewY,offsetX:f.x-c.left,offsetY:f.y-c.top,originX:b.x,originY:b.y,ex:f.x,ey:f.y,lastX:f.x,lastY:f.y,theta:h(c.angle),width:c.width*c.scaleX,shiftKey:a.shiftKey,altKey:S,original:w.util.saveObjectTransform(c)};this._shouldCenterTransform(c,_,S)&&(T.originX="center",T.originY="center"),T.original.originX=b.x,T.original.originY=b.y,this._currentTransform=T,this._beforeTransform(a)}},setCursor:function(a){this.upperCanvasEl.style.cursor=a},_drawSelection:function(a){var c=this._groupSelector,s=new w.Point(c.ex,c.ey),f=w.util.transformPoint(s,this.viewportTransform),g=new w.Point(c.ex+c.left,c.ey+c.top),l=w.util.transformPoint(g,this.viewportTransform),v=Math.min(f.x,l.x),_=Math.min(f.y,l.y),b=Math.max(f.x,l.x),S=Math.max(f.y,l.y),T=this.selectionLineWidth/2;this.selectionColor&&(a.fillStyle=this.selectionColor,a.fillRect(v,_,b-v,S-_)),this.selectionLineWidth&&this.selectionBorderColor&&(a.lineWidth=this.selectionLineWidth,a.strokeStyle=this.selectionBorderColor,v+=T,_+=T,b-=T,S-=T,w.Object.prototype._setLineDash.call(this,a,this.selectionDashArray),a.strokeRect(v,_,b-v,S-_))},findTarget:function(a,c){if(!this.skipTargetFind){var v,_,f=this.getPointer(a,!0),g=this._activeObject,l=this.getActiveObjects(),b=p(a),S=l.length>1&&!c||1===l.length;if(this.targets=[],S&&g._findTargetCorner(f,b)||l.length>1&&!c&&g===this._searchPossibleTargets([g],f))return g;if(1===l.length&&g===this._searchPossibleTargets([g],f)){if(!this.preserveObjectStacking)return g;v=g,_=this.targets,this.targets=[]}var T=this._searchPossibleTargets(this._objects,f);return a[this.altSelectionKey]&&T&&v&&T!==v&&(T=v,this.targets=_),T}},_checkTarget:function(a,c,s){if(c&&c.visible&&c.evented&&c.containsPoint(a)){if(!this.perPixelTargetFind&&!c.perPixelTargetFind||c.isEditing)return!0;if(!this.isTargetTransparent(c,s.x,s.y))return!0}},_searchPossibleTargets:function(a,c){for(var s,g,f=a.length;f--;){var l=a[f],v=l.group?this._normalizePointer(l.group,c):c;if(this._checkTarget(v,l,c)){(s=a[f]).subTargetCheck&&s instanceof w.Group&&(g=this._searchPossibleTargets(s._objects,c))&&this.targets.push(g);break}}return s},restorePointerVpt:function(a){return w.util.transformPoint(a,w.util.invertTransform(this.viewportTransform))},getPointer:function(a,c){if(this._absolutePointer&&!c)return this._absolutePointer;if(this._pointer&&c)return this._pointer;var _,s=y(a),f=this.upperCanvasEl,g=f.getBoundingClientRect(),l=g.width||0,v=g.height||0;(!l||!v)&&("top"in g&&"bottom"in g&&(v=Math.abs(g.top-g.bottom)),"right"in g&&"left"in g&&(l=Math.abs(g.right-g.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,c||(s=this.restorePointerVpt(s));var b=this.getRetinaScaling();return 1!==b&&(s.x/=b,s.y/=b),{x:s.x*(_=0===l||0===v?{width:1,height:1}:{width:f.width/l,height:f.height/v}).width,y:s.y*_.height}},_createUpperCanvas:function(){var a=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),c=this.lowerCanvasEl,s=this.upperCanvasEl;s?s.className="":(s=this._createCanvasElement(),this.upperCanvasEl=s),w.util.addClass(s,"upper-canvas "+a),this.wrapperEl.appendChild(s),this._copyCanvasStyle(c,s),this._applyCanvasStyle(s),this.contextTop=s.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=w.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),w.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),w.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(a){var c=this.width||a.width,s=this.height||a.height;w.util.setStyle(a,{position:"absolute",width:c+"px",height:s+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),a.width=c,a.height=s,w.util.makeElementUnselectable(a)},_copyCanvasStyle:function(a,c){c.style.cssText=a.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var a=this._activeObject;return a?"activeSelection"===a.type&&a._objects?a._objects.slice(0):[a]:[]},_onObjectRemoved:function(a){a===this._activeObject&&(this.fire("before:selection:cleared",{target:a}),this._discardActiveObject(),this.fire("selection:cleared",{target:a}),a.fire("deselected")),a===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",a)},_fireSelectionEvents:function(a,c){var s=!1,f=this.getActiveObjects(),g=[],l=[];a.forEach(function(v){-1===f.indexOf(v)&&(s=!0,v.fire("deselected",{e:c,target:v}),l.push(v))}),f.forEach(function(v){-1===a.indexOf(v)&&(s=!0,v.fire("selected",{e:c,target:v}),g.push(v))}),a.length>0&&f.length>0?s&&this.fire("selection:updated",{e:c,selected:g,deselected:l}):f.length>0?this.fire("selection:created",{e:c,selected:g}):a.length>0&&this.fire("selection:cleared",{e:c,deselected:l})},setActiveObject:function(a,c){var s=this.getActiveObjects();return this._setActiveObject(a,c),this._fireSelectionEvents(s,c),this},_setActiveObject:function(a,c){return!(this._activeObject===a||!this._discardActiveObject(c,a)||a.onSelect({e:c})||(this._activeObject=a,0))},_discardActiveObject:function(a,c){var s=this._activeObject;if(s){if(s.onDeselect({e:a,object:c}))return!1;this._activeObject=null}return!0},discardActiveObject:function(a){var c=this.getActiveObjects(),s=this.getActiveObject();return c.length&&this.fire("before:selection:cleared",{target:s,e:a}),this._discardActiveObject(a),this._fireSelectionEvents(c,a),this},dispose:function(){var a=this.wrapperEl;return this.removeListeners(),a.removeChild(this.upperCanvasEl),a.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(c){w.util.cleanUpJsdomNode(this[c]),this[c]=void 0}.bind(this)),a.parentNode&&a.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,w.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(a){var c=this._activeObject;c&&c._renderControls(a)},_toObject:function(a,c,s){var f=this._realizeGroupTransformOnObject(a),g=this.callSuper("_toObject",a,c,s);return this._unwindGroupTransformOnObject(a,f),g},_realizeGroupTransformOnObject:function(a){if(a.group&&"activeSelection"===a.group.type&&this._activeObject===a.group){var s={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(f){s[f]=a[f]}),w.util.addTransformToObject(a,this._activeObject.calcOwnMatrix()),s}return null},_unwindGroupTransformOnObject:function(a,c){c&&a.set(c)},_setSVGObject:function(a,c,s){var f=this._realizeGroupTransformOnObject(c);this.callSuper("_setSVGObject",a,c,s),this._unwindGroupTransformOnObject(c,f)},setViewportTransform:function(a){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),w.StaticCanvas.prototype.setViewportTransform.call(this,a)}}),w.StaticCanvas)"prototype"!==d&&(w.Canvas[d]=w.StaticCanvas[d])}(),function(){var y=w.util.addListener,h=w.util.removeListener,c={passive:!1};function s(f,g){return f.button&&f.button===g-1}w.util.object.extend(w.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(y,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(f,g){var l=this.upperCanvasEl,v=this._getEventPrefix();f(w.window,"resize",this._onResize),f(l,v+"down",this._onMouseDown),f(l,v+"move",this._onMouseMove,c),f(l,v+"out",this._onMouseOut),f(l,v+"enter",this._onMouseEnter),f(l,"wheel",this._onMouseWheel),f(l,"contextmenu",this._onContextMenu),f(l,"dblclick",this._onDoubleClick),f(l,"dragover",this._onDragOver),f(l,"dragenter",this._onDragEnter),f(l,"dragleave",this._onDragLeave),f(l,"drop",this._onDrop),this.enablePointerEvents||f(l,"touchstart",this._onTouchStart,c),typeof eventjs<"u"&&g in eventjs&&(eventjs[g](l,"gesture",this._onGesture),eventjs[g](l,"drag",this._onDrag),eventjs[g](l,"orientation",this._onOrientationChange),eventjs[g](l,"shake",this._onShake),eventjs[g](l,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(h,"remove");var f=this._getEventPrefix();h(w.document,f+"up",this._onMouseUp),h(w.document,"touchend",this._onTouchEnd,c),h(w.document,f+"move",this._onMouseMove,c),h(w.document,"touchmove",this._onMouseMove,c)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(f,g){this.__onTransformGesture&&this.__onTransformGesture(f,g)},_onDrag:function(f,g){this.__onDrag&&this.__onDrag(f,g)},_onMouseWheel:function(f){this.__onMouseWheel(f)},_onMouseOut:function(f){var g=this._hoveredTarget;this.fire("mouse:out",{target:g,e:f}),this._hoveredTarget=null,g&&g.fire("mouseout",{e:f});var l=this;this._hoveredTargets.forEach(function(v){l.fire("mouse:out",{target:g,e:f}),v&&g.fire("mouseout",{e:f})}),this._hoveredTargets=[]},_onMouseEnter:function(f){!this._currentTransform&&!this.findTarget(f)&&(this.fire("mouse:over",{target:null,e:f}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(f,g){this.__onOrientationChange&&this.__onOrientationChange(f,g)},_onShake:function(f,g){this.__onShake&&this.__onShake(f,g)},_onLongPress:function(f,g){this.__onLongPress&&this.__onLongPress(f,g)},_onDragOver:function(f){f.preventDefault();var g=this._simpleEventHandler("dragover",f);this._fireEnterLeaveEvents(g,f)},_onDrop:function(f){return this._simpleEventHandler("drop:before",f),this._simpleEventHandler("drop",f)},_onContextMenu:function(f){return this.stopContextMenu&&(f.stopPropagation(),f.preventDefault()),!1},_onDoubleClick:function(f){this._cacheTransformEventData(f),this._handleEvent(f,"dblclick"),this._resetTransformEventData(f)},getPointerId:function(f){var g=f.changedTouches;return g?g[0]&&g[0].identifier:this.enablePointerEvents?f.pointerId:-1},_isMainEvent:function(f){return!0===f.isPrimary||!1!==f.isPrimary&&("touchend"===f.type&&0===f.touches.length||!f.changedTouches||f.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(f){f.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(f)),this.__onMouseDown(f),this._resetTransformEventData();var g=this.upperCanvasEl,l=this._getEventPrefix();y(w.document,"touchend",this._onTouchEnd,c),y(w.document,"touchmove",this._onMouseMove,c),h(g,l+"down",this._onMouseDown)},_onMouseDown:function(f){this.__onMouseDown(f),this._resetTransformEventData();var g=this.upperCanvasEl,l=this._getEventPrefix();h(g,l+"move",this._onMouseMove,c),y(w.document,l+"up",this._onMouseUp),y(w.document,l+"move",this._onMouseMove,c)},_onTouchEnd:function(f){if(!(f.touches.length>0)){this.__onMouseUp(f),this._resetTransformEventData(),this.mainTouchId=null;var g=this._getEventPrefix();h(w.document,"touchend",this._onTouchEnd,c),h(w.document,"touchmove",this._onMouseMove,c);var l=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){y(l.upperCanvasEl,g+"down",l._onMouseDown),l._willAddMouseDown=0},400)}},_onMouseUp:function(f){this.__onMouseUp(f),this._resetTransformEventData();var g=this.upperCanvasEl,l=this._getEventPrefix();this._isMainEvent(f)&&(h(w.document,l+"up",this._onMouseUp),h(w.document,l+"move",this._onMouseMove,c),y(g,l+"move",this._onMouseMove,c))},_onMouseMove:function(f){!this.allowTouchScrolling&&f.preventDefault&&f.preventDefault(),this.__onMouseMove(f)},_onResize:function(){this.calcOffset()},_shouldRender:function(f){var g=this._activeObject;return!!(!!g!=!!f||g&&f&&g!==f)},__onMouseUp:function(f){var g,l=this._currentTransform,v=this._groupSelector,_=!1,b=!v||0===v.left&&0===v.top;if(this._cacheTransformEventData(f),g=this._target,this._handleEvent(f,"up:before"),s(f,3))this.fireRightClick&&this._handleEvent(f,"up",3,b);else{if(s(f,2))return this.fireMiddleClick&&this._handleEvent(f,"up",2,b),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(f);else if(this._isMainEvent(f)){if(l&&(this._finalizeCurrentTransform(f),_=l.actionPerformed),!b){var S=g===this._activeObject;this._maybeGroupObjects(f),_||(_=this._shouldRender(g)||!S&&g===this._activeObject)}var T,M;if(g){if(T=g._findTargetCorner(this.getPointer(f,!0),w.util.isTouchEvent(f)),g.selectable&&g!==this._activeObject&&"up"===g.activeOn)this.setActiveObject(g,f),_=!0;else{var P=g.controls[T],j=P&&P.getMouseUpHandler(f,g,P);j&&j(f,l,(M=this.getPointer(f)).x,M.y)}g.isMoving=!1}if(l&&(l.target!==g||l.corner!==T)){var G=l.target&&l.target.controls[l.corner],re=G&&G.getMouseUpHandler(f,g,P);M=M||this.getPointer(f),re&&re(f,l,M.x,M.y)}this._setCursorFromEvent(f,g),this._handleEvent(f,"up",1,b),this._groupSelector=null,this._currentTransform=null,g&&(g.__corner=0),_?this.requestRenderAll():b||this.renderTop()}}},_simpleEventHandler:function(f,g){var l=this.findTarget(g),v=this.targets,_={e:g,target:l,subTargets:v};if(this.fire(f,_),l&&l.fire(f,_),!v)return l;for(var b=0;b<v.length;b++)v[b].fire(f,_);return l},_handleEvent:function(f,g,l,v){var _=this._target,b=this.targets||[],S={e:f,target:_,subTargets:b,button:l||1,isClick:v||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===g&&(S.currentTarget=this.findTarget(f),S.currentSubTargets=this.targets),this.fire("mouse:"+g,S),_&&_.fire("mouse"+g,S);for(var T=0;T<b.length;T++)b[T].fire("mouse"+g,S)},_finalizeCurrentTransform:function(f){var g=this._currentTransform,l=g.target,v={e:f,target:l,transform:g,action:g.action};l._scaling&&(l._scaling=!1),l.setCoords(),(g.actionPerformed||this.stateful&&l.hasStateChanged())&&this._fire("modified",v)},_onMouseDownInDrawingMode:function(f){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(f).requestRenderAll();var g=this.getPointer(f);this.freeDrawingBrush.onMouseDown(g,{e:f,pointer:g}),this._handleEvent(f,"down")},_onMouseMoveInDrawingMode:function(f){if(this._isCurrentlyDrawing){var g=this.getPointer(f);this.freeDrawingBrush.onMouseMove(g,{e:f,pointer:g})}this.setCursor(this.freeDrawingCursor),this._handleEvent(f,"move")},_onMouseUpInDrawingMode:function(f){var g=this.getPointer(f);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:f,pointer:g}),this._handleEvent(f,"up")},__onMouseDown:function(f){this._cacheTransformEventData(f),this._handleEvent(f,"down:before");var g=this._target;if(s(f,3))this.fireRightClick&&this._handleEvent(f,"down",3);else if(s(f,2))this.fireMiddleClick&&this._handleEvent(f,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(f);else if(this._isMainEvent(f)&&!this._currentTransform){this._previousPointer=l=this._pointer;var v=this._shouldRender(g),_=this._shouldGroup(f,g);if(this._shouldClearSelection(f,g)?this.discardActiveObject(f):_&&(this._handleGrouping(f,g),g=this._activeObject),this.selection&&(!g||!g.selectable&&!g.isEditing&&g!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),g){var b=g===this._activeObject;g.selectable&&"down"===g.activeOn&&this.setActiveObject(g,f);var S=g._findTargetCorner(this.getPointer(f,!0),w.util.isTouchEvent(f));if(g.__corner=S,g===this._activeObject&&(S||!_)){this._setupCurrentTransform(f,g,b);var T=g.controls[S],l=this.getPointer(f),M=T&&T.getMouseDownHandler(f,g,T);M&&M(f,this._currentTransform,l.x,l.y)}}this._handleEvent(f,"down"),(v||_)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(f){this._resetTransformEventData(),this._pointer=this.getPointer(f,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(f)||null},_beforeTransform:function(f){var g=this._currentTransform;this.stateful&&g.target.saveState(),this.fire("before:transform",{e:f,transform:g})},__onMouseMove:function(f){var g,l;if(this._handleEvent(f,"move:before"),this._cacheTransformEventData(f),this.isDrawingMode)this._onMouseMoveInDrawingMode(f);else if(this._isMainEvent(f)){var v=this._groupSelector;v?(v.left=(l=this._absolutePointer).x-v.ex,v.top=l.y-v.ey,this.renderTop()):this._currentTransform?this._transformObject(f):(g=this.findTarget(f)||null,this._setCursorFromEvent(f,g),this._fireOverOutEvents(g,f)),this._handleEvent(f,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(f,g){var l=this._hoveredTarget,v=this._hoveredTargets,_=this.targets,b=Math.max(v.length,_.length);this.fireSyntheticInOutEvents(f,g,{oldTarget:l,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var S=0;S<b;S++)this.fireSyntheticInOutEvents(_[S],g,{oldTarget:v[S],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=f,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(f,g){var l=this._draggedoverTarget,v=this._hoveredTargets,_=this.targets,b=Math.max(v.length,_.length);this.fireSyntheticInOutEvents(f,g,{oldTarget:l,evtOut:"dragleave",evtIn:"dragenter"});for(var S=0;S<b;S++)this.fireSyntheticInOutEvents(_[S],g,{oldTarget:v[S],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=f},fireSyntheticInOutEvents:function(f,g,l){var v,_,T,b=l.oldTarget,M=b!==f,P=l.canvasEvtIn,j=l.canvasEvtOut;M&&(v={e:g,target:f,previousTarget:b},_={e:g,target:b,nextTarget:f}),T=f&&M,b&&M&&(j&&this.fire(j,_),b.fire(l.evtOut,_)),T&&(P&&this.fire(P,v),f.fire(l.evtIn,v))},__onMouseWheel:function(f){this._cacheTransformEventData(f),this._handleEvent(f,"wheel"),this._resetTransformEventData()},_transformObject:function(f){var g=this.getPointer(f),l=this._currentTransform;l.reset=!1,l.shiftKey=f.shiftKey,l.altKey=f[this.centeredKey],this._performTransformAction(f,l,g),l.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(f,g,l){var b=g.action,S=!1,T=g.actionHandler;T&&(S=T(f,g,l.x,l.y)),"drag"===b&&S&&(g.target.isMoving=!0,this.setCursor(g.target.moveCursor||this.moveCursor)),g.actionPerformed=g.actionPerformed||S},_fire:w.controlsUtils.fireEvent,_setCursorFromEvent:function(f,g){if(!g)return this.setCursor(this.defaultCursor),!1;var l=g.hoverCursor||this.hoverCursor,v=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,_=(!v||!v.contains(g))&&g._findTargetCorner(this.getPointer(f,!0));_?this.setCursor(this.getCornerCursor(_,g,f)):(g.subTargetCheck&&this.targets.concat().reverse().map(function(b){l=b.hoverCursor||l}),this.setCursor(l))},getCornerCursor:function(f,g,l){var v=g.controls[f];return v.cursorStyleHandler(l,v,g)}})}(),function(){var y=Math.min,h=Math.max;w.util.object.extend(w.Canvas.prototype,{_shouldGroup:function(p,d){var a=this._activeObject;return a&&this._isSelectionKeyPressed(p)&&d&&d.selectable&&this.selection&&(a!==d||"activeSelection"===a.type)&&!d.onSelect({e:p})},_handleGrouping:function(p,d){var a=this._activeObject;a.__corner||d===a&&(!(d=this.findTarget(p,!0))||!d.selectable)||(a&&"activeSelection"===a.type?this._updateActiveSelection(d,p):this._createActiveSelection(d,p))},_updateActiveSelection:function(p,d){var a=this._activeObject,c=a._objects.slice(0);a.contains(p)?(a.removeWithUpdate(p),this._hoveredTarget=p,this._hoveredTargets=this.targets.concat(),1===a.size()&&this._setActiveObject(a.item(0),d)):(a.addWithUpdate(p),this._hoveredTarget=a,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(c,d)},_createActiveSelection:function(p,d){var a=this.getActiveObjects(),c=this._createGroup(p);this._hoveredTarget=c,this._setActiveObject(c,d),this._fireSelectionEvents(a,d)},_createGroup:function(p){var d=this._objects,c=d.indexOf(this._activeObject)<d.indexOf(p)?[this._activeObject,p]:[p,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new w.ActiveSelection(c,{canvas:this})},_groupSelectedObjects:function(p){var a,d=this._collectObjects(p);1===d.length?this.setActiveObject(d[0],p):d.length>1&&(a=new w.ActiveSelection(d.reverse(),{canvas:this}),this.setActiveObject(a,p))},_collectObjects:function(p){for(var a,d=[],c=this._groupSelector.ex,s=this._groupSelector.ey,f=c+this._groupSelector.left,g=s+this._groupSelector.top,l=new w.Point(y(c,f),y(s,g)),v=new w.Point(h(c,f),h(s,g)),_=!this.selectionFullyContained,b=c===f&&s===g,S=this._objects.length;S--&&!((a=this._objects[S])&&a.selectable&&a.visible&&(_&&a.intersectsWithRect(l,v,!0)||a.isContainedWithinRect(l,v,!0)||_&&a.containsPoint(l,null,!0)||_&&a.containsPoint(v,null,!0))&&(d.push(a),b)););return d.length>1&&(d=d.filter(function(T){return!T.onSelect({e:p})})),d},_maybeGroupObjects:function(p){this.selection&&this._groupSelector&&this._groupSelectedObjects(p),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),w.util.object.extend(w.StaticCanvas.prototype,{toDataURL:function(y){y||(y={});var h=y.format||"png",p=y.quality||1,d=(y.multiplier||1)*(y.enableRetinaScaling?this.getRetinaScaling():1),a=this.toCanvasElement(d,y);return w.util.toDataURL(a,h,p)},toCanvasElement:function(y,h){var p=((h=h||{}).width||this.width)*(y=y||1),d=(h.height||this.height)*y,a=this.getZoom(),c=this.width,s=this.height,f=a*y,g=this.viewportTransform,_=this.interactive,b=[f,0,0,f,(g[4]-(h.left||0))*y,(g[5]-(h.top||0))*y],S=this.enableRetinaScaling,T=w.util.createCanvasElement(),M=this.contextTop;return T.width=p,T.height=d,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=b,this.width=p,this.height=d,this.calcViewportBoundaries(),this.renderCanvas(T.getContext("2d"),this._objects),this.viewportTransform=g,this.width=c,this.height=s,this.calcViewportBoundaries(),this.interactive=_,this.enableRetinaScaling=S,this.contextTop=M,T}}),w.util.object.extend(w.StaticCanvas.prototype,{loadFromJSON:function(y,h,p){if(y){var d="string"==typeof y?JSON.parse(y):w.util.object.clone(y),a=this,c=d.clipPath,s=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete d.clipPath,this._enlivenObjects(d.objects,function(f){a.clear(),a._setBgOverlay(d,function(){c?a._enlivenObjects([c],function(g){a.clipPath=g[0],a.__setupCanvas.call(a,d,f,s,h)}):a.__setupCanvas.call(a,d,f,s,h)})},p),this}},__setupCanvas:function(y,h,p,d){var a=this;h.forEach(function(c,s){a.insertAt(c,s)}),this.renderOnAddRemove=p,delete y.objects,delete y.backgroundImage,delete y.overlayImage,delete y.background,delete y.overlay,this._setOptions(y),this.renderAll(),d&&d()},_setBgOverlay:function(y,h){var p={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(y.backgroundImage||y.overlayImage||y.background||y.overlay){var d=function(){p.backgroundImage&&p.overlayImage&&p.backgroundColor&&p.overlayColor&&h&&h()};this.__setBgOverlay("backgroundImage",y.backgroundImage,p,d),this.__setBgOverlay("overlayImage",y.overlayImage,p,d),this.__setBgOverlay("backgroundColor",y.background,p,d),this.__setBgOverlay("overlayColor",y.overlay,p,d)}else h&&h()},__setBgOverlay:function(y,h,p,d){var a=this;if(!h)return p[y]=!0,void(d&&d());"backgroundImage"===y||"overlayImage"===y?w.util.enlivenObjects([h],function(c){a[y]=c[0],p[y]=!0,d&&d()}):this["set"+w.util.string.capitalize(y,!0)](h,function(){p[y]=!0,d&&d()})},_enlivenObjects:function(y,h,p){y&&0!==y.length?w.util.enlivenObjects(y,function(d){h&&h(d)},null,p):h&&h([])},_toDataURL:function(y,h){this.clone(function(p){h(p.toDataURL(y))})},_toDataURLWithMultiplier:function(y,h,p){this.clone(function(d){p(d.toDataURLWithMultiplier(y,h))})},clone:function(y,h){var p=JSON.stringify(this.toJSON(h));this.cloneWithoutData(function(d){d.loadFromJSON(p,function(){y&&y(d)})})},cloneWithoutData:function(y){var h=w.util.createCanvasElement();h.width=this.width,h.height=this.height;var p=new w.Canvas(h);this.backgroundImage?(p.setBackgroundImage(this.backgroundImage.src,function(){p.renderAll(),y&&y(p)}),p.backgroundImageOpacity=this.backgroundImageOpacity,p.backgroundImageStretch=this.backgroundImageStretch):y&&y(p)}}),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.object.extend,d=h.util.object.clone,a=h.util.toFixed,c=h.util.string.capitalize,s=h.util.degreesToRadians;h.Object||(h.Object=h.util.createClass(h.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:!h.isLikelyNode,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(l){l&&this.setOptions(l)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=h.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(l){var v=h.perfLimitSizeTotal,_=l.width,b=l.height,S=h.maxCacheSideLimit,T=h.minCacheSideLimit;if(_<=S&&b<=S&&_*b<=v)return _<T&&(l.width=T),b<T&&(l.height=T),l;var P=h.util.limitDimsByArea(_/b,v),j=h.util.capValue,G=j(T,P.x,S),re=j(T,P.y,S);return _>G&&(l.zoomX/=_/G,l.width=G,l.capped=!0),b>re&&(l.zoomY/=b/re,l.height=re,l.capped=!0),l},_getCacheCanvasDimensions:function(){var l=this.getTotalObjectScaling(),v=this._getTransformedDimensions(0,0),_=v.x*l.scaleX/this.scaleX,b=v.y*l.scaleY/this.scaleY;return{width:_+2,height:b+2,zoomX:l.scaleX,zoomY:l.scaleY,x:_,y:b}},_updateCacheCanvas:function(){var l=this.canvas;if(this.noScaleCache&&l&&l._currentTransform){var _=l._currentTransform.action;if(this===l._currentTransform.target&&_.slice&&"scale"===_.slice(0,5))return!1}var j,G,b=this._cacheCanvas,S=this._limitCacheSize(this._getCacheCanvasDimensions()),T=h.minCacheSideLimit,M=S.width,P=S.height,re=S.zoomX,le=S.zoomY,ge=M!==this.cacheWidth||P!==this.cacheHeight,ce=ge||this.zoomX!==re||this.zoomY!==le,fe=0,_e=0,ve=!1;if(ge){var Ce=this._cacheCanvas.width,I=this._cacheCanvas.height,N=M>Ce||P>I;ve=N||(M<.9*Ce||P<.9*I)&&Ce>T&&I>T,N&&!S.capped&&(M>T||P>T)&&(fe=.1*M,_e=.1*P)}return this instanceof h.Text&&this.path&&(ce=!0,ve=!0,fe+=this.getHeightOfLine(0)*this.zoomX,_e+=this.getHeightOfLine(0)*this.zoomY),!!ce&&(ve?(b.width=Math.ceil(M+fe),b.height=Math.ceil(P+_e)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,b.width,b.height)),j=S.x/2,G=S.y/2,this.cacheTranslationX=Math.round(b.width/2-j)+j,this.cacheTranslationY=Math.round(b.height/2-G)+G,this.cacheWidth=M,this.cacheHeight=P,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(re,le),this.zoomX=re,this.zoomY=le,!0)},setOptions:function(l){this._setOptions(l),this._initGradient(l.fill,"fill"),this._initGradient(l.stroke,"stroke"),this._initPattern(l.fill,"fill"),this._initPattern(l.stroke,"stroke")},transform:function(l){var _=this.calcTransformMatrix(!(this.group&&!this.group._transformDone||this.group&&this.canvas&&l===this.canvas.contextTop));l.transform(_[0],_[1],_[2],_[3],_[4],_[5])},toObject:function(l){var v=h.Object.NUM_FRACTION_DIGITS,_={type:this.type,version:h.version,originX:this.originX,originY:this.originY,left:a(this.left,v),top:a(this.top,v),width:a(this.width,v),height:a(this.height,v),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:a(this.strokeWidth,v),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:a(this.strokeMiterLimit,v),scaleX:a(this.scaleX,v),scaleY:a(this.scaleY,v),angle:a(this.angle,v),flipX:this.flipX,flipY:this.flipY,opacity:a(this.opacity,v),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:a(this.skewX,v),skewY:a(this.skewY,v)};return this.clipPath&&!this.clipPath.excludeFromExport&&(_.clipPath=this.clipPath.toObject(l),_.clipPath.inverted=this.clipPath.inverted,_.clipPath.absolutePositioned=this.clipPath.absolutePositioned),h.util.populateWithProperties(this,_,l),this.includeDefaultValues||(_=this._removeDefaultValues(_)),_},toDatalessObject:function(l){return this.toObject(l)},_removeDefaultValues:function(l){var v=h.util.getKlass(l.type).prototype;return v.stateProperties.forEach(function(b){"left"===b||"top"===b||(l[b]===v[b]&&delete l[b],Array.isArray(l[b])&&Array.isArray(v[b])&&0===l[b].length&&0===v[b].length&&delete l[b])}),l},toString:function(){return"#<fabric."+c(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var l=h.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(l.scaleX),scaleY:Math.abs(l.scaleY)}},getTotalObjectScaling:function(){var l=this.getObjectScaling(),v=l.scaleX,_=l.scaleY;if(this.canvas){var b=this.canvas.getZoom(),S=this.canvas.getRetinaScaling();v*=b*S,_*=b*S}return{scaleX:v,scaleY:_}},getObjectOpacity:function(){var l=this.opacity;return this.group&&(l*=this.group.getObjectOpacity()),l},_set:function(l,v){var b=this[l]!==v,S=!1;return("scaleX"===l||"scaleY"===l)&&(v=this._constrainScale(v)),"scaleX"===l&&v<0?(this.flipX=!this.flipX,v*=-1):"scaleY"===l&&v<0?(this.flipY=!this.flipY,v*=-1):"shadow"!==l||!v||v instanceof h.Shadow?"dirty"===l&&this.group&&this.group.set("dirty",v):v=new h.Shadow(v),this[l]=v,b&&(S=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(l)>-1?(this.dirty=!0,S&&this.group.set("dirty",!0)):S&&this.stateProperties.indexOf(l)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:h.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(l){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(l.save(),this._setupCompositeOperation(l),this.drawSelectionBackground(l),this.transform(l),this._setOpacity(l),this._setShadow(l,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(l)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(l),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),l.restore())},renderCache:function(l){l=l||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,l.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!!("stroke"===this.paintFirst&&this.hasFill()&&this.hasStroke()&&"object"==typeof this.shadow||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(l,v){if(l.save(),l.globalCompositeOperation=v.inverted?"destination-out":"destination-in",v.absolutePositioned){var _=h.util.invertTransform(this.calcTransformMatrix());l.transform(_[0],_[1],_[2],_[3],_[4],_[5])}v.transform(l),l.scale(1/v.zoomX,1/v.zoomY),l.drawImage(v._cacheCanvas,-v.cacheTranslationX,-v.cacheTranslationY),l.restore()},drawObject:function(l,v){var _=this.fill,b=this.stroke;v?(this.fill="black",this.stroke="",this._setClippingProperties(l)):this._renderBackground(l),this._render(l),this._drawClipPath(l,this.clipPath),this.fill=_,this.stroke=b},_drawClipPath:function(l,v){v&&(v.canvas=this.canvas,v.shouldCache(),v._transformDone=!0,v.renderCache({forClipping:!0}),this.drawClipPathOnCache(l,v))},drawCacheOnCanvas:function(l){l.scale(1/this.zoomX,1/this.zoomY),l.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(l){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!l&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!l){var v=this.cacheWidth/this.zoomX,_=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-v/2,-_/2,v,_)}return!0}return!1},_renderBackground:function(l){if(this.backgroundColor){var v=this._getNonTransformedDimensions();l.fillStyle=this.backgroundColor,l.fillRect(-v.x/2,-v.y/2,v.x,v.y),this._removeShadow(l)}},_setOpacity:function(l){this.group&&!this.group._transformDone?l.globalAlpha=this.getObjectOpacity():l.globalAlpha*=this.opacity},_setStrokeStyles:function(l,v){var _=v.stroke;_&&(l.lineWidth=v.strokeWidth,l.lineCap=v.strokeLineCap,l.lineDashOffset=v.strokeDashOffset,l.lineJoin=v.strokeLineJoin,l.miterLimit=v.strokeMiterLimit,_.toLive?"percentage"===_.gradientUnits||_.gradientTransform||_.patternTransform?this._applyPatternForTransformedGradient(l,_):(l.strokeStyle=_.toLive(l,this),this._applyPatternGradientTransform(l,_)):l.strokeStyle=v.stroke)},_setFillStyles:function(l,v){var _=v.fill;_&&(_.toLive?(l.fillStyle=_.toLive(l,this),this._applyPatternGradientTransform(l,v.fill)):l.fillStyle=_)},_setClippingProperties:function(l){l.globalAlpha=1,l.strokeStyle="transparent",l.fillStyle="#000000"},_setLineDash:function(l,v){!v||0===v.length||(1&v.length&&v.push.apply(v,v),l.setLineDash(v))},_renderControls:function(l,v){var S,T,M,_=this.getViewportTransform(),b=this.calcTransformMatrix();T=typeof(v=v||{}).hasBorders<"u"?v.hasBorders:this.hasBorders,M=typeof v.hasControls<"u"?v.hasControls:this.hasControls,b=h.util.multiplyTransformMatrices(_,b),S=h.util.qrDecompose(b),l.save(),l.translate(S.translateX,S.translateY),l.lineWidth=1*this.borderScaleFactor,this.group||(l.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(S.angle-=180),l.rotate(s(this.group?S.angle:this.angle)),v.forActiveSelection||this.group?T&&this.drawBordersInGroup(l,S,v):T&&this.drawBorders(l,v),M&&this.drawControls(l,v),l.restore()},_setShadow:function(l){if(this.shadow){var b,v=this.shadow,_=this.canvas,S=_&&_.viewportTransform[0]||1,T=_&&_.viewportTransform[3]||1;b=v.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),_&&_._isRetinaScaling()&&(S*=h.devicePixelRatio,T*=h.devicePixelRatio),l.shadowColor=v.color,l.shadowBlur=v.blur*h.browserShadowBlurConstant*(S+T)*(b.scaleX+b.scaleY)/4,l.shadowOffsetX=v.offsetX*S*b.scaleX,l.shadowOffsetY=v.offsetY*T*b.scaleY}},_removeShadow:function(l){this.shadow&&(l.shadowColor="",l.shadowBlur=l.shadowOffsetX=l.shadowOffsetY=0)},_applyPatternGradientTransform:function(l,v){if(!v||!v.toLive)return{offsetX:0,offsetY:0};var _=v.gradientTransform||v.patternTransform,b=-this.width/2+v.offsetX||0,S=-this.height/2+v.offsetY||0;return"percentage"===v.gradientUnits?l.transform(this.width,0,0,this.height,b,S):l.transform(1,0,0,1,b,S),_&&l.transform(_[0],_[1],_[2],_[3],_[4],_[5]),{offsetX:b,offsetY:S}},_renderPaintInOrder:function(l){"stroke"===this.paintFirst?(this._renderStroke(l),this._renderFill(l)):(this._renderFill(l),this._renderStroke(l))},_render:function(){},_renderFill:function(l){this.fill&&(l.save(),this._setFillStyles(l,this),"evenodd"===this.fillRule?l.fill("evenodd"):l.fill(),l.restore())},_renderStroke:function(l){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(l),l.save(),this.strokeUniform&&this.group){var v=this.getObjectScaling();l.scale(1/v.scaleX,1/v.scaleY)}else this.strokeUniform&&l.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(l,this.strokeDashArray),this._setStrokeStyles(l,this),l.stroke(),l.restore()}},_applyPatternForTransformedGradient:function(l,v){var S,_=this._limitCacheSize(this._getCacheCanvasDimensions()),b=h.util.createCanvasElement(),T=this.canvas.getRetinaScaling(),M=_.x/this.scaleX/T,P=_.y/this.scaleY/T;b.width=M,b.height=P,(S=b.getContext("2d")).beginPath(),S.moveTo(0,0),S.lineTo(M,0),S.lineTo(M,P),S.lineTo(0,P),S.closePath(),S.translate(M/2,P/2),S.scale(_.zoomX/this.scaleX/T,_.zoomY/this.scaleY/T),this._applyPatternGradientTransform(S,v),S.fillStyle=v.toLive(l),S.fill(),l.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),l.scale(T*this.scaleX/_.zoomX,T*this.scaleY/_.zoomY),l.strokeStyle=S.createPattern(b,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var l=h.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",l.scaleX),this.set("scaleY",l.scaleY),this.angle=l.angle,this.skewX=l.skewX,this.skewY=0}},_removeTransformMatrix:function(l){var v=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),v=h.util.transformPoint(v,this.transformMatrix)),this.transformMatrix=null,l&&(this.scaleX*=l.scaleX,this.scaleY*=l.scaleY,this.cropX=l.cropX,this.cropY=l.cropY,v.x+=l.offsetLeft,v.y+=l.offsetTop,this.width=l.width,this.height=l.height),this.setPositionByOrigin(v,"center","center")},clone:function(l,v){var _=this.toObject(v);this.constructor.fromObject?this.constructor.fromObject(_,l):h.Object._fromObject("Object",_,l)},cloneAsImage:function(l,v){var _=this.toCanvasElement(v);return l&&l(new h.Image(_)),this},toCanvasElement:function(l){l||(l={});var v=h.util,_=v.saveObjectTransform(this),b=this.group,S=this.shadow,T=Math.abs,M=(l.multiplier||1)*(l.enableRetinaScaling?h.devicePixelRatio:1);delete this.group,l.withoutTransform&&v.resetObjectTransform(this),l.withoutShadow&&(this.shadow=null);var re,ge,ce,P=h.util.createCanvasElement(),j=this.getBoundingRect(!0,!0),G=this.shadow,le={x:0,y:0};G&&(ge=G.blur,re=G.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),le.x=2*Math.round(T(G.offsetX)+ge)*T(re.scaleX),le.y=2*Math.round(T(G.offsetY)+ge)*T(re.scaleY)),ce=j.height+le.y,P.width=Math.ceil(j.width+le.x),P.height=Math.ceil(ce);var fe=new h.StaticCanvas(P,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===l.format&&(fe.backgroundColor="#fff"),this.setPositionByOrigin(new h.Point(fe.width/2,fe.height/2),"center","center");var _e=this.canvas;fe.add(this);var ve=fe.toCanvasElement(M||1,l);return this.shadow=S,this.set("canvas",_e),b&&(this.group=b),this.set(_).setCoords(),fe._objects=[],fe.dispose(),fe=null,ve},toDataURL:function(l){return l||(l={}),h.util.toDataURL(this.toCanvasElement(l),l.format||"png",l.quality||1)},isType:function(l){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===l},complexity:function(){return 1},toJSON:function(l){return this.toObject(l)},rotate:function(l){var v=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return v&&this._setOriginToCenter(),this.set("angle",l),v&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(l,v){v=v||this.canvas.getPointer(l);var _=new h.Point(v.x,v.y),b=this._getLeftTopCoords();return this.angle&&(_=h.util.rotatePoint(_,b,s(-this.angle))),{x:_.x-b.x,y:_.y-b.y}},_setupCompositeOperation:function(l){this.globalCompositeOperation&&(l.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){h.runningAnimations&&h.runningAnimations.cancelByTarget(this)}}),h.util.createAccessors&&h.util.createAccessors(h.Object),p(h.Object.prototype,h.Observable),h.Object.NUM_FRACTION_DIGITS=2,h.Object.ENLIVEN_PROPS=["clipPath"],h.Object._fromObject=function(l,v,_,b){var S=h[l];v=d(v,!0),h.util.enlivenPatterns([v.fill,v.stroke],function(T){typeof T[0]<"u"&&(v.fill=T[0]),typeof T[1]<"u"&&(v.stroke=T[1]),h.util.enlivenObjectEnlivables(v,v,function(){var M=b?new S(v[b],v):new S(v);_&&_(M)})})},h.Object.__uid=0)}(Ie),function(){var y=w.util.degreesToRadians,h={left:-.5,center:0,right:.5},p={top:-.5,center:0,bottom:.5};w.util.object.extend(w.Object.prototype,{translateToGivenOrigin:function(d,a,c,s,f){var v,_,b,g=d.x,l=d.y;return"string"==typeof a?a=h[a]:a-=.5,"string"==typeof s?s=h[s]:s-=.5,"string"==typeof c?c=p[c]:c-=.5,"string"==typeof f?f=p[f]:f-=.5,_=f-c,((v=s-a)||_)&&(b=this._getTransformedDimensions(),g=d.x+v*b.x,l=d.y+_*b.y),new w.Point(g,l)},translateToCenterPoint:function(d,a,c){var s=this.translateToGivenOrigin(d,a,c,"center","center");return this.angle?w.util.rotatePoint(s,d,y(this.angle)):s},translateToOriginPoint:function(d,a,c){var s=this.translateToGivenOrigin(d,"center","center",a,c);return this.angle?w.util.rotatePoint(s,d,y(this.angle)):s},getCenterPoint:function(){var d=new w.Point(this.left,this.top);return this.translateToCenterPoint(d,this.originX,this.originY)},getPointByOrigin:function(d,a){var c=this.getCenterPoint();return this.translateToOriginPoint(c,d,a)},toLocalPoint:function(d,a,c){var f,g,s=this.getCenterPoint();return f=typeof a<"u"&&typeof c<"u"?this.translateToGivenOrigin(s,"center","center",a,c):new w.Point(this.left,this.top),g=new w.Point(d.x,d.y),this.angle&&(g=w.util.rotatePoint(g,s,-y(this.angle))),g.subtractEquals(f)},setPositionByOrigin:function(d,a,c){var s=this.translateToCenterPoint(d,a,c),f=this.translateToOriginPoint(s,this.originX,this.originY);this.set("left",f.x),this.set("top",f.y)},adjustPosition:function(d){var g,l,a=y(this.angle),c=this.getScaledWidth(),s=w.util.cos(a)*c,f=w.util.sin(a)*c;this.left+=s*((l="string"==typeof d?h[d]:d-.5)-(g="string"==typeof this.originX?h[this.originX]:this.originX-.5)),this.top+=f*(l-g),this.setCoords(),this.originX=d},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var d=this.getCenterPoint();this.originX="center",this.originY="center",this.left=d.x,this.top=d.y},_resetOrigin:function(){var d=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=d.x,this.top=d.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){var h=w.util,p=h.degreesToRadians,d=h.multiplyTransformMatrices,a=h.transformPoint;h.object.extend(w.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(c,s){return s?c?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),c?this.aCoords:this.lineCoords)},getCoords:function(c,s){return function y(c){return[new w.Point(c.tl.x,c.tl.y),new w.Point(c.tr.x,c.tr.y),new w.Point(c.br.x,c.br.y),new w.Point(c.bl.x,c.bl.y)]}(this._getCoords(c,s))},intersectsWithRect:function(c,s,f,g){var l=this.getCoords(f,g);return"Intersection"===w.Intersection.intersectPolygonRectangle(l,c,s).status},intersectsWithObject:function(c,s,f){return"Intersection"===w.Intersection.intersectPolygonPolygon(this.getCoords(s,f),c.getCoords(s,f)).status||c.isContainedWithinObject(this,s,f)||this.isContainedWithinObject(c,s,f)},isContainedWithinObject:function(c,s,f){for(var g=this.getCoords(s,f),v=0,_=c._getImageLines(s?c.aCoords:c.lineCoords);v<4;v++)if(!c.containsPoint(g[v],_))return!1;return!0},isContainedWithinRect:function(c,s,f,g){var l=this.getBoundingRect(f,g);return l.left>=c.x&&l.left+l.width<=s.x&&l.top>=c.y&&l.top+l.height<=s.y},containsPoint:function(c,v,f,g){var l=this._getCoords(f,g),_=(v=v||this._getImageLines(l),this._findCrossPoints(c,v));return 0!==_&&_%2==1},isOnScreen:function(c){if(!this.canvas)return!1;var s=this.canvas.vptCoords.tl,f=this.canvas.vptCoords.br;return!(!this.getCoords(!0,c).some(function(l){return l.x<=f.x&&l.x>=s.x&&l.y<=f.y&&l.y>=s.y})&&!this.intersectsWithRect(s,f,!0,c))||this._containsCenterOfCanvas(s,f,c)},_containsCenterOfCanvas:function(c,s,f){return!!this.containsPoint({x:(c.x+s.x)/2,y:(c.y+s.y)/2},null,!0,f)},isPartiallyOnScreen:function(c){if(!this.canvas)return!1;var s=this.canvas.vptCoords.tl,f=this.canvas.vptCoords.br;return!!this.intersectsWithRect(s,f,!0,c)||this.getCoords(!0,c).every(function(l){return(l.x>=f.x||l.x<=s.x)&&(l.y>=f.y||l.y<=s.y)})&&this._containsCenterOfCanvas(s,f,c)},_getImageLines:function(c){return{topline:{o:c.tl,d:c.tr},rightline:{o:c.tr,d:c.br},bottomline:{o:c.br,d:c.bl},leftline:{o:c.bl,d:c.tl}}},_findCrossPoints:function(c,s){var g,l,v,_,S,b=0;for(var T in s)if(!((S=s[T]).o.y<c.y&&S.d.y<c.y||S.o.y>=c.y&&S.d.y>=c.y||(S.o.x===S.d.x&&S.o.x>=c.x?_=S.o.x:(g=(S.d.y-S.o.y)/(S.d.x-S.o.x),l=c.y-0*c.x,v=S.o.y-g*S.o.x,_=-(l-v)/(0-g)),_>=c.x&&(b+=1),2!==b)))break;return b},getBoundingRect:function(c,s){var f=this.getCoords(c,s);return h.makeBoundingBoxFromPoints(f)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(c){return Math.abs(c)<this.minScaleLimit?c<0?-this.minScaleLimit:this.minScaleLimit:0===c?1e-4:c},scale:function(c){return this._set("scaleX",c),this._set("scaleY",c),this.setCoords()},scaleToWidth:function(c,s){var f=this.getBoundingRect(s).width/this.getScaledWidth();return this.scale(c/this.width/f)},scaleToHeight:function(c,s){var f=this.getBoundingRect(s).height/this.getScaledHeight();return this.scale(c/this.height/f)},calcLineCoords:function(){var c=this.getViewportTransform(),s=this.padding,f=p(this.angle),v=h.cos(f)*s,_=h.sin(f)*s,b=v+_,S=v-_,T=this.calcACoords(),M={tl:a(T.tl,c),tr:a(T.tr,c),bl:a(T.bl,c),br:a(T.br,c)};return s&&(M.tl.x-=S,M.tl.y-=b,M.tr.x+=b,M.tr.y-=S,M.bl.x-=b,M.bl.y+=S,M.br.x+=S,M.br.y+=b),M},calcOCoords:function(){var c=this._calcRotateMatrix(),s=this._calcTranslateMatrix(),f=this.getViewportTransform(),g=d(f,s),l=d(g,c),v=(l=d(l,[1/f[0],0,0,1/f[3],0,0]),this._calculateCurrentDimensions()),_={};return this.forEachControl(function(b,S,T){_[S]=b.positionHandler(v,l,T)}),_},calcACoords:function(){var c=this._calcRotateMatrix(),s=this._calcTranslateMatrix(),f=d(s,c),g=this._getTransformedDimensions(),l=g.x/2,v=g.y/2;return{tl:a({x:-l,y:-v},f),tr:a({x:l,y:-v},f),bl:a({x:-l,y:v},f),br:a({x:l,y:v},f)}},setCoords:function(c){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),c||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return h.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var c=this.getCenterPoint();return[1,0,0,1,c.x,c.y]},transformMatrixKey:function(c){var s="_",f="";return!c&&this.group&&(f=this.group.transformMatrixKey(c)+s),f+this.top+s+this.left+s+this.scaleX+s+this.scaleY+s+this.skewX+s+this.skewY+s+this.angle+s+this.originX+s+this.originY+s+this.width+s+this.height+s+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(c){var s=this.calcOwnMatrix();if(c||!this.group)return s;var f=this.transformMatrixKey(c),g=this.matrixCache||(this.matrixCache={});return g.key===f?g.value:(this.group&&(s=d(this.group.calcTransformMatrix(!1),s)),g.key=f,g.value=s,s)},calcOwnMatrix:function(){var c=this.transformMatrixKey(!0),s=this.ownMatrixCache||(this.ownMatrixCache={});if(s.key===c)return s.value;var f=this._calcTranslateMatrix(),g={angle:this.angle,translateX:f[4],translateY:f[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return s.key=c,s.value=h.composeMatrix(g),s.value},_getNonTransformedDimensions:function(){var c=this.strokeWidth;return{x:this.width+c,y:this.height+c}},_getTransformedDimensions:function(c,s){typeof c>"u"&&(c=this.skewX),typeof s>"u"&&(s=this.skewY);var f,g,l,v=0===c&&0===s;if(this.strokeUniform?(g=this.width,l=this.height):(g=(f=this._getNonTransformedDimensions()).x,l=f.y),v)return this._finalizeDimensions(g*this.scaleX,l*this.scaleY);var _=h.sizeAfterTransform(g,l,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:c,skewY:s});return this._finalizeDimensions(_.x,_.y)},_finalizeDimensions:function(c,s){return this.strokeUniform?{x:c+this.strokeWidth,y:s+this.strokeWidth}:{x:c,y:s}},_calculateCurrentDimensions:function(){var c=this.getViewportTransform(),s=this._getTransformedDimensions();return a(s,c,!0).scalarAdd(2*this.padding)}})}(),w.util.object.extend(w.Object.prototype,{sendToBack:function(){return this.group?w.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?w.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(y){return this.group?w.StaticCanvas.prototype.sendBackwards.call(this.group,this,y):this.canvas&&this.canvas.sendBackwards(this,y),this},bringForward:function(y){return this.group?w.StaticCanvas.prototype.bringForward.call(this.group,this,y):this.canvas&&this.canvas.bringForward(this,y),this},moveTo:function(y){return this.group&&"activeSelection"!==this.group.type?w.StaticCanvas.prototype.moveTo.call(this.group,this,y):this.canvas&&this.canvas.moveTo(this,y),this}}),function(){function y(p,d){if(d){if(d.toLive)return p+": url(#SVGID_"+d.id+"); ";var a=new w.Color(d),c=p+": "+a.toRgb()+"; ",s=a.getAlpha();return 1!==s&&(c+=p+"-opacity: "+s.toString()+"; "),c}return p+": none; "}var h=w.util.toFixed;w.util.object.extend(w.Object.prototype,{getSvgStyles:function(p){var d=this.fillRule?this.fillRule:"nonzero",a=this.strokeWidth?this.strokeWidth:"0",c=this.strokeDashArray?this.strokeDashArray.join(" "):"none",s=this.strokeDashOffset?this.strokeDashOffset:"0",f=this.strokeLineCap?this.strokeLineCap:"butt",g=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",v=typeof this.opacity<"u"?this.opacity:"1",_=this.visible?"":" visibility: hidden;",b=p?"":this.getSvgFilter(),S=y("fill",this.fill);return[y("stroke",this.stroke),"stroke-width: ",a,"; ","stroke-dasharray: ",c,"; ","stroke-linecap: ",f,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",g,"; ","stroke-miterlimit: ",l,"; ",S,"fill-rule: ",d,"; ","opacity: ",v,";",b,_].join("")},getSvgSpanStyles:function(p,d){var a="; ",s=p.fontFamily?"font-family: "+(-1===p.fontFamily.indexOf("'")&&-1===p.fontFamily.indexOf('"')?"'"+p.fontFamily+"'":p.fontFamily)+a:"",c=p.strokeWidth?"stroke-width: "+p.strokeWidth+a:"",f=p.fontSize?"font-size: "+p.fontSize+"px"+a:"",g=p.fontStyle?"font-style: "+p.fontStyle+a:"",l=p.fontWeight?"font-weight: "+p.fontWeight+a:"",v=p.fill?y("fill",p.fill):"",_=p.stroke?y("stroke",p.stroke):"",b=this.getSvgTextDecoration(p);return b&&(b="text-decoration: "+b+a),[_,c,s,f,g,l,b,v,p.deltaY?"baseline-shift: "+-p.deltaY+"; ":"",d?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(p){return["overline","underline","line-through"].filter(function(d){return p[d.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(p,d){var a=p?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+w.util.matrixToSVG(a)+(d||"")+'" '},_setSVGBg:function(p){if(this.backgroundColor){var d=w.Object.NUM_FRACTION_DIGITS;p.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',h(-this.width/2,d),'" y="',h(-this.height/2,d),'" width="',h(this.width,d),'" height="',h(this.height,d),'"></rect>\n')}},toSVG:function(p){return this._createBaseSVGMarkup(this._toSVG(p),{reviver:p})},toClipPathSVG:function(p){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(p),{reviver:p})},_createBaseClipPathSVGMarkup:function(p,d){var a=(d=d||{}).reviver,s=[this.getSvgTransform(!0,d.additionalTransform||""),this.getSvgCommons()].join(""),f=p.indexOf("COMMON_PARTS");return p[f]=s,a?a(p.join("")):p.join("")},_createBaseSVGMarkup:function(p,d){var T,P,a=(d=d||{}).noStyle,c=d.reviver,s=a?"":'style="'+this.getSvgStyles()+'" ',f=d.withShadow?'style="'+this.getSvgFilter()+'" ':"",g=this.clipPath,l=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",v=g&&g.absolutePositioned,_=this.stroke,b=this.fill,S=this.shadow,M=[],j=p.indexOf("COMMON_PARTS"),G=d.additionalTransform;return g&&(g.clipPathId="CLIPPATH_"+w.Object.__uid++,P='<clipPath id="'+g.clipPathId+'" >\n'+g.toClipPathSVG(c)+"</clipPath>\n"),v&&M.push("<g ",f,this.getSvgCommons()," >\n"),M.push("<g ",this.getSvgTransform(!1),v?"":f+this.getSvgCommons()," >\n"),T=[s,l,a?"":this.addPaintOrder()," ",G?'transform="'+G+'" ':""].join(""),p[j]=T,b&&b.toLive&&M.push(b.toSVG(this)),_&&_.toLive&&M.push(_.toSVG(this)),S&&M.push(S.toSVG(this)),g&&M.push(P),M.push(p.join("")),M.push("</g>\n"),v&&M.push("</g>\n"),c?c(M.join("")):M.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var y=w.util.object.extend,h="stateProperties";function p(a,c,s){var f={};s.forEach(function(l){f[l]=a[l]}),y(a[c],f,!0)}function d(a,c,s){if(a===c)return!0;if(Array.isArray(a)){if(!Array.isArray(c)||a.length!==c.length)return!1;for(var f=0,g=a.length;f<g;f++)if(!d(a[f],c[f]))return!1;return!0}if(a&&"object"==typeof a){var v,l=Object.keys(a);if(!c||"object"!=typeof c||!s&&l.length!==Object.keys(c).length)return!1;for(f=0,g=l.length;f<g;f++)if("canvas"!==(v=l[f])&&"group"!==v&&!d(a[v],c[v]))return!1;return!0}}w.util.object.extend(w.Object.prototype,{hasStateChanged:function(a){var c="_"+(a=a||h);return Object.keys(this[c]).length<this[a].length||!d(this[c],this,!0)},saveState:function(a){var c=a&&a.propertySet||h,s="_"+c;return this[s]?(p(this,s,this[c]),a&&a.stateProperties&&p(this,s,a.stateProperties),this):this.setupState(a)},setupState:function(a){var c=(a=a||{}).propertySet||h;return a.propertySet=c,this["_"+c]={},this.saveState(a),this}})}(),function(){var y=w.util.degreesToRadians;w.util.object.extend(w.Object.prototype,{_findTargetCorner:function(h,p){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var c,s,l,d=h.x,a=h.y,f=Object.keys(this.oCoords),g=f.length-1;for(this.__corner=0;g>=0;g--)if(this.isControlVisible(l=f[g])&&(s=this._getImageLines(p?this.oCoords[l].touchCorner:this.oCoords[l].corner),0!==(c=this._findCrossPoints({x:d,y:a},s))&&c%2==1))return this.__corner=l,l;return!1},forEachControl:function(h){for(var p in this.controls)h(this.controls[p],p,this)},_setCornerCoords:function(){var h=this.oCoords;for(var p in h){var d=this.controls[p];h[p].corner=d.calcCornerCoords(this.angle,this.cornerSize,h[p].x,h[p].y,!1),h[p].touchCorner=d.calcCornerCoords(this.angle,this.touchCornerSize,h[p].x,h[p].y,!0)}},drawSelectionBackground:function(h){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;h.save();var p=this.getCenterPoint(),d=this._calculateCurrentDimensions(),a=this.canvas.viewportTransform;return h.translate(p.x,p.y),h.scale(1/a[0],1/a[3]),h.rotate(y(this.angle)),h.fillStyle=this.selectionBackgroundColor,h.fillRect(-d.x/2,-d.y/2,d.x,d.y),h.restore(),this},drawBorders:function(h,p){p=p||{};var d=this._calculateCurrentDimensions(),a=this.borderScaleFactor,c=d.x+a,s=d.y+a,f=typeof p.hasControls<"u"?p.hasControls:this.hasControls,g=!1;return h.save(),h.strokeStyle=p.borderColor||this.borderColor,this._setLineDash(h,p.borderDashArray||this.borderDashArray),h.strokeRect(-c/2,-s/2,c,s),f&&(h.beginPath(),this.forEachControl(function(l,v,_){l.withConnection&&l.getVisibility(_,v)&&(g=!0,h.moveTo(l.x*c,l.y*s),h.lineTo(l.x*c+l.offsetX,l.y*s+l.offsetY))}),g&&h.stroke()),h.restore(),this},drawBordersInGroup:function(h,p,d){d=d||{};var a=w.util.sizeAfterTransform(this.width,this.height,p),c=this.strokeWidth,s=this.strokeUniform,f=this.borderScaleFactor,g=a.x+c*(s?this.canvas.getZoom():p.scaleX)+f,l=a.y+c*(s?this.canvas.getZoom():p.scaleY)+f;return h.save(),this._setLineDash(h,d.borderDashArray||this.borderDashArray),h.strokeStyle=d.borderColor||this.borderColor,h.strokeRect(-g/2,-l/2,g,l),h.restore(),this},drawControls:function(h,p){p=p||{},h.save();var a,c,d=this.canvas.getRetinaScaling();return h.setTransform(d,0,0,d,0,0),h.strokeStyle=h.fillStyle=p.cornerColor||this.cornerColor,this.transparentCorners||(h.strokeStyle=p.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(h,p.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(a=this.group.calcTransformMatrix()),this.forEachControl(function(s,f,g){c=g.oCoords[f],s.getVisibility(g,f)&&(a&&(c=w.util.transformPoint(c,a)),s.render(h,c.x,c.y,p,g))}),h.restore(),this},isControlVisible:function(h){return this.controls[h]&&this.controls[h].getVisibility(this,h)},setControlVisible:function(h,p){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[h]=p,this},setControlsVisibility:function(h){for(var p in h||(h={}),h)this.setControlVisible(p,h[p]);return this},onDeselect:function(){},onSelect:function(){}})}(),w.util.object.extend(w.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(y,h){var p=function(){},d=(h=h||{}).onComplete||p,a=h.onChange||p,c=this;return w.util.animate({target:this,startValue:y.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(s){y.set("left",s),c.requestRenderAll(),a()},onComplete:function(){y.setCoords(),d()}})},fxCenterObjectV:function(y,h){var p=function(){},d=(h=h||{}).onComplete||p,a=h.onChange||p,c=this;return w.util.animate({target:this,startValue:y.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(s){y.set("top",s),c.requestRenderAll(),a()},onComplete:function(){y.setCoords(),d()}})},fxRemove:function(y,h){var p=function(){},d=(h=h||{}).onComplete||p,a=h.onChange||p,c=this;return w.util.animate({target:this,startValue:y.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(s){y.set("opacity",s),c.requestRenderAll(),a()},onComplete:function(){c.remove(y),d()}})}}),w.util.object.extend(w.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var h,y=[],d=[];for(h in arguments[0])y.push(h);for(var a=0,c=y.length;a<c;a++)d.push(this._animate(h=y[a],arguments[0][h],arguments[1],a!==c-1));return d}return this._animate.apply(this,arguments)},_animate:function(y,h,p,d){var c,a=this;h=h.toString(),p=p?w.util.object.clone(p):{},~y.indexOf(".")&&(c=y.split("."));var s=a.colorProperties.indexOf(y)>-1||c&&a.colorProperties.indexOf(c[1])>-1,f=c?this.get(c[0])[c[1]]:this.get(y);"from"in p||(p.from=f),s||(h=~h.indexOf("=")?f+parseFloat(h.replace("=","")):parseFloat(h));var g={target:this,startValue:p.from,endValue:h,byValue:p.by,easing:p.easing,duration:p.duration,abort:p.abort&&function(l,v,_){return p.abort.call(a,l,v,_)},onChange:function(l,v,_){c?a[c[0]][c[1]]=l:a.set(y,l),!d&&p.onChange&&p.onChange(l,v,_)},onComplete:function(l,v,_){d||(a.setCoords(),p.onComplete&&p.onComplete(l,v,_))}};return s?w.util.animateColor(g.startValue,g.endValue,g.duration,g):w.util.animate(g)}}),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.object.extend,d=h.util.object.clone,a={x1:1,x2:1,y1:1,y2:1};function c(s,f){var g=s.origin,l=s.axis1,v=s.axis2,_=s.dimension,b=f.nearest,S=f.center,T=f.farthest;return function(){switch(this.get(g)){case b:return Math.min(this.get(l),this.get(v));case S:return Math.min(this.get(l),this.get(v))+.5*this.get(_);case T:return Math.max(this.get(l),this.get(v))}}}h.Line?h.warn("fabric.Line is already defined"):(h.Line=h.util.createClass(h.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:h.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(s,f){s||(s=[0,0,0,0]),this.callSuper("initialize",f),this.set("x1",s[0]),this.set("y1",s[1]),this.set("x2",s[2]),this.set("y2",s[3]),this._setWidthHeight(f)},_setWidthHeight:function(s){s||(s={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in s?s.left:this._getLeftToOriginX(),this.top="top"in s?s.top:this._getTopToOriginY()},_set:function(s,f){return this.callSuper("_set",s,f),typeof a[s]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:c({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:c({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(s){s.beginPath();var f=this.calcLinePoints();s.moveTo(f.x1,f.y1),s.lineTo(f.x2,f.y2),s.lineWidth=this.strokeWidth;var g=s.strokeStyle;s.strokeStyle=this.stroke||s.fillStyle,this.stroke&&this._renderStroke(s),s.strokeStyle=g},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(s){return p(this.callSuper("toObject",s),this.calcLinePoints())},_getNonTransformedDimensions:function(){var s=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(s.y-=this.strokeWidth),0===this.height&&(s.x-=this.strokeWidth)),s},calcLinePoints:function(){var s=this.x1<=this.x2?-1:1,f=this.y1<=this.y2?-1:1;return{x1:s*this.width*.5,x2:s*this.width*-.5,y1:f*this.height*.5,y2:f*this.height*-.5}},_toSVG:function(){var s=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',s.x1,'" y1="',s.y1,'" x2="',s.x2,'" y2="',s.y2,'" />\n']}}),h.Line.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),h.Line.fromElement=function(s,f,g){g=g||{};var l=h.parseAttributes(s,h.Line.ATTRIBUTE_NAMES);f(new h.Line([l.x1||0,l.y1||0,l.x2||0,l.y2||0],p(l,g)))},h.Line.fromObject=function(s,f){var l=d(s,!0);l.points=[s.x1,s.y1,s.x2,s.y2],h.Object._fromObject("Line",l,function g(v){delete v.points,f&&f(v)},"points")})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.degreesToRadians;h.Circle?h.warn("fabric.Circle is already defined."):(h.Circle=h.util.createClass(h.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:h.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(a,c){return this.callSuper("_set",a,c),"radius"===a&&this.setRadius(c),this},toObject:function(a){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(a))},_toSVG:function(){var a,f=(this.endAngle-this.startAngle)%360;if(0===f)a=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n'];else{var g=p(this.startAngle),l=p(this.endAngle),v=this.radius;a=['<path d="M '+h.util.cos(g)*v+" "+h.util.sin(g)*v," A "+v+" "+v," 0 ",+(f>180?"1":"0")+" 1"," "+h.util.cos(l)*v+" "+h.util.sin(l)*v,'" ',"COMMON_PARTS"," />\n"]}return a},_render:function(a){a.beginPath(),a.arc(0,0,this.radius,p(this.startAngle),p(this.endAngle),!1),this._renderPaintInOrder(a)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(a){return this.radius=a,this.set("width",2*a).set("height",2*a)}}),h.Circle.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),h.Circle.fromElement=function(a,c){var s=h.parseAttributes(a,h.Circle.ATTRIBUTE_NAMES);if(!function d(a){return"radius"in a&&a.radius>=0}(s))throw new Error("value of `r` attribute is required and can not be negative");s.left=(s.left||0)-s.radius,s.top=(s.top||0)-s.radius,c(new h.Circle(s))},h.Circle.fromObject=function(a,c){h.Object._fromObject("Circle",a,c)})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={});h.Triangle?h.warn("fabric.Triangle is already defined"):(h.Triangle=h.util.createClass(h.Object,{type:"triangle",width:100,height:100,_render:function(p){var d=this.width/2,a=this.height/2;p.beginPath(),p.moveTo(-d,a),p.lineTo(0,-a),p.lineTo(d,a),p.closePath(),this._renderPaintInOrder(p)},_toSVG:function(){var p=this.width/2,d=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-p+" "+d,"0 "+-d,p+" "+d].join(","),'" />']}}),h.Triangle.fromObject=function(p,d){return h.Object._fromObject("Triangle",p,d)})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=2*Math.PI;h.Ellipse?h.warn("fabric.Ellipse is already defined."):(h.Ellipse=h.util.createClass(h.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:h.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this.set("rx",d&&d.rx||0),this.set("ry",d&&d.ry||0)},_set:function(d,a){switch(this.callSuper("_set",d,a),d){case"rx":this.rx=a,this.set("width",2*a);break;case"ry":this.ry=a,this.set("height",2*a)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(d){d.beginPath(),d.save(),d.transform(1,0,0,this.ry/this.rx,0,0),d.arc(0,0,this.rx,0,p,!1),d.restore(),this._renderPaintInOrder(d)}}),h.Ellipse.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),h.Ellipse.fromElement=function(d,a){var c=h.parseAttributes(d,h.Ellipse.ATTRIBUTE_NAMES);c.left=(c.left||0)-c.rx,c.top=(c.top||0)-c.ry,a(new h.Ellipse(c))},h.Ellipse.fromObject=function(d,a){h.Object._fromObject("Ellipse",d,a)})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.object.extend;h.Rect?h.warn("fabric.Rect is already defined"):(h.Rect=h.util.createClass(h.Object,{stateProperties:h.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:h.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(d){var a=this.rx?Math.min(this.rx,this.width/2):0,c=this.ry?Math.min(this.ry,this.height/2):0,s=this.width,f=this.height,g=-this.width/2,l=-this.height/2,v=0!==a||0!==c,_=.4477152502;d.beginPath(),d.moveTo(g+a,l),d.lineTo(g+s-a,l),v&&d.bezierCurveTo(g+s-_*a,l,g+s,l+_*c,g+s,l+c),d.lineTo(g+s,l+f-c),v&&d.bezierCurveTo(g+s,l+f-_*c,g+s-_*a,l+f,g+s-a,l+f),d.lineTo(g+a,l+f),v&&d.bezierCurveTo(g+_*a,l+f,g,l+f-_*c,g,l+f-c),d.lineTo(g,l+c),v&&d.bezierCurveTo(g,l+_*c,g+_*a,l,g+a,l),d.closePath(),this._renderPaintInOrder(d)},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),h.Rect.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),h.Rect.fromElement=function(d,a,c){if(!d)return a(null);c=c||{};var s=h.parseAttributes(d,h.Rect.ATTRIBUTE_NAMES);s.left=s.left||0,s.top=s.top||0,s.height=s.height||0,s.width=s.width||0;var f=new h.Rect(p(c?h.util.object.clone(c):{},s));f.visible=f.visible&&f.width>0&&f.height>0,a(f)},h.Rect.fromObject=function(d,a){return h.Object._fromObject("Rect",d,a)})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.object.extend,d=h.util.array.min,a=h.util.array.max,c=h.util.toFixed,s=h.util.projectStrokeOnPoints;h.Polyline?h.warn("fabric.Polyline is already defined"):(h.Polyline=h.util.createClass(h.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:h.Object.prototype.cacheProperties.concat("points"),initialize:function(f,g){g=g||{},this.points=f||[],this.callSuper("initialize",g),this._setPositionDimensions(g)},_projectStrokeOnPoints:function(){return s(this.points,this,!0)},_setPositionDimensions:function(f){var l,g=this._calcDimensions(f),v=this.exactBoundingBox?this.strokeWidth:0;this.width=g.width-v,this.height=g.height-v,f.fromSVG||(l=this.translateToGivenOrigin({x:g.left-this.strokeWidth/2+v/2,y:g.top-this.strokeWidth/2+v/2},"left","top",this.originX,this.originY)),typeof f.left>"u"&&(this.left=f.fromSVG?g.left:l.x),typeof f.top>"u"&&(this.top=f.fromSVG?g.top:l.y),this.pathOffset={x:g.left+this.width/2+v/2,y:g.top+this.height/2+v/2}},_calcDimensions:function(){var f=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,g=d(f,"x")||0,l=d(f,"y")||0;return{left:g,top:l,width:(a(f,"x")||0)-g,height:(a(f,"y")||0)-l}},toObject:function(f){return p(this.callSuper("toObject",f),{points:this.points.concat()})},_toSVG:function(){for(var f=[],g=this.pathOffset.x,l=this.pathOffset.y,v=h.Object.NUM_FRACTION_DIGITS,_=0,b=this.points.length;_<b;_++)f.push(c(this.points[_].x-g,v),",",c(this.points[_].y-l,v)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',f.join(""),'" />\n']},commonRender:function(f){var g,l=this.points.length,v=this.pathOffset.x,_=this.pathOffset.y;if(!l||isNaN(this.points[l-1].y))return!1;f.beginPath(),f.moveTo(this.points[0].x-v,this.points[0].y-_);for(var b=0;b<l;b++)f.lineTo((g=this.points[b]).x-v,g.y-_);return!0},_render:function(f){this.commonRender(f)&&this._renderPaintInOrder(f)},complexity:function(){return this.get("points").length}}),h.Polyline.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(),h.Polyline.fromElementGenerator=function(f){return function(g,l,v){if(!g)return l(null);v||(v={});var _=h.parsePointsAttribute(g.getAttribute("points")),b=h.parseAttributes(g,h[f].ATTRIBUTE_NAMES);b.fromSVG=!0,l(new h[f](_,p(b,v)))}},h.Polyline.fromElement=h.Polyline.fromElementGenerator("Polyline"),h.Polyline.fromObject=function(f,g){return h.Object._fromObject("Polyline",f,g,"points")})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.projectStrokeOnPoints;h.Polygon?h.warn("fabric.Polygon is already defined"):(h.Polygon=h.util.createClass(h.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return p(this.points,this)},_render:function(d){this.commonRender(d)&&(d.closePath(),this._renderPaintInOrder(d))}}),h.Polygon.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(),h.Polygon.fromElement=h.Polyline.fromElementGenerator("Polygon"),h.Polygon.fromObject=function(d,a){h.Object._fromObject("Polygon",d,a,"points")})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.array.min,d=h.util.array.max,a=h.util.object.extend,c=h.util.object.clone,s=h.util.toFixed;h.Path?h.warn("fabric.Path is already defined"):(h.Path=h.util.createClass(h.Object,{type:"path",path:null,cacheProperties:h.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:h.Object.prototype.stateProperties.concat("path"),initialize:function(f,g){delete(g=c(g||{})).path,this.callSuper("initialize",g),this._setPath(f||[],g)},_setPath:function(f,g){this.path=h.util.makePathSimpler(Array.isArray(f)?f:h.util.parsePath(f)),h.Polyline.prototype._setPositionDimensions.call(this,g||{})},_renderPathCommands:function(f){var g,l=0,v=0,_=0,b=0,M=-this.pathOffset.x,P=-this.pathOffset.y;f.beginPath();for(var j=0,G=this.path.length;j<G;++j)switch(g=this.path[j],g[0]){case"L":f.lineTo((_=g[1])+M,(b=g[2])+P);break;case"M":l=_=g[1],v=b=g[2],f.moveTo(_+M,b+P);break;case"C":f.bezierCurveTo(g[1]+M,g[2]+P,g[3]+M,g[4]+P,(_=g[5])+M,(b=g[6])+P);break;case"Q":f.quadraticCurveTo(g[1]+M,g[2]+P,g[3]+M,g[4]+P),_=g[3],b=g[4];break;case"z":case"Z":_=l,b=v,f.closePath()}},_render:function(f){this._renderPathCommands(f),this._renderPaintInOrder(f)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(f){return a(this.callSuper("toObject",f),{path:this.path.map(function(g){return g.slice()})})},toDatalessObject:function(f){var g=this.toObject(["sourcePath"].concat(f));return g.sourcePath&&delete g.path,g},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',h.util.joinPath(this.path),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var f=h.Object.NUM_FRACTION_DIGITS;return" translate("+s(-this.pathOffset.x,f)+", "+s(-this.pathOffset.y,f)+")"},toClipPathSVG:function(f){var g=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:f,additionalTransform:g})},toSVG:function(f){var g=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:f,additionalTransform:g})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var l,T,f=[],g=[],v=0,_=0,b=0,S=0,M=0,P=this.path.length;M<P;++M){switch((l=this.path[M])[0]){case"L":b=l[1],S=l[2],T=[];break;case"M":v=b=l[1],_=S=l[2],T=[];break;case"C":T=h.util.getBoundsOfCurve(b,S,l[1],l[2],l[3],l[4],l[5],l[6]),b=l[5],S=l[6];break;case"Q":T=h.util.getBoundsOfCurve(b,S,l[1],l[2],l[1],l[2],l[3],l[4]),b=l[3],S=l[4];break;case"z":case"Z":b=v,S=_}T.forEach(function(ce){f.push(ce.x),g.push(ce.y)}),f.push(b),g.push(S)}var j=p(f)||0,G=p(g)||0;return{left:j,top:G,width:(d(f)||0)-j,height:(d(g)||0)-G}}}),h.Path.fromObject=function(f,g){"string"==typeof f.sourcePath?h.loadSVGFromURL(f.sourcePath,function(v){var _=v[0];_.setOptions(f),f.clipPath?h.util.enlivenObjects([f.clipPath],function(b){_.clipPath=b[0],g&&g(_)}):g&&g(_)}):h.Object._fromObject("Path",f,g,"path")},h.Path.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(["d"]),h.Path.fromElement=function(f,g,l){var v=h.parseAttributes(f,h.Path.ATTRIBUTE_NAMES);v.fromSVG=!0,g(new h.Path(v.d,a(v,l)))})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.array.min,d=h.util.array.max;h.Group||(h.Group=h.util.createClass(h.Object,h.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(a,c,s){c=c||{},this._objects=[],s&&this.callSuper("initialize",c),this._objects=a||[];for(var f=this._objects.length;f--;)this._objects[f].group=this;if(s)this._updateObjectsACoords();else{var g=c&&c.centerPoint;void 0!==c.originX&&(this.originX=c.originX),void 0!==c.originY&&(this.originY=c.originY),g||this._calcBounds(),this._updateObjectsCoords(g),delete c.centerPoint,this.callSuper("initialize",c)}this.setCoords()},_updateObjectsACoords:function(){for(var c=this._objects.length;c--;)this._objects[c].setCoords(!0)},_updateObjectsCoords:function(c){c=c||this.getCenterPoint();for(var s=this._objects.length;s--;)this._updateObjectCoords(this._objects[s],c)},_updateObjectCoords:function(a,c){a.set({left:a.left-c.x,top:a.top-c.y}),a.group=this,a.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(a){var c=!!this.group;return this._restoreObjectsState(),h.util.resetObjectTransform(this),a&&(c&&h.util.removeTransformFromObject(a,this.group.calcTransformMatrix()),this._objects.push(a),a.group=this,a._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,c?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(a){return this._restoreObjectsState(),h.util.resetObjectTransform(this),this.remove(a),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(a){this.dirty=!0,a.group=this,a._set("canvas",this.canvas)},_onObjectRemoved:function(a){this.dirty=!0,delete a.group},_set:function(a,c){var s=this._objects.length;if(this.useSetOnGroup)for(;s--;)this._objects[s].setOnGroup(a,c);if("canvas"===a)for(;s--;)this._objects[s]._set(a,c);h.Object.prototype._set.call(this,a,c)},toObject:function(a){var c=this.includeDefaultValues,s=this._objects.filter(function(g){return!g.excludeFromExport}).map(function(g){var l=g.includeDefaultValues;g.includeDefaultValues=c;var v=g.toObject(a);return g.includeDefaultValues=l,v}),f=h.Object.prototype.toObject.call(this,a);return f.objects=s,f},toDatalessObject:function(a){var c,s=this.sourcePath;if(s)c=s;else{var f=this.includeDefaultValues;c=this._objects.map(function(l){var v=l.includeDefaultValues;l.includeDefaultValues=f;var _=l.toDatalessObject(a);return l.includeDefaultValues=v,_})}var g=h.Object.prototype.toDatalessObject.call(this,a);return g.objects=c,g},render:function(a){this._transformDone=!0,this.callSuper("render",a),this._transformDone=!1},shouldCache:function(){var a=h.Object.prototype.shouldCache.call(this);if(a)for(var c=0,s=this._objects.length;c<s;c++)if(this._objects[c].willDrawShadow())return this.ownCaching=!1,!1;return a},willDrawShadow:function(){if(h.Object.prototype.willDrawShadow.call(this))return!0;for(var a=0,c=this._objects.length;a<c;a++)if(this._objects[a].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(a){for(var c=0,s=this._objects.length;c<s;c++)this._objects[c].render(a);this._drawClipPath(a,this.clipPath)},isCacheDirty:function(a){if(this.callSuper("isCacheDirty",a))return!0;if(!this.statefullCache)return!1;for(var c=0,s=this._objects.length;c<s;c++)if(this._objects[c].isCacheDirty(!0)){if(this._cacheCanvas){var f=this.cacheWidth/this.zoomX,g=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-f/2,-g/2,f,g)}return!0}return!1},_restoreObjectsState:function(){var a=this.calcOwnMatrix();return this._objects.forEach(function(c){h.util.addTransformToObject(c,a),delete c.group,c.setCoords()}),this},destroy:function(){return this._objects.forEach(function(a){a.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(a){a.dispose&&a.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var a=this._objects,c=this.canvas;this._objects=[];var s=this.toObject();delete s.objects;var f=new h.ActiveSelection([]);return f.set(s),f.type="activeSelection",c.remove(this),a.forEach(function(g){g.group=f,g.dirty=!0,c.add(g)}),f.canvas=c,f._objects=a,c._activeObject=f,f.setCoords(),f}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(c){c.setCoords(!0)}),this},_calcBounds:function(a){for(var f,g,l,S,c=[],s=[],v=["tr","br","bl","tl"],_=0,b=this._objects.length,T=v.length;_<b;++_){for(l=(f=this._objects[_]).calcACoords(),S=0;S<T;S++)c.push(l[g=v[S]].x),s.push(l[g].y);f.aCoords=l}this._getBounds(c,s,a)},_getBounds:function(a,c,s){var f=new h.Point(p(a),p(c)),g=new h.Point(d(a),d(c)),l=f.y||0,v=f.x||0,b=g.y-f.y||0;this.width=g.x-f.x||0,this.height=b,s||this.setPositionByOrigin({x:v,y:l},"left","top")},_toSVG:function(a){for(var c=["<g ","COMMON_PARTS"," >\n"],s=0,f=this._objects.length;s<f;s++)c.push("\t\t",this._objects[s].toSVG(a));return c.push("</g>\n"),c},getSvgStyles:function(){var c=this.visible?"":" visibility: hidden;";return[typeof this.opacity<"u"&&1!==this.opacity?"opacity: "+this.opacity+";":"",this.getSvgFilter(),c].join("")},toClipPathSVG:function(a){for(var c=[],s=0,f=this._objects.length;s<f;s++)c.push("\t",this._objects[s].toClipPathSVG(a));return this._createBaseClipPathSVGMarkup(c,{reviver:a})}}),h.Group.fromObject=function(a,c){var s=a.objects,f=h.util.object.clone(a,!0);delete f.objects,"string"!=typeof s?h.util.enlivenObjects(s,function(g){h.util.enlivenObjectEnlivables(a,f,function(){c&&c(new h.Group(g,f,!0))})}):h.loadSVGFromURL(s,function(g){var l=h.util.groupSVGElements(g,a,s),v=f.clipPath;delete f.clipPath,l.set(f),v?h.util.enlivenObjects([v],function(_){l.clipPath=_[0],c&&c(l)}):c&&c(l)})})}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={});h.ActiveSelection||(h.ActiveSelection=h.util.createClass(h.Group,{type:"activeSelection",initialize:function(p,d){d=d||{},this._objects=p||[];for(var a=this._objects.length;a--;)this._objects[a].group=this;d.originX&&(this.originX=d.originX),d.originY&&(this.originY=d.originY),this._calcBounds(),this._updateObjectsCoords(),h.Object.prototype.initialize.call(this,d),this.setCoords()},toGroup:function(){var p=this._objects.concat();this._objects=[];var d=h.Object.prototype.toObject.call(this),a=new h.Group([]);if(delete d.type,a.set(d),p.forEach(function(s){s.canvas.remove(s),s.group=a}),a._objects=p,!this.canvas)return a;var c=this.canvas;return c.add(a),c._activeObject=a,a.setCoords(),a},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(p,d,a){p.save(),p.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",p,d),typeof(a=a||{}).hasControls>"u"&&(a.hasControls=!1),a.forActiveSelection=!0;for(var c=0,s=this._objects.length;c<s;c++)this._objects[c]._renderControls(p,a);p.restore()}}),h.ActiveSelection.fromObject=function(p,d){h.util.enlivenObjects(p.objects,function(a){delete p.objects,d&&d(new h.ActiveSelection(a,p,!0))})})}(Ie),function(y){"use strict";var h=w.util.object.extend;y.fabric||(y.fabric={}),y.fabric.Image?w.warn("fabric.Image is already defined."):(w.Image=w.util.createClass(w.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:w.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:w.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(p,d){d||(d={}),this.filters=[],this.cacheKey="texture"+w.Object.__uid++,this.callSuper("initialize",d),this._initElement(p,d)},getElement:function(){return this._element||{}},setElement:function(p,d){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=p,this._originalElement=p,this._initConfig(d),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(p){var d=w.filterBackend;d&&d.evictCachesForKey&&d.evictCachesForKey(p)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(p){w.util.cleanUpJsdomNode(this[p]),this[p]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var p=this.getElement();return{width:p.naturalWidth||p.width,height:p.naturalHeight||p.height}},_stroke:function(p){if(this.stroke&&0!==this.strokeWidth){var d=this.width/2,a=this.height/2;p.beginPath(),p.moveTo(-d,-a),p.lineTo(d,-a),p.lineTo(d,a),p.lineTo(-d,a),p.lineTo(-d,-a),p.closePath()}},toObject:function(p){var d=[];this.filters.forEach(function(c){c&&d.push(c.toObject())});var a=h(this.callSuper("toObject",["cropX","cropY"].concat(p)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:d});return this.resizeFilter&&(a.resizeFilter=this.resizeFilter.toObject()),a},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var a,p=[],d=[],c=this._element,s=-this.width/2,f=-this.height/2,g="",l="";if(!c)return[];if(this.hasCrop()){var v=w.Object.__uid++;p.push('<clipPath id="imageCrop_'+v+'">\n','\t<rect x="'+s+'" y="'+f+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),g=' clip-path="url(#imageCrop_'+v+')" '}if(this.imageSmoothing||(l='" image-rendering="optimizeSpeed'),d.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',s-this.cropX,'" y="',f-this.cropY,'" width="',c.width||c.naturalWidth,'" height="',c.height||c.height,l,'"',g,"></image>\n"),this.stroke||this.strokeDashArray){var _=this.fill;this.fill=null,a=["\t<rect ",'x="',s,'" y="',f,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=_}return"fill"!==this.paintFirst?p.concat(a,d):p.concat(d,a)},getSrc:function(p){var d=p?this._element:this._originalElement;return d?d.toDataURL?d.toDataURL():this.srcFromAttribute?d.getAttribute("src"):d.src:this.src||""},setSrc:function(p,d,a){return w.util.loadImage(p,function(c,s){this.setElement(c,a),this._setWidthHeight(),d&&d(this,s)},this,a&&a.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var p=this.resizeFilter,d=this.minimumScaleTrigger,a=this.getTotalObjectScaling(),c=a.scaleX,s=a.scaleY,f=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!p||c>d&&s>d)return this._element=f,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=c,void(this._lastScaleY=s);w.filterBackend||(w.filterBackend=w.initFilterBackend());var g=w.util.createCanvasElement(),l=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,v=f.width,_=f.height;g.width=v,g.height=_,this._element=g,this._lastScaleX=p.scaleX=c,this._lastScaleY=p.scaleY=s,w.filterBackend.applyFilters([p],f,v,_,this._element,l),this._filterScalingX=g.width/this._originalElement.width,this._filterScalingY=g.height/this._originalElement.height},applyFilters:function(p){if(p=(p=p||this.filters||[]).filter(function(f){return f&&!f.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===p.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var d=this._originalElement,a=d.naturalWidth||d.width,c=d.naturalHeight||d.height;if(this._element===this._originalElement){var s=w.util.createCanvasElement();s.width=a,s.height=c,this._element=s,this._filteredEl=s}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,a,c),this._lastScaleX=1,this._lastScaleY=1;return w.filterBackend||(w.filterBackend=w.initFilterBackend()),w.filterBackend.applyFilters(p,this._originalElement,a,c,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(p){w.util.setImageSmoothing(p,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(p),this._renderPaintInOrder(p)},drawCacheOnCanvas:function(p){w.util.setImageSmoothing(p,this.imageSmoothing),w.Object.prototype.drawCacheOnCanvas.call(this,p)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(p){var d=this._element;if(d){var a=this._filterScalingX,c=this._filterScalingY,s=this.width,f=this.height,g=Math.min,l=Math.max,v=l(this.cropX,0),_=l(this.cropY,0),b=d.naturalWidth||d.width,S=d.naturalHeight||d.height,T=v*a,M=_*c,P=g(s*a,b-T),j=g(f*c,S-M),G=-s/2,re=-f/2,le=g(s,b/a-v),ge=g(f,S/c-_);d&&p.drawImage(d,T,M,P,j,G,re,le,ge)}},_needsResize:function(){var p=this.getTotalObjectScaling();return p.scaleX!==this._lastScaleX||p.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(p,d){this.setElement(w.util.getById(p),d),w.util.addClass(this.getElement(),w.Image.CSS_CANVAS)},_initConfig:function(p){p||(p={}),this.setOptions(p),this._setWidthHeight(p)},_initFilters:function(p,d){p&&p.length?w.util.enlivenObjects(p,function(a){d&&d(a)},"fabric.Image.filters"):d&&d()},_setWidthHeight:function(p){p||(p={});var d=this.getElement();this.width=p.width||d.naturalWidth||d.width||0,this.height=p.height||d.naturalHeight||d.height||0},parsePreserveAspectRatioAttribute:function(){var _,p=w.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),d=this._element.width,a=this._element.height,c=1,s=1,f=0,g=0,l=0,v=0,b=this.width,S=this.height,T={width:b,height:S};return!p||"none"===p.alignX&&"none"===p.alignY?(c=b/d,s=S/a):("meet"===p.meetOrSlice&&(_=(b-d*(c=s=w.util.findScaleToFit(this._element,T)))/2,"Min"===p.alignX&&(f=-_),"Max"===p.alignX&&(f=_),_=(S-a*s)/2,"Min"===p.alignY&&(g=-_),"Max"===p.alignY&&(g=_)),"slice"===p.meetOrSlice&&(_=d-b/(c=s=w.util.findScaleToCover(this._element,T)),"Mid"===p.alignX&&(l=_/2),"Max"===p.alignX&&(l=_),_=a-S/s,"Mid"===p.alignY&&(v=_/2),"Max"===p.alignY&&(v=_),d=b/c,a=S/s)),{width:d,height:a,scaleX:c,scaleY:s,offsetLeft:f,offsetTop:g,cropX:l,cropY:v}}}),w.Image.CSS_CANVAS="canvas-img",w.Image.prototype.getSvgSrc=w.Image.prototype.getSrc,w.Image.fromObject=function(p,d){var a=w.util.object.clone(p);w.util.loadImage(a.src,function(c,s){s?d&&d(null,!0):w.Image.prototype._initFilters.call(a,a.filters,function(f){a.filters=f||[],w.Image.prototype._initFilters.call(a,[a.resizeFilter],function(g){a.resizeFilter=g[0],w.util.enlivenObjectEnlivables(a,a,function(){var l=new w.Image(c,a);d(l,!1)})})})},null,a.crossOrigin)},w.Image.fromURL=function(p,d,a){w.util.loadImage(p,function(c,s){d&&d(new w.Image(c,a),s)},null,a&&a.crossOrigin)},w.Image.ATTRIBUTE_NAMES=w.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),w.Image.fromElement=function(p,d,a){var c=w.parseAttributes(p,w.Image.ATTRIBUTE_NAMES);w.Image.fromURL(c["xlink:href"],d,h(a?w.util.object.clone(a):{},c))})}(Ie),w.util.object.extend(w.Object.prototype,{_getAngleValueForStraighten:function(){var y=this.angle%360;return y>0?90*Math.round((y-1)/90):90*Math.round(y/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(y){var h=function(){},p=(y=y||{}).onComplete||h,d=y.onChange||h,a=this;return w.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(c){a.rotate(c),d()},onComplete:function(){a.setCoords(),p()}})}}),w.util.object.extend(w.StaticCanvas.prototype,{straightenObject:function(y){return y.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(y){return y.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){"use strict";function y(p,d){var a="precision "+d+" float;\nvoid main(){}",c=p.createShader(p.FRAGMENT_SHADER);return p.shaderSource(c,a),p.compileShader(c),!!p.getShaderParameter(c,p.COMPILE_STATUS)}function h(p){p&&p.tileSize&&(this.tileSize=p.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}w.isWebglSupported=function(p){if(w.isLikelyNode)return!1;p=p||w.WebglFilterBackend.prototype.tileSize;var d=document.createElement("canvas"),a=d.getContext("webgl")||d.getContext("experimental-webgl"),c=!1;if(a){w.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE),c=w.maxTextureSize>=p;for(var s=["highp","mediump","lowp"],f=0;f<3;f++)if(y(a,s[f])){w.webGlPrecision=s[f];break}}return this.isSupported=c,c},w.WebglFilterBackend=h,h.prototype={tileSize:2048,resources:{},setupGLContext:function(p,d){this.dispose(),this.createWebGLCanvas(p,d),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(p,d)},chooseFastestCopyGLTo2DMethod:function(p,d){var c,a=typeof window.performance<"u";try{new ImageData(1,1),c=!0}catch{c=!1}var s=typeof ArrayBuffer<"u",f=typeof Uint8ClampedArray<"u";if(a&&c&&s&&f){var g=w.util.createCanvasElement(),l=new ArrayBuffer(p*d*4);if(w.forceGLPutImageData)return this.imageBuffer=l,void(this.copyGLTo2D=bi);var _,b,v={imageBuffer:l,destinationWidth:p,destinationHeight:d,targetCanvas:g};g.width=p,g.height=d,_=window.performance.now(),kt.call(v,this.gl,v),b=window.performance.now()-_,_=window.performance.now(),bi.call(v,this.gl,v),b>window.performance.now()-_?(this.imageBuffer=l,this.copyGLTo2D=bi):this.copyGLTo2D=kt}},createWebGLCanvas:function(p,d){var a=w.util.createCanvasElement();a.width=p,a.height=d;var c={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},s=a.getContext("webgl",c);s||(s=a.getContext("experimental-webgl",c)),s&&(s.clearColor(0,0,0,0),this.canvas=a,this.gl=s)},applyFilters:function(p,d,a,c,s,f){var l,g=this.gl;f&&(l=this.getCachedTexture(f,d));var v={originalWidth:d.width||d.originalWidth,originalHeight:d.height||d.originalHeight,sourceWidth:a,sourceHeight:c,destinationWidth:a,destinationHeight:c,context:g,sourceTexture:this.createTexture(g,a,c,!l&&d),targetTexture:this.createTexture(g,a,c),originalTexture:l||this.createTexture(g,a,c,!l&&d),passes:p.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},_=g.createFramebuffer();return g.bindFramebuffer(g.FRAMEBUFFER,_),p.forEach(function(b){b&&b.applyTo(v)}),function br(y){var h=y.targetCanvas,a=y.destinationWidth,c=y.destinationHeight;(h.width!==a||h.height!==c)&&(h.width=a,h.height=c)}(v),this.copyGLTo2D(g,v),g.bindTexture(g.TEXTURE_2D,null),g.deleteTexture(v.sourceTexture),g.deleteTexture(v.targetTexture),g.deleteFramebuffer(_),s.getContext("2d").setTransform(1,0,0,1,0,0),v},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(p,d,a,c,s){var f=p.createTexture();return p.bindTexture(p.TEXTURE_2D,f),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,s||p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,s||p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),c?p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,c):p.texImage2D(p.TEXTURE_2D,0,p.RGBA,d,a,0,p.RGBA,p.UNSIGNED_BYTE,null),f},getCachedTexture:function(p,d){if(this.textureCache[p])return this.textureCache[p];var a=this.createTexture(this.gl,d.width,d.height,d);return this.textureCache[p]=a,a},evictCachesForKey:function(p){this.textureCache[p]&&(this.gl.deleteTexture(this.textureCache[p]),delete this.textureCache[p])},copyGLTo2D:kt,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var p=this.gl,d={renderer:"",vendor:""};if(!p)return d;var a=p.getExtension("WEBGL_debug_renderer_info");if(a){var c=p.getParameter(a.UNMASKED_RENDERER_WEBGL),s=p.getParameter(a.UNMASKED_VENDOR_WEBGL);c&&(d.renderer=c.toLowerCase()),s&&(d.vendor=s.toLowerCase())}return this.gpuInfo=d,d}}}(),function(){"use strict";var y=function(){};function h(){}w.Canvas2dFilterBackend=h,h.prototype={evictCachesForKey:y,dispose:y,clearWebGLCaches:y,resources:{},applyFilters:function(p,d,a,c,s){var f=s.getContext("2d");f.drawImage(d,0,0,a,c);var v={sourceWidth:a,sourceHeight:c,imageData:f.getImageData(0,0,a,c),originalEl:d,originalImageData:f.getImageData(0,0,a,c),canvasEl:s,ctx:f,filterBackend:this};return p.forEach(function(_){_.applyTo(v)}),(v.imageData.width!==a||v.imageData.height!==c)&&(s.width=v.imageData.width,s.height=v.imageData.height),f.putImageData(v.imageData,0,0),v}}}(),w.Image=w.Image||{},w.Image.filters=w.Image.filters||{},w.Image.filters.BaseFilter=w.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(y){y&&this.setOptions(y)},setOptions:function(y){for(var h in y)this[h]=y[h]},createProgram:function(y,h,p){h=h||this.fragmentSource,p=p||this.vertexSource,"highp"!==w.webGlPrecision&&(h=h.replace(/precision highp float/g,"precision "+w.webGlPrecision+" float"));var d=y.createShader(y.VERTEX_SHADER);if(y.shaderSource(d,p),y.compileShader(d),!y.getShaderParameter(d,y.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+y.getShaderInfoLog(d));var a=y.createShader(y.FRAGMENT_SHADER);if(y.shaderSource(a,h),y.compileShader(a),!y.getShaderParameter(a,y.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+y.getShaderInfoLog(a));var c=y.createProgram();if(y.attachShader(c,d),y.attachShader(c,a),y.linkProgram(c),!y.getProgramParameter(c,y.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+y.getProgramInfoLog(c));var s=this.getAttributeLocations(y,c),f=this.getUniformLocations(y,c)||{};return f.uStepW=y.getUniformLocation(c,"uStepW"),f.uStepH=y.getUniformLocation(c,"uStepH"),{program:c,attributeLocations:s,uniformLocations:f}},getAttributeLocations:function(y,h){return{aPosition:y.getAttribLocation(h,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(y,h,p){var d=h.aPosition,a=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,a),y.enableVertexAttribArray(d),y.vertexAttribPointer(d,2,y.FLOAT,!1,0,0),y.bufferData(y.ARRAY_BUFFER,p,y.STATIC_DRAW)},_setupFrameBuffer:function(y){var p,d,h=y.context;y.passes>1?(d=y.destinationHeight,(y.sourceWidth!==(p=y.destinationWidth)||y.sourceHeight!==d)&&(h.deleteTexture(y.targetTexture),y.targetTexture=y.filterBackend.createTexture(h,p,d)),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,y.targetTexture,0)):(h.bindFramebuffer(h.FRAMEBUFFER,null),h.finish())},_swapTextures:function(y){y.passes--,y.pass++;var h=y.targetTexture;y.targetTexture=y.sourceTexture,y.sourceTexture=h},isNeutralState:function(){var y=this.mainParameter,h=w.Image.filters[this.type].prototype;if(y){if(Array.isArray(h[y])){for(var p=h[y].length;p--;)if(this[y][p]!==h[y][p])return!1;return!0}return h[y]===this[y]}return!1},applyTo:function(y){y.webgl?(this._setupFrameBuffer(y),this.applyToWebGL(y),this._swapTextures(y)):this.applyTo2d(y)},retrieveShader:function(y){return y.programCache.hasOwnProperty(this.type)||(y.programCache[this.type]=this.createProgram(y.context)),y.programCache[this.type]},applyToWebGL:function(y){var h=y.context,p=this.retrieveShader(y);h.bindTexture(h.TEXTURE_2D,0===y.pass&&y.originalTexture?y.originalTexture:y.sourceTexture),h.useProgram(p.program),this.sendAttributeData(h,p.attributeLocations,y.aPosition),h.uniform1f(p.uniformLocations.uStepW,1/y.sourceWidth),h.uniform1f(p.uniformLocations.uStepH,1/y.sourceHeight),this.sendUniformData(h,p.uniformLocations),h.viewport(0,0,y.destinationWidth,y.destinationHeight),h.drawArrays(h.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(y,h,p){y.activeTexture(p),y.bindTexture(y.TEXTURE_2D,h),y.activeTexture(y.TEXTURE0)},unbindAdditionalTexture:function(y,h){y.activeTexture(h),y.bindTexture(y.TEXTURE_2D,null),y.activeTexture(y.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(y){this[this.mainParameter]=y},sendUniformData:function(){},createHelpLayer:function(y){if(!y.helpLayer){var h=document.createElement("canvas");h.width=y.sourceWidth,h.height=y.sourceHeight,y.helpLayer=h}},toObject:function(){var y={type:this.type},h=this.mainParameter;return h&&(y[h]=this[h]),y},toJSON:function(){return this.toObject()}}),w.Image.filters.BaseFilter.fromObject=function(y,h){var p=new w.Image.filters[y.type](y);return h&&h(p),p},function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.ColorMatrix=(0,h.util.createClass)(p.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(a){this.callSuper("initialize",a),this.matrix=this.matrix.slice(0)},applyTo2d:function(a){var l,v,_,b,S,s=a.imageData.data,f=s.length,g=this.matrix,T=this.colorsOnly;for(S=0;S<f;S+=4)l=s[S],v=s[S+1],_=s[S+2],T?(s[S]=l*g[0]+v*g[1]+_*g[2]+255*g[4],s[S+1]=l*g[5]+v*g[6]+_*g[7]+255*g[9],s[S+2]=l*g[10]+v*g[11]+_*g[12]+255*g[14]):(s[S]=l*g[0]+v*g[1]+_*g[2]+(b=s[S+3])*g[3]+255*g[4],s[S+1]=l*g[5]+v*g[6]+_*g[7]+b*g[8]+255*g[9],s[S+2]=l*g[10]+v*g[11]+_*g[12]+b*g[13]+255*g[14],s[S+3]=l*g[15]+v*g[16]+_*g[17]+b*g[18]+255*g[19])},getUniformLocations:function(a,c){return{uColorMatrix:a.getUniformLocation(c,"uColorMatrix"),uConstants:a.getUniformLocation(c,"uConstants")}},sendUniformData:function(a,c){var s=this.matrix,g=[s[4],s[9],s[14],s[19]];a.uniformMatrix4fv(c.uColorMatrix,!1,[s[0],s[1],s[2],s[3],s[5],s[6],s[7],s[8],s[10],s[11],s[12],s[13],s[15],s[16],s[17],s[18]]),a.uniform4fv(c.uConstants,g)}}),h.Image.filters.ColorMatrix.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.Brightness=(0,h.util.createClass)(p.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(a){if(0!==this.brightness){var f,s=a.imageData.data,g=s.length,l=Math.round(255*this.brightness);for(f=0;f<g;f+=4)s[f]=s[f]+l,s[f+1]=s[f+1]+l,s[f+2]=s[f+2]+l}},getUniformLocations:function(a,c){return{uBrightness:a.getUniformLocation(c,"uBrightness")}},sendUniformData:function(a,c){a.uniform1f(c.uBrightness,this.brightness)}}),h.Image.filters.Brightness.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.object.extend,d=h.Image.filters;d.Convolute=(0,h.util.createClass)(d.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(c){var s=Math.sqrt(this.matrix.length),f=this.type+"_"+s+"_"+(this.opaque?1:0),g=this.fragmentSource[f];return c.programCache.hasOwnProperty(f)||(c.programCache[f]=this.createProgram(c.context,g)),c.programCache[f]},applyTo2d:function(c){var P,j,G,re,le,ge,pe,ce,fe,_e,ve,Ce,I,s=c.imageData,f=s.data,g=this.matrix,l=Math.round(Math.sqrt(g.length)),v=Math.floor(l/2),_=s.width,b=s.height,S=c.ctx.createImageData(_,b),T=S.data,M=this.opaque?1:0;for(ve=0;ve<b;ve++)for(_e=0;_e<_;_e++){for(le=4*(ve*_+_e),P=0,j=0,G=0,re=0,I=0;I<l;I++)for(Ce=0;Ce<l;Ce++)ge=_e+Ce-v,!((pe=ve+I-v)<0||pe>=b||ge<0||ge>=_)&&(P+=f[ce=4*(pe*_+ge)]*(fe=g[I*l+Ce]),j+=f[ce+1]*fe,G+=f[ce+2]*fe,M||(re+=f[ce+3]*fe));T[le]=P,T[le+1]=j,T[le+2]=G,T[le+3]=M?f[le+3]:re}c.imageData=S},getUniformLocations:function(c,s){return{uMatrix:c.getUniformLocation(s,"uMatrix"),uOpaque:c.getUniformLocation(s,"uOpaque"),uHalfSize:c.getUniformLocation(s,"uHalfSize"),uSize:c.getUniformLocation(s,"uSize")}},sendUniformData:function(c,s){c.uniform1fv(s.uMatrix,this.matrix)},toObject:function(){return p(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),h.Image.filters.Convolute.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.Grayscale=(0,h.util.createClass)(p.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(a){var f,l,s=a.imageData.data,g=s.length,v=this.mode;for(f=0;f<g;f+=4)"average"===v?l=(s[f]+s[f+1]+s[f+2])/3:"lightness"===v?l=(Math.min(s[f],s[f+1],s[f+2])+Math.max(s[f],s[f+1],s[f+2]))/2:"luminosity"===v&&(l=.21*s[f]+.72*s[f+1]+.07*s[f+2]),s[f]=l,s[f+1]=l,s[f+2]=l},retrieveShader:function(a){var c=this.type+"_"+this.mode;return a.programCache.hasOwnProperty(c)||(a.programCache[c]=this.createProgram(a.context,this.fragmentSource[this.mode])),a.programCache[c]},getUniformLocations:function(a,c){return{uMode:a.getUniformLocation(c,"uMode")}},sendUniformData:function(a,c){a.uniform1i(c.uMode,1)},isNeutralState:function(){return!1}}),h.Image.filters.Grayscale.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.Invert=(0,h.util.createClass)(p.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(a){var f,s=a.imageData.data,g=s.length;for(f=0;f<g;f+=4)s[f]=255-s[f],s[f+1]=255-s[f+1],s[f+2]=255-s[f+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(a,c){return{uInvert:a.getUniformLocation(c,"uInvert")}},sendUniformData:function(a,c){a.uniform1i(c.uInvert,this.invert)}}),h.Image.filters.Invert.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.object.extend,d=h.Image.filters;d.Noise=(0,h.util.createClass)(d.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(c){if(0!==this.noise){var g,l,_,f=c.imageData.data,v=this.noise;for(g=0,l=f.length;g<l;g+=4)_=(.5-Math.random())*v,f[g]+=_,f[g+1]+=_,f[g+2]+=_}},getUniformLocations:function(c,s){return{uNoise:c.getUniformLocation(s,"uNoise"),uSeed:c.getUniformLocation(s,"uSeed")}},sendUniformData:function(c,s){c.uniform1f(s.uNoise,this.noise/255),c.uniform1f(s.uSeed,Math.random())},toObject:function(){return p(this.callSuper("toObject"),{noise:this.noise})}}),h.Image.filters.Noise.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.Pixelate=(0,h.util.createClass)(p.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(a){var l,v,_,b,S,T,M,P,j,G,re,c=a.imageData,s=c.data,f=c.height,g=c.width;for(v=0;v<f;v+=this.blocksize)for(_=0;_<g;_+=this.blocksize)for(b=s[l=4*v*g+4*_],S=s[l+1],T=s[l+2],M=s[l+3],G=Math.min(v+this.blocksize,f),re=Math.min(_+this.blocksize,g),P=v;P<G;P++)for(j=_;j<re;j++)s[l=4*P*g+4*j]=b,s[l+1]=S,s[l+2]=T,s[l+3]=M},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(a,c){return{uBlocksize:a.getUniformLocation(c,"uBlocksize"),uStepW:a.getUniformLocation(c,"uStepW"),uStepH:a.getUniformLocation(c,"uStepH")}},sendUniformData:function(a,c){a.uniform1f(c.uBlocksize,this.blocksize)}}),h.Image.filters.Pixelate.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.object.extend,d=h.Image.filters;d.RemoveColor=(0,h.util.createClass)(d.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(c){var g,v,_,b,f=c.imageData.data,l=255*this.distance,S=new h.Color(this.color).getSource(),T=[S[0]-l,S[1]-l,S[2]-l],M=[S[0]+l,S[1]+l,S[2]+l];for(g=0;g<f.length;g+=4)_=f[g+1],b=f[g+2],(v=f[g])>T[0]&&_>T[1]&&b>T[2]&&v<M[0]&&_<M[1]&&b<M[2]&&(f[g+3]=0)},getUniformLocations:function(c,s){return{uLow:c.getUniformLocation(s,"uLow"),uHigh:c.getUniformLocation(s,"uHigh")}},sendUniformData:function(c,s){var f=new h.Color(this.color).getSource(),g=parseFloat(this.distance),v=[f[0]/255+g,f[1]/255+g,f[2]/255+g,1];c.uniform4fv(s.uLow,[0+f[0]/255-g,0+f[1]/255-g,0+f[2]/255-g,1]),c.uniform4fv(s.uHigh,v)},toObject:function(){return p(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),h.Image.filters.RemoveColor.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters,d=h.util.createClass,a={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var c in a)p[c]=d(p.ColorMatrix,{type:c,matrix:a[c],mainParameter:!1,colorsOnly:!0}),h.Image.filters[c].fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric,p=h.Image.filters;p.BlendColor=(0,h.util.createClass)(p.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(a){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[a]+"}\n}"},retrieveShader:function(a){var s,c=this.type+"_"+this.mode;return a.programCache.hasOwnProperty(c)||(s=this.buildSource(this.mode),a.programCache[c]=this.createProgram(a.context,s)),a.programCache[c]},applyTo2d:function(a){var g,l,v,_,b,S,T,s=a.imageData.data,f=s.length,M=1-this.alpha;g=(T=new h.Color(this.color).getSource())[0]*this.alpha,l=T[1]*this.alpha,v=T[2]*this.alpha;for(var P=0;P<f;P+=4)switch(_=s[P],b=s[P+1],S=s[P+2],this.mode){case"multiply":s[P]=_*g/255,s[P+1]=b*l/255,s[P+2]=S*v/255;break;case"screen":s[P]=255-(255-_)*(255-g)/255,s[P+1]=255-(255-b)*(255-l)/255,s[P+2]=255-(255-S)*(255-v)/255;break;case"add":s[P]=_+g,s[P+1]=b+l,s[P+2]=S+v;break;case"diff":case"difference":s[P]=Math.abs(_-g),s[P+1]=Math.abs(b-l),s[P+2]=Math.abs(S-v);break;case"subtract":s[P]=_-g,s[P+1]=b-l,s[P+2]=S-v;break;case"darken":s[P]=Math.min(_,g),s[P+1]=Math.min(b,l),s[P+2]=Math.min(S,v);break;case"lighten":s[P]=Math.max(_,g),s[P+1]=Math.max(b,l),s[P+2]=Math.max(S,v);break;case"overlay":s[P]=g<128?2*_*g/255:255-2*(255-_)*(255-g)/255,s[P+1]=l<128?2*b*l/255:255-2*(255-b)*(255-l)/255,s[P+2]=v<128?2*S*v/255:255-2*(255-S)*(255-v)/255;break;case"exclusion":s[P]=g+_-2*g*_/255,s[P+1]=l+b-2*l*b/255,s[P+2]=v+S-2*v*S/255;break;case"tint":s[P]=g+_*M,s[P+1]=l+b*M,s[P+2]=v+S*M}},getUniformLocations:function(a,c){return{uColor:a.getUniformLocation(c,"uColor")}},sendUniformData:function(a,c){var s=new h.Color(this.color).getSource();s[0]=this.alpha*s[0]/255,s[1]=this.alpha*s[1]/255,s[2]=this.alpha*s[2]/255,s[3]=this.alpha,a.uniform4fv(c.uColor,s)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),h.Image.filters.BlendColor.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric,p=h.Image.filters;p.BlendImage=(0,h.util.createClass)(p.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(a){var c=this.type+"_"+this.mode,s=this.fragmentSource[this.mode];return a.programCache.hasOwnProperty(c)||(a.programCache[c]=this.createProgram(a.context,s)),a.programCache[c]},applyToWebGL:function(a){var c=a.context,s=this.createTexture(a.filterBackend,this.image);this.bindAdditionalTexture(c,s,c.TEXTURE1),this.callSuper("applyToWebGL",a),this.unbindAdditionalTexture(c,c.TEXTURE1)},createTexture:function(a,c){return a.getCachedTexture(c.cacheKey,c._element)},calculateMatrix:function(){var a=this.image;return[1/a.scaleX,0,0,0,1/a.scaleY,0,-a.left/a._element.width,-a.top/a._element.height,1]},applyTo2d:function(a){var _,b,S,T,M,P,j,G,re,le,pe,c=a.imageData,s=a.filterBackend.resources,f=c.data,g=f.length,l=c.width,v=c.height,ge=this.image;s.blendImage||(s.blendImage=h.util.createCanvasElement()),le=(re=s.blendImage).getContext("2d"),re.width!==l||re.height!==v?(re.width=l,re.height=v):le.clearRect(0,0,l,v),le.setTransform(ge.scaleX,0,0,ge.scaleY,ge.left,ge.top),le.drawImage(ge._element,0,0,l,v),pe=le.getImageData(0,0,l,v).data;for(var ce=0;ce<g;ce+=4)switch(M=f[ce],P=f[ce+1],j=f[ce+2],G=f[ce+3],_=pe[ce],b=pe[ce+1],S=pe[ce+2],T=pe[ce+3],this.mode){case"multiply":f[ce]=M*_/255,f[ce+1]=P*b/255,f[ce+2]=j*S/255,f[ce+3]=G*T/255;break;case"mask":f[ce+3]=T}},getUniformLocations:function(a,c){return{uTransformMatrix:a.getUniformLocation(c,"uTransformMatrix"),uImage:a.getUniformLocation(c,"uImage")}},sendUniformData:function(a,c){var s=this.calculateMatrix();a.uniform1i(c.uImage,1),a.uniformMatrix3fv(c.uTransformMatrix,!1,s)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),h.Image.filters.BlendImage.fromObject=function(a,c){h.Image.fromObject(a.image,function(s){var f=h.util.object.clone(a);f.image=s,c(new h.Image.filters.BlendImage(f))})}}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=Math.pow,d=Math.floor,a=Math.sqrt,c=Math.abs,s=Math.round,f=Math.sin,g=Math.ceil,l=h.Image.filters;l.Resize=(0,h.util.createClass)(l.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(_,b){return{uDelta:_.getUniformLocation(b,"uDelta"),uTaps:_.getUniformLocation(b,"uTaps")}},sendUniformData:function(_,b){_.uniform2fv(b.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),_.uniform1fv(b.uTaps,this.taps)},retrieveShader:function(_){var b=this.getFilterWindow(),S=this.type+"_"+b;if(!_.programCache.hasOwnProperty(S)){var T=this.generateShader(b);_.programCache[S]=this.createProgram(_.context,T)}return _.programCache[S]},getFilterWindow:function(){return Math.ceil(this.lanczosLobes/this.tempScale)},getTaps:function(){for(var _=this.lanczosCreate(this.lanczosLobes),b=this.tempScale,S=this.getFilterWindow(),T=new Array(S),M=1;M<=S;M++)T[M-1]=_(M*b);return T},generateShader:function(T){for(var b=new Array(T),S=this.fragmentSourceTOP,M=1;M<=T;M++)b[M-1]=M+".0 * uDelta";return S+="uniform float uTaps["+T+"];\n",S+="void main() {\n",S+="  vec4 color = texture2D(uTexture, vTexCoord);\n",S+="  float sum = 1.0;\n",b.forEach(function(P,j){S+="  color += texture2D(uTexture, vTexCoord + "+P+") * uTaps["+j+"];\n",S+="  color += texture2D(uTexture, vTexCoord - "+P+") * uTaps["+j+"];\n",S+="  sum += 2.0 * uTaps["+j+"];\n"}),S+="  gl_FragColor = color / sum;\n",S+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(_){_.webgl?(_.passes++,this.width=_.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=_.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),_.destinationWidth=this.dW,this._setupFrameBuffer(_),this.applyToWebGL(_),this._swapTextures(_),_.sourceWidth=_.destinationWidth,this.height=_.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),_.destinationHeight=this.dH,this._setupFrameBuffer(_),this.applyToWebGL(_),this._swapTextures(_),_.sourceHeight=_.destinationHeight):this.applyTo2d(_)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(_){return function(b){if(b>=_||b<=-_)return 0;if(b<1.1920929e-7&&b>-1.1920929e-7)return 1;var S=(b*=Math.PI)/_;return f(b)/b*f(S)/S}},applyTo2d:function(_){var b=_.imageData,S=this.scaleX,T=this.scaleY;this.rcpScaleX=1/S,this.rcpScaleY=1/T;var re,M=b.width,P=b.height,j=s(M*S),G=s(P*T);"sliceHack"===this.resizeType?re=this.sliceByTwo(_,M,P,j,G):"hermite"===this.resizeType?re=this.hermiteFastResize(_,M,P,j,G):"bilinear"===this.resizeType?re=this.bilinearFiltering(_,M,P,j,G):"lanczos"===this.resizeType&&(re=this.lanczosResize(_,M,P,j,G)),_.imageData=re},sliceByTwo:function(_,b,S,T,M){var ce,fe,P=_.imageData,j=.5,G=!1,re=!1,le=b*j,ge=S*j,pe=h.filterBackend.resources,_e=0,ve=0,Ce=b,I=0;for(pe.sliceByTwo||(pe.sliceByTwo=document.createElement("canvas")),((ce=pe.sliceByTwo).width<1.5*b||ce.height<S)&&(ce.width=1.5*b,ce.height=S),(fe=ce.getContext("2d")).clearRect(0,0,1.5*b,S),fe.putImageData(P,0,0),T=d(T),M=d(M);!G||!re;)b=le,S=ge,T<d(le*j)?le=d(le*j):(le=T,G=!0),M<d(ge*j)?ge=d(ge*j):(ge=M,re=!0),fe.drawImage(ce,_e,ve,b,S,Ce,I,le,ge),_e=Ce,ve=I,I+=ge;return fe.getImageData(_e,ve,T,M)},lanczosResize:function(_,b,S,T,M){var j=_.imageData.data,G=_.ctx.createImageData(T,M),re=G.data,le=this.lanczosCreate(this.lanczosLobes),ge=this.rcpScaleX,pe=this.rcpScaleY,ce=2/this.rcpScaleX,fe=2/this.rcpScaleY,_e=g(ge*this.lanczosLobes/2),ve=g(pe*this.lanczosLobes/2),Ce={},I={},N={};return function P(L){var R,$,F,O,B,U,K,W,te,oe,he;for(I.x=(L+.5)*ge,N.x=d(I.x),R=0;R<M;R++){for(I.y=(R+.5)*pe,N.y=d(I.y),B=0,U=0,K=0,W=0,te=0,$=N.x-_e;$<=N.x+_e;$++)if(!($<0||$>=b)){oe=d(1e3*c($-I.x)),Ce[oe]||(Ce[oe]={});for(var Y=N.y-ve;Y<=N.y+ve;Y++)Y<0||Y>=S||(he=d(1e3*c(Y-I.y)),Ce[oe][he]||(Ce[oe][he]=le(a(p(oe*ce,2)+p(he*fe,2))/1e3)),(F=Ce[oe][he])>0&&(B+=F,U+=F*j[O=4*(Y*b+$)],K+=F*j[O+1],W+=F*j[O+2],te+=F*j[O+3]))}re[O=4*(R*T+L)]=U/B,re[O+1]=K/B,re[O+2]=W/B,re[O+3]=te/B}return++L<T?P(L):G}(0)},bilinearFiltering:function(_,b,S,T,M){var le,ge,pe,ce,fe,_e,ve,N,I=0,L=this.rcpScaleX,R=this.rcpScaleY,$=4*(b-1),O=_.imageData.data,B=_.ctx.createImageData(T,M),U=B.data;for(pe=0;pe<M;pe++)for(ce=0;ce<T;ce++)for(fe=L*ce-(le=d(L*ce)),_e=R*pe-(ge=d(R*pe)),N=4*(ge*b+le),ve=0;ve<4;ve++)U[I++]=O[N+ve]*(1-fe)*(1-_e)+O[N+4+ve]*fe*(1-_e)+O[N+$+ve]*_e*(1-fe)+O[N+$+4+ve]*fe*_e;return B},hermiteFastResize:function(_,b,S,T,M){for(var P=this.rcpScaleX,j=this.rcpScaleY,G=g(P/2),re=g(j/2),ge=_.imageData.data,pe=_.ctx.createImageData(T,M),ce=pe.data,fe=0;fe<M;fe++)for(var _e=0;_e<T;_e++){for(var ve=4*(_e+fe*T),Ce=0,I=0,N=0,L=0,R=0,$=0,F=0,O=(fe+.5)*j,B=d(fe*j);B<(fe+1)*j;B++)for(var U=c(O-(B+.5))/re,K=(_e+.5)*P,W=U*U,te=d(_e*P);te<(_e+1)*P;te++){var oe=c(K-(te+.5))/G,he=a(W+oe*oe);he>1&&he<-1||(Ce=2*he*he*he-3*he*he+1)>0&&(F+=Ce*ge[3+(oe=4*(te+B*b))],N+=Ce,ge[oe+3]<255&&(Ce=Ce*ge[oe+3]/250),L+=Ce*ge[oe],R+=Ce*ge[oe+1],$+=Ce*ge[oe+2],I+=Ce)}ce[ve]=L/I,ce[ve+1]=R/I,ce[ve+2]=$/I,ce[ve+3]=F/N}return pe},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),h.Image.filters.Resize.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.Contrast=(0,h.util.createClass)(p.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(a){if(0!==this.contrast){var s,f=a.imageData.data,g=f.length,l=Math.floor(255*this.contrast),v=259*(l+255)/(255*(259-l));for(s=0;s<g;s+=4)f[s]=v*(f[s]-128)+128,f[s+1]=v*(f[s+1]-128)+128,f[s+2]=v*(f[s+2]-128)+128}},getUniformLocations:function(a,c){return{uContrast:a.getUniformLocation(c,"uContrast")}},sendUniformData:function(a,c){a.uniform1f(c.uContrast,this.contrast)}}),h.Image.filters.Contrast.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.Saturation=(0,h.util.createClass)(p.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(a){if(0!==this.saturation){var l,v,s=a.imageData.data,f=s.length,g=-this.saturation;for(l=0;l<f;l+=4)v=Math.max(s[l],s[l+1],s[l+2]),s[l]+=v!==s[l]?(v-s[l])*g:0,s[l+1]+=v!==s[l+1]?(v-s[l+1])*g:0,s[l+2]+=v!==s[l+2]?(v-s[l+2])*g:0}},getUniformLocations:function(a,c){return{uSaturation:a.getUniformLocation(c,"uSaturation")}},sendUniformData:function(a,c){a.uniform1f(c.uSaturation,-this.saturation)}}),h.Image.filters.Saturation.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.Vibrance=(0,h.util.createClass)(p.BaseFilter,{type:"Vibrance",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uVibrance;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat max = max(color.r, max(color.g, color.b));\nfloat avg = (color.r + color.g + color.b) / 3.0;\nfloat amt = (abs(max - avg) * 2.0) * uVibrance;\ncolor.r += max != color.r ? (max - color.r) * amt : 0.00;\ncolor.g += max != color.g ? (max - color.g) * amt : 0.00;\ncolor.b += max != color.b ? (max - color.b) * amt : 0.00;\ngl_FragColor = color;\n}",vibrance:0,mainParameter:"vibrance",applyTo2d:function(a){if(0!==this.vibrance){var l,v,b,s=a.imageData.data,f=s.length,g=-this.vibrance;for(l=0;l<f;l+=4)v=Math.max(s[l],s[l+1],s[l+2]),b=2*Math.abs(v-(s[l]+s[l+1]+s[l+2])/3)/255*g,s[l]+=v!==s[l]?(v-s[l])*b:0,s[l+1]+=v!==s[l+1]?(v-s[l+1])*b:0,s[l+2]+=v!==s[l+2]?(v-s[l+2])*b:0}},getUniformLocations:function(a,c){return{uVibrance:a.getUniformLocation(c,"uVibrance")}},sendUniformData:function(a,c){a.uniform1f(c.uVibrance,-this.vibrance)}}),h.Image.filters.Vibrance.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.Blur=(0,h.util.createClass)(p.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(a){a.webgl?(this.aspectRatio=a.sourceWidth/a.sourceHeight,a.passes++,this._setupFrameBuffer(a),this.horizontal=!0,this.applyToWebGL(a),this._swapTextures(a),this._setupFrameBuffer(a),this.horizontal=!1,this.applyToWebGL(a),this._swapTextures(a)):this.applyTo2d(a)},applyTo2d:function(a){a.imageData=this.simpleBlur(a)},simpleBlur:function(a){var s,f,c=a.filterBackend.resources,g=a.imageData.width,l=a.imageData.height;c.blurLayer1||(c.blurLayer1=h.util.createCanvasElement(),c.blurLayer2=h.util.createCanvasElement()),f=c.blurLayer2,((s=c.blurLayer1).width!==g||s.height!==l)&&(f.width=s.width=g,f.height=s.height=l);var S,T,M,P,v=s.getContext("2d"),_=f.getContext("2d"),b=15,j=.06*this.blur*.5;for(v.putImageData(a.imageData,0,0),_.clearRect(0,0,g,l),P=-b;P<=b;P++)M=j*(T=P/b)*g+(S=(Math.random()-.5)/4),_.globalAlpha=1-Math.abs(T),_.drawImage(s,M,S),v.drawImage(f,0,0),_.globalAlpha=1,_.clearRect(0,0,f.width,f.height);for(P=-b;P<=b;P++)M=j*(T=P/b)*l+(S=(Math.random()-.5)/4),_.globalAlpha=1-Math.abs(T),_.drawImage(s,S,M),v.drawImage(f,0,0),_.globalAlpha=1,_.clearRect(0,0,f.width,f.height);a.ctx.drawImage(s,0,0);var G=a.ctx.getImageData(0,0,s.width,s.height);return v.globalAlpha=1,v.clearRect(0,0,s.width,s.height),G},getUniformLocations:function(a,c){return{delta:a.getUniformLocation(c,"uDelta")}},sendUniformData:function(a,c){var s=this.chooseRightDelta();a.uniform2fv(c.delta,s)},chooseRightDelta:function(){var s,a=1,c=[0,0];return this.horizontal?this.aspectRatio>1&&(a=1/this.aspectRatio):this.aspectRatio<1&&(a=this.aspectRatio),s=a*this.blur*.12,this.horizontal?c[0]=s:c[1]=s,c}}),p.Blur.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.Gamma=(0,h.util.createClass)(p.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(a){this.gamma=[1,1,1],p.BaseFilter.prototype.initialize.call(this,a)},applyTo2d:function(a){var b,s=a.imageData.data,f=this.gamma,g=s.length,l=1/f[0],v=1/f[1],_=1/f[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),b=0,g=256;b<g;b++)this.rVals[b]=255*Math.pow(b/255,l),this.gVals[b]=255*Math.pow(b/255,v),this.bVals[b]=255*Math.pow(b/255,_);for(b=0,g=s.length;b<g;b+=4)s[b]=this.rVals[s[b]],s[b+1]=this.gVals[s[b+1]],s[b+2]=this.bVals[s[b+2]]},getUniformLocations:function(a,c){return{uGamma:a.getUniformLocation(c,"uGamma")}},sendUniformData:function(a,c){a.uniform3fv(c.uGamma,this.gamma)}}),h.Image.filters.Gamma.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.Composed=(0,h.util.createClass)(p.BaseFilter,{type:"Composed",subFilters:[],initialize:function(a){this.callSuper("initialize",a),this.subFilters=this.subFilters.slice(0)},applyTo:function(a){a.passes+=this.subFilters.length-1,this.subFilters.forEach(function(c){c.applyTo(a)})},toObject:function(){return h.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(a){return a.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(a){return!a.isNeutralState()})}}),h.Image.filters.Composed.fromObject=function(a,c){var f=(a.subFilters||[]).map(function(l){return new h.Image.filters[l.type](l)}),g=new h.Image.filters.Composed({subFilters:f});return c&&c(g),g}}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.Image.filters;p.HueRotation=(0,h.util.createClass)(p.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var a=this.rotation*Math.PI,c=h.util.cos(a),s=h.util.sin(a),f=1/3,g=Math.sqrt(f)*s,l=1-c;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=c+l/3,this.matrix[1]=f*l-g,this.matrix[2]=f*l+g,this.matrix[5]=f*l+g,this.matrix[6]=c+f*l,this.matrix[7]=f*l-g,this.matrix[10]=f*l-g,this.matrix[11]=f*l+g,this.matrix[12]=c+f*l},isNeutralState:function(a){return this.calculateMatrix(),p.BaseFilter.prototype.isNeutralState.call(this,a)},applyTo:function(a){this.calculateMatrix(),p.BaseFilter.prototype.applyTo.call(this,a)}}),h.Image.filters.HueRotation.fromObject=h.Image.filters.BaseFilter.fromObject}(Ie),function(y){"use strict";var h=y.fabric||(y.fabric={}),p=h.util.object.clone;if(h.Text)h.warn("fabric.Text is already defined");else{var d="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");h.Text=h.util.createClass(h.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:h.Object.prototype.stateProperties.concat(d),cacheProperties:h.Object.prototype.cacheProperties.concat(d),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(a,c){this.styles=c&&c.styles||{},this.text=a,this.__skipDimension=!0,this.callSuper("initialize",c),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var a=this.path;a&&(a.segmentsInfo=h.util.getPathSegmentsInfo(a.path))},getMeasuringContext:function(){return h._measuringContext||(h._measuringContext=this.canvas&&this.canvas.contextCache||h.util.createCanvasElement().getContext("2d")),h._measuringContext},_splitText:function(){var a=this._splitTextIntoLines(this.text);return this.textLines=a.lines,this._textLines=a.graphemeLines,this._unwrappedTextLines=a._unwrappedLines,this._text=a.graphemeText,a},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var a,c,f,g,l,v,_=0,b=this._textLines.length;_<b;_++)if(("justify"===this.textAlign||_!==b-1&&!this.isEndOfWrapping(_))&&(f=0,g=this._textLines[_],(c=this.getLineWidth(_))<this.width&&(v=this.textLines[_].match(this._reSpacesAndTabs)))){a=(this.width-c)/v.length;for(var S=0,T=g.length;S<=T;S++)l=this.__charBounds[_][S],this._reSpaceAndTab.test(g[S])?(l.width+=a,l.kernedWidth+=a,l.left+=f,f+=a):l.left+=f}},isEndOfWrapping:function(a){return a===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var a=this.callSuper("_getCacheCanvasDimensions"),c=this.fontSize;return a.width+=c*a.zoomX,a.height+=c*a.zoomY,a},_render:function(a){var c=this.path;c&&!c.isNotVisible()&&c._render(a),this._setTextStyles(a),this._renderTextLinesBackground(a),this._renderTextDecoration(a,"underline"),this._renderText(a),this._renderTextDecoration(a,"overline"),this._renderTextDecoration(a,"linethrough")},_renderText:function(a){"stroke"===this.paintFirst?(this._renderTextStroke(a),this._renderTextFill(a)):(this._renderTextFill(a),this._renderTextStroke(a))},_setTextStyles:function(a,c,s){if(a.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":a.textBaseline="middle";break;case"ascender":a.textBaseline="top";break;case"descender":a.textBaseline="bottom"}a.font=this._getFontDeclaration(c,s)},calcTextWidth:function(){for(var a=this.getLineWidth(0),c=1,s=this._textLines.length;c<s;c++){var f=this.getLineWidth(c);f>a&&(a=f)}return a},_renderTextLine:function(a,c,s,f,g,l){this._renderChars(a,c,s,f,g,l)},_renderTextLinesBackground:function(a){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var c,s,g,l,T,M,j,f=a.fillStyle,v=this._getLeftOffset(),_=this._getTopOffset(),b=0,S=0,P=this.path,G=0,re=this._textLines.length;G<re;G++)if(c=this.getHeightOfLine(G),this.textBackgroundColor||this.styleHas("textBackgroundColor",G)){g=this._textLines[G],s=this._getLineLeftOffset(G),S=0,b=0,l=this.getValueOfPropertyAt(G,0,"textBackgroundColor");for(var le=0,ge=g.length;le<ge;le++)T=this.__charBounds[G][le],M=this.getValueOfPropertyAt(G,le,"textBackgroundColor"),P?(a.save(),a.translate(T.renderLeft,T.renderTop),a.rotate(T.angle),a.fillStyle=M,M&&a.fillRect(-T.width/2,-c/this.lineHeight*(1-this._fontSizeFraction),T.width,c/this.lineHeight),a.restore()):M!==l?(j=v+s+b,"rtl"===this.direction&&(j=this.width-j-S),a.fillStyle=l,l&&a.fillRect(j,_,S,c/this.lineHeight),b=T.left,S=T.width,l=M):S+=T.kernedWidth;M&&!P&&(j=v+s+b,"rtl"===this.direction&&(j=this.width-j-S),a.fillStyle=M,a.fillRect(j,_,S,c/this.lineHeight)),_+=c}else _+=c;a.fillStyle=f,this._removeShadow(a)}},getFontCache:function(a){var c=a.fontFamily.toLowerCase();h.charWidthsCache[c]||(h.charWidthsCache[c]={});var s=h.charWidthsCache[c],f=a.fontStyle.toLowerCase()+"_"+(a.fontWeight+"").toLowerCase();return s[f]||(s[f]={}),s[f]},_measureChar:function(a,c,s,f){var S,T,M,j,g=this.getFontCache(c),_=s+a,b=this._getFontDeclaration(c)===this._getFontDeclaration(f),P=c.fontSize/this.CACHE_FONT_SIZE;if(s&&void 0!==g[s]&&(M=g[s]),void 0!==g[a]&&(j=S=g[a]),b&&void 0!==g[_]&&(j=(T=g[_])-M),void 0===S||void 0===M||void 0===T){var G=this.getMeasuringContext();this._setTextStyles(G,c,!0)}return void 0===S&&(j=S=G.measureText(a).width,g[a]=S),void 0===M&&b&&s&&(M=G.measureText(s).width,g[s]=M),b&&void 0===T&&(T=G.measureText(_).width,g[_]=T,j=T-M),{width:S*P,kernedWidth:j*P}},getHeightOfChar:function(a,c){return this.getValueOfPropertyAt(a,c,"fontSize")},measureLine:function(a){var c=this._measureLine(a);return 0!==this.charSpacing&&(c.width-=this._getWidthOfCharSpacing()),c.width<0&&(c.width=0),c},_measureLine:function(a){var s,f,l,v,T,M,c=0,g=this._textLines[a],b=new Array(g.length),S=0,P=this.path,j="right"===this.pathSide;for(this.__charBounds[a]=b,s=0;s<g.length;s++)v=this._getGraphemeBox(f=g[s],a,s,l),b[s]=v,c+=v.kernedWidth,l=f;if(b[s]={left:v?v.left+v.width:0,width:0,kernedWidth:0,height:this.fontSize},P){switch(M=P.segmentsInfo[P.segmentsInfo.length-1].length,(T=h.util.getPointOnPath(P.path,0,P.segmentsInfo)).x+=P.pathOffset.x,T.y+=P.pathOffset.y,this.textAlign){case"left":S=j?M-c:0;break;case"center":S=(M-c)/2;break;case"right":S=j?0:M-c}for(S+=this.pathStartOffset*(j?-1:1),s=j?g.length-1:0;j?s>=0:s<g.length;j?s--:s++)S>M?S%=M:S<0&&(S+=M),this._setGraphemeOnPath(S,v=b[s],T),S+=v.kernedWidth}return{width:c,numOfSpaces:0}},_setGraphemeOnPath:function(a,c,s){var g=this.path,l=h.util.getPointOnPath(g.path,a+c.kernedWidth/2,g.segmentsInfo);c.renderLeft=l.x-s.x,c.renderTop=l.y-s.y,c.angle=l.angle+("right"===this.pathSide?Math.PI:0)},_getGraphemeBox:function(a,c,s,f,g){var T,l=this.getCompleteStyleDeclaration(c,s),v=f?this.getCompleteStyleDeclaration(c,s-1):{},_=this._measureChar(a,l,f,v),b=_.kernedWidth,S=_.width;0!==this.charSpacing&&(S+=T=this._getWidthOfCharSpacing(),b+=T);var M={width:S,left:0,height:l.fontSize,kernedWidth:b,deltaY:l.deltaY};if(s>0&&!g){var P=this.__charBounds[c][s-1];M.left=P.left+P.width+_.kernedWidth-_.width}return M},getHeightOfLine:function(a){if(this.__lineHeights[a])return this.__lineHeights[a];for(var c=this._textLines[a],s=this.getHeightOfChar(a,0),f=1,g=c.length;f<g;f++)s=Math.max(this.getHeightOfChar(a,f),s);return this.__lineHeights[a]=s*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var a,c=0,s=0,f=this._textLines.length;s<f;s++)a=this.getHeightOfLine(s),c+=s===f-1?a/this.lineHeight:a;return c},_getLeftOffset:function(){return"ltr"===this.direction?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(a,c){a.save();for(var s=0,f=this._getLeftOffset(),g=this._getTopOffset(),l=0,v=this._textLines.length;l<v;l++){var _=this.getHeightOfLine(l),b=_/this.lineHeight,S=this._getLineLeftOffset(l);this._renderTextLine(c,a,this._textLines[l],f+S,g+s+b,l),s+=_}a.restore()},_renderTextFill:function(a){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(a,"fillText")},_renderTextStroke:function(a){(!this.stroke||0===this.strokeWidth)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a),a.save(),this._setLineDash(a,this.strokeDashArray),a.beginPath(),this._renderTextCommon(a,"strokeText"),a.closePath(),a.restore())},_renderChars:function(a,c,s,f,g,l){var b,S,M,j,v=this.getHeightOfLine(l),_=-1!==this.textAlign.indexOf("justify"),T="",P=0,G=this.path,re=!_&&0===this.charSpacing&&this.isEmptyStyles(l)&&!G,le="ltr"===this.direction,ge="ltr"===this.direction?1:-1,ce=c.canvas.getAttribute("dir");if(c.save(),ce!==this.direction&&(c.canvas.setAttribute("dir",le?"ltr":"rtl"),c.direction=le?"ltr":"rtl",c.textAlign=le?"left":"right"),g-=v*this._fontSizeFraction/this.lineHeight,re)return this._renderChar(a,c,l,0,s.join(""),f,g,v),void c.restore();for(var fe=0,_e=s.length-1;fe<=_e;fe++)j=fe===_e||this.charSpacing||G,T+=s[fe],M=this.__charBounds[l][fe],0===P?(f+=ge*(M.kernedWidth-M.width),P+=M.width):P+=M.kernedWidth,_&&!j&&this._reSpaceAndTab.test(s[fe])&&(j=!0),j||(b=b||this.getCompleteStyleDeclaration(l,fe),S=this.getCompleteStyleDeclaration(l,fe+1),j=h.util.hasStyleChanged(b,S,!1)),j&&(G?(c.save(),c.translate(M.renderLeft,M.renderTop),c.rotate(M.angle),this._renderChar(a,c,l,fe,T,-P/2,0,v),c.restore()):this._renderChar(a,c,l,fe,T,f,g,v),T="",b=S,f+=ge*P,P=0);c.restore()},_applyPatternGradientTransformText:function(a){var s,c=h.util.createCanvasElement(),f=this.width+this.strokeWidth,g=this.height+this.strokeWidth;return c.width=f,c.height=g,(s=c.getContext("2d")).beginPath(),s.moveTo(0,0),s.lineTo(f,0),s.lineTo(f,g),s.lineTo(0,g),s.closePath(),s.translate(f/2,g/2),s.fillStyle=a.toLive(s),this._applyPatternGradientTransform(s,a),s.fill(),s.createPattern(c,"no-repeat")},handleFiller:function(a,c,s){var f,g;return s.toLive?"percentage"===s.gradientUnits||s.gradientTransform||s.patternTransform?(a.translate(f=-this.width/2,g=-this.height/2),a[c]=this._applyPatternGradientTransformText(s),{offsetX:f,offsetY:g}):(a[c]=s.toLive(a,this),this._applyPatternGradientTransform(a,s)):(a[c]=s,{offsetX:0,offsetY:0})},_setStrokeStyles:function(a,c){return a.lineWidth=c.strokeWidth,a.lineCap=this.strokeLineCap,a.lineDashOffset=this.strokeDashOffset,a.lineJoin=this.strokeLineJoin,a.miterLimit=this.strokeMiterLimit,this.handleFiller(a,"strokeStyle",c.stroke)},_setFillStyles:function(a,c){return this.handleFiller(a,"fillStyle",c.fill)},_renderChar:function(a,c,s,f,g,l,v){var M,P,_=this._getStyleDeclaration(s,f),b=this.getCompleteStyleDeclaration(s,f),S="fillText"===a&&b.fill,T="strokeText"===a&&b.stroke&&b.strokeWidth;!T&&!S||(c.save(),S&&(M=this._setFillStyles(c,b)),T&&(P=this._setStrokeStyles(c,b)),c.font=this._getFontDeclaration(b),_&&_.textBackgroundColor&&this._removeShadow(c),_&&_.deltaY&&(v+=_.deltaY),S&&c.fillText(g,l-M.offsetX,v-M.offsetY),T&&c.strokeText(g,l-P.offsetX,v-P.offsetY),c.restore())},setSuperscript:function(a,c){return this._setScript(a,c,this.superscript)},setSubscript:function(a,c){return this._setScript(a,c,this.subscript)},_setScript:function(a,c,s){var f=this.get2DCursorLocation(a,!0),g=this.getValueOfPropertyAt(f.lineIndex,f.charIndex,"fontSize"),l=this.getValueOfPropertyAt(f.lineIndex,f.charIndex,"deltaY");return this.setSelectionStyles({fontSize:g*s.size,deltaY:l+g*s.baseline},a,c),this},_getLineLeftOffset:function(a){var c=this.getLineWidth(a),s=this.width-c,f=this.textAlign,g=this.direction,l=0,v=this.isEndOfWrapping(a);return"justify"===f||"justify-center"===f&&!v||"justify-right"===f&&!v||"justify-left"===f&&!v?0:("center"===f&&(l=s/2),"right"===f&&(l=s),"justify-center"===f&&(l=s/2),"justify-right"===f&&(l=s),"rtl"===g&&(l-=s),l)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var a=this._forceClearCache;return a||(a=this.hasStateChanged("_dimensionAffectingProps")),a&&(this.dirty=!0,this._forceClearCache=!1),a},getLineWidth:function(a){if(void 0!==this.__lineWidths[a])return this.__lineWidths[a];var s=this.measureLine(a).width;return this.__lineWidths[a]=s,s},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(a,c,s){var f=this._getStyleDeclaration(a,c);return f&&typeof f[s]<"u"?f[s]:this[s]},_renderTextDecoration:function(a,c){if(this[c]||this.styleHas(c)){for(var s,f,g,l,v,_,b,S,P,j,G,re,le,ge,pe,ce,T=this._getLeftOffset(),M=this._getTopOffset(),fe=this.path,_e=this._getWidthOfCharSpacing(),ve=this.offsets[c],Ce=0,I=this._textLines.length;Ce<I;Ce++)if(s=this.getHeightOfLine(Ce),this[c]||this.styleHas(c,Ce)){b=this._textLines[Ce],ge=s/this.lineHeight,l=this._getLineLeftOffset(Ce),j=0,G=0,S=this.getValueOfPropertyAt(Ce,0,c),ce=this.getValueOfPropertyAt(Ce,0,"fill"),P=M+ge*(1-this._fontSizeFraction),f=this.getHeightOfChar(Ce,0),v=this.getValueOfPropertyAt(Ce,0,"deltaY");for(var N=0,L=b.length;N<L;N++)if(re=this.__charBounds[Ce][N],le=this.getValueOfPropertyAt(Ce,N,c),pe=this.getValueOfPropertyAt(Ce,N,"fill"),g=this.getHeightOfChar(Ce,N),_=this.getValueOfPropertyAt(Ce,N,"deltaY"),fe&&le&&pe)a.save(),a.fillStyle=ce,a.translate(re.renderLeft,re.renderTop),a.rotate(re.angle),a.fillRect(-re.kernedWidth/2,ve*g+_,re.kernedWidth,this.fontSize/15),a.restore();else if((le!==S||pe!==ce||g!==f||_!==v)&&G>0){var R=T+l+j;"rtl"===this.direction&&(R=this.width-R-G),S&&ce&&(a.fillStyle=ce,a.fillRect(R,P+ve*f+v,G,this.fontSize/15)),j=re.left,G=re.width,S=le,ce=pe,f=g,v=_}else G+=re.kernedWidth;R=T+l+j,"rtl"===this.direction&&(R=this.width-R-G),a.fillStyle=pe,le&&pe&&a.fillRect(R,P+ve*f+v,G-_e,this.fontSize/15),M+=s}else M+=s;this._removeShadow(a)}},_getFontDeclaration:function(a,c){var s=a||this,f=this.fontFamily,g=h.Text.genericFonts.indexOf(f.toLowerCase())>-1,l=void 0===f||f.indexOf("'")>-1||f.indexOf(",")>-1||f.indexOf('"')>-1||g?s.fontFamily:'"'+s.fontFamily+'"';return[h.isLikelyNode?s.fontWeight:s.fontStyle,h.isLikelyNode?s.fontStyle:s.fontWeight,c?this.CACHE_FONT_SIZE+"px":s.fontSize+"px",l].join(" ")},render:function(a){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",a)))},_splitTextIntoLines:function(a){for(var c=a.split(this._reNewline),s=new Array(c.length),f=["\n"],g=[],l=0;l<c.length;l++)s[l]=h.util.string.graphemeSplit(c[l]),g=g.concat(s[l],f);return g.pop(),{_unwrappedLines:s,lines:c,graphemeText:g,graphemeLines:s}},toObject:function(a){var c=d.concat(a),s=this.callSuper("toObject",c);return s.styles=h.util.stylesToArray(this.styles,this.text),s.path&&(s.path=this.path.toObject()),s},set:function(a,c){this.callSuper("set",a,c);var s=!1,f=!1;if("object"==typeof a)for(var g in a)"path"===g&&this.setPathInfo(),s=s||-1!==this._dimensionAffectingProps.indexOf(g),f=f||"path"===g;else s=-1!==this._dimensionAffectingProps.indexOf(a),f="path"===a;return f&&this.setPathInfo(),s&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),h.Text.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),h.Text.DEFAULT_SVG_FONT_SIZE=16,h.Text.fromElement=function(a,c,s){if(!a)return c(null);var f=h.parseAttributes(a,h.Text.ATTRIBUTE_NAMES),g=f.textAnchor||"left";if((s=h.util.object.extend(s?p(s):{},f)).top=s.top||0,s.left=s.left||0,f.textDecoration){var l=f.textDecoration;-1!==l.indexOf("underline")&&(s.underline=!0),-1!==l.indexOf("overline")&&(s.overline=!0),-1!==l.indexOf("line-through")&&(s.linethrough=!0),delete s.textDecoration}"dx"in f&&(s.left+=f.dx),"dy"in f&&(s.top+=f.dy),"fontSize"in s||(s.fontSize=h.Text.DEFAULT_SVG_FONT_SIZE);var v="";"textContent"in a?v=a.textContent:"firstChild"in a&&null!==a.firstChild&&"data"in a.firstChild&&null!==a.firstChild.data&&(v=a.firstChild.data),v=v.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var _=s.strokeWidth;s.strokeWidth=0;var b=new h.Text(v,s),S=b.getScaledHeight()/b.height,M=((b.height+b.strokeWidth)*b.lineHeight-b.height)*S,P=b.getScaledHeight()+M,j=0;"center"===g&&(j=b.getScaledWidth()/2),"right"===g&&(j=b.getScaledWidth()),b.set({left:b.left-j,top:b.top-(P-b.fontSize*(.07+b._fontSizeFraction))/b.lineHeight,strokeWidth:typeof _<"u"?_:1}),c(b)},h.Text.fromObject=function(a,c){var s=p(a),f=a.path;return delete s.path,h.Object._fromObject("Text",s,function(g){g.styles=h.util.stylesFromArray(a.styles,a.text),f?h.Object._fromObject("Path",f,function(l){g.set("path",l),c(g)},"path"):c(g)},"text")},h.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],h.util.createAccessors&&h.util.createAccessors(h.Text)}}(Ie),w.util.object.extend(w.Text.prototype,{isEmptyStyles:function(y){if(!this.styles||typeof y<"u"&&!this.styles[y])return!0;var h=typeof y>"u"?this.styles:{line:this.styles[y]};for(var p in h)for(var d in h[p])for(var a in h[p][d])return!1;return!0},styleHas:function(y,h){if(!this.styles||!y||""===y||typeof h<"u"&&!this.styles[h])return!1;var p=typeof h>"u"?this.styles:{0:this.styles[h]};for(var d in p)for(var a in p[d])if(typeof p[d][a][y]<"u")return!0;return!1},cleanStyle:function(y){if(!this.styles||!y||""===y)return!1;var d,a,h=this.styles,p=0,c=!0,s=0;for(var g in h){for(var l in d=0,h[g]){var f;p++,(f=h[g][l]).hasOwnProperty(y)?(a?f[y]!==a&&(c=!1):a=f[y],f[y]===this[y]&&delete f[y]):c=!1,0!==Object.keys(f).length?d++:delete h[g][l]}0===d&&delete h[g]}for(var _=0;_<this._textLines.length;_++)s+=this._textLines[_].length;c&&p===s&&(this[y]=a,this.removeStyle(y))},removeStyle:function(y){if(this.styles&&y&&""!==y){var p,d,a,h=this.styles;for(d in h){for(a in p=h[d])delete p[a][y],0===Object.keys(p[a]).length&&delete p[a];0===Object.keys(p).length&&delete h[d]}}},_extendStyles:function(y,h){var p=this.get2DCursorLocation(y);this._getLineStyle(p.lineIndex)||this._setLineStyle(p.lineIndex),this._getStyleDeclaration(p.lineIndex,p.charIndex)||this._setStyleDeclaration(p.lineIndex,p.charIndex,{}),w.util.object.extend(this._getStyleDeclaration(p.lineIndex,p.charIndex),h)},get2DCursorLocation:function(y,h){typeof y>"u"&&(y=this.selectionStart);for(var p=h?this._unwrappedTextLines:this._textLines,d=p.length,a=0;a<d;a++){if(y<=p[a].length)return{lineIndex:a,charIndex:y};y-=p[a].length+this.missingNewlineOffset(a)}return{lineIndex:a-1,charIndex:p[a-1].length<y?p[a-1].length:y}},getSelectionStyles:function(y,h,p){typeof y>"u"&&(y=this.selectionStart||0),typeof h>"u"&&(h=this.selectionEnd||y);for(var d=[],a=y;a<h;a++)d.push(this.getStyleAtPosition(a,p));return d},getStyleAtPosition:function(y,h){var p=this.get2DCursorLocation(y);return(h?this.getCompleteStyleDeclaration(p.lineIndex,p.charIndex):this._getStyleDeclaration(p.lineIndex,p.charIndex))||{}},setSelectionStyles:function(y,h,p){typeof h>"u"&&(h=this.selectionStart||0),typeof p>"u"&&(p=this.selectionEnd||h);for(var d=h;d<p;d++)this._extendStyles(d,y);return this._forceClearCache=!0,this},_getStyleDeclaration:function(y,h){var p=this.styles&&this.styles[y];return p?p[h]:null},getCompleteStyleDeclaration:function(y,h){for(var a,p=this._getStyleDeclaration(y,h)||{},d={},c=0;c<this._styleProperties.length;c++)d[a=this._styleProperties[c]]=typeof p[a]>"u"?this[a]:p[a];return d},_setStyleDeclaration:function(y,h,p){this.styles[y][h]=p},_deleteStyleDeclaration:function(y,h){delete this.styles[y][h]},_getLineStyle:function(y){return!!this.styles[y]},_setLineStyle:function(y){this.styles[y]={}},_deleteLineStyle:function(y){delete this.styles[y]}}),function(){function y(h){h.textDecoration&&(h.textDecoration.indexOf("underline")>-1&&(h.underline=!0),h.textDecoration.indexOf("line-through")>-1&&(h.linethrough=!0),h.textDecoration.indexOf("overline")>-1&&(h.overline=!0),delete h.textDecoration)}w.IText=w.util.createClass(w.Text,w.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(h,p){this.callSuper("initialize",h,p),this.initBehavior()},setSelectionStart:function(h){h=Math.max(h,0),this._updateAndFire("selectionStart",h)},setSelectionEnd:function(h){h=Math.min(h,this.text.length),this._updateAndFire("selectionEnd",h)},_updateAndFire:function(h,p){this[h]!==p&&(this._fireSelectionChanged(),this[h]=p),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(h){this.clearContextTop(),this.callSuper("render",h),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(h){this.callSuper("_render",h)},clearContextTop:function(h){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var p=this.canvas.contextTop,d=this.canvas.viewportTransform;p.save(),p.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this.transform(p),this._clearTextArea(p),h||p.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var h=this._getCursorBoundaries(),p=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(h,p):this.renderSelection(h,p),p.restore()}},_clearTextArea:function(h){var p=this.width+4,d=this.height+4;h.clearRect(-p/2,-d/2,p,d)},_getCursorBoundaries:function(h){typeof h>"u"&&(h=this.selectionStart);var p=this._getLeftOffset(),d=this._getTopOffset(),a=this._getCursorBoundariesOffsets(h);return{left:p,top:d,leftOffset:a.left,topOffset:a.top}},_getCursorBoundariesOffsets:function(h){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var p,d,a,f,c=0,s=0,g=this.get2DCursorLocation(h);a=g.charIndex,d=g.lineIndex;for(var l=0;l<d;l++)c+=this.getHeightOfLine(l);p=this._getLineLeftOffset(d);var v=this.__charBounds[d][a];return v&&(s=v.left),0!==this.charSpacing&&a===this._textLines[d].length&&(s-=this._getWidthOfCharSpacing()),f={top:c,left:p+(s>0?s:0)},"rtl"===this.direction&&(f.left*=-1),this.cursorOffsetCache=f,this.cursorOffsetCache},renderCursor:function(h,p){var d=this.get2DCursorLocation(),a=d.lineIndex,c=d.charIndex>0?d.charIndex-1:0,s=this.getValueOfPropertyAt(a,c,"fontSize"),f=this.scaleX*this.canvas.getZoom(),g=this.cursorWidth/f,l=h.topOffset,v=this.getValueOfPropertyAt(a,c,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(a)/this.lineHeight-s*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(h,p),p.fillStyle=this.cursorColor||this.getValueOfPropertyAt(a,c,"fill"),p.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,p.fillRect(h.left+h.leftOffset-g/2,l+h.top+v,g,s)},renderSelection:function(h,p){for(var d=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,a=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,c=-1!==this.textAlign.indexOf("justify"),s=this.get2DCursorLocation(d),f=this.get2DCursorLocation(a),g=s.lineIndex,l=f.lineIndex,v=s.charIndex<0?0:s.charIndex,_=f.charIndex<0?0:f.charIndex,b=g;b<=l;b++){var M,S=this._getLineLeftOffset(b)||0,T=this.getHeightOfLine(b),P=0,j=0;if(b===g&&(P=this.__charBounds[g][v].left),b>=g&&b<l)j=c&&!this.isEndOfWrapping(b)?this.width:this.getLineWidth(b)||5;else if(b===l)if(0===_)j=this.__charBounds[l][_].left;else{var G=this._getWidthOfCharSpacing();j=this.__charBounds[l][_-1].left+this.__charBounds[l][_-1].width-G}M=T,(this.lineHeight<1||b===l&&this.lineHeight>1)&&(T/=this.lineHeight);var re=h.left+S+P,le=j-P,ge=T,pe=0;this.inCompositionMode?(p.fillStyle=this.compositionColor||"black",ge=1,pe=T):p.fillStyle=this.selectionColor,"rtl"===this.direction&&(re=this.width-re-le),p.fillRect(re,h.top+h.topOffset+pe,le,ge),h.topOffset+=M}},getCurrentCharFontSize:function(){var h=this._getCurrentCharIndex();return this.getValueOfPropertyAt(h.l,h.c,"fontSize")},getCurrentCharColor:function(){var h=this._getCurrentCharIndex();return this.getValueOfPropertyAt(h.l,h.c,"fill")},_getCurrentCharIndex:function(){var h=this.get2DCursorLocation(this.selectionStart,!0);return{l:h.lineIndex,c:h.charIndex>0?h.charIndex-1:0}}}),w.IText.fromObject=function(h,p){var d=w.util.stylesFromArray(h.styles,h.text),a=Object.assign({},h,{styles:d});if(y(a),a.styles)for(var c in a.styles)for(var s in a.styles[c])y(a.styles[c][s]);w.Object._fromObject("IText",a,p,"text")}}(),function(){var y=w.util.object.clone;w.util.object.extend(w.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var h=this;this.on("added",function(){var p=h.canvas;p&&(p._hasITextHandlers||(p._hasITextHandlers=!0,h._initCanvasHandlers(p)),p._iTextInstances=p._iTextInstances||[],p._iTextInstances.push(h))})},initRemovedHandler:function(){var h=this;this.on("removed",function(){var p=h.canvas;p&&(p._iTextInstances=p._iTextInstances||[],w.util.removeFromArray(p._iTextInstances,h),0===p._iTextInstances.length&&(p._hasITextHandlers=!1,h._removeCanvasHandlers(p)))})},_initCanvasHandlers:function(h){h._mouseUpITextHandler=function(){h._iTextInstances&&h._iTextInstances.forEach(function(p){p.__isMousedown=!1})},h.on("mouse:up",h._mouseUpITextHandler)},_removeCanvasHandlers:function(h){h.off("mouse:up",h._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(h,p,d,a){var c;return c={isAborted:!1,abort:function(){this.isAborted=!0}},h.animate("_currentCursorOpacity",p,{duration:d,onComplete:function(){c.isAborted||h[a]()},onChange:function(){h.canvas&&h.selectionStart===h.selectionEnd&&h.renderCursorOrSelection()},abort:function(){return c.isAborted}}),c},_onTickComplete:function(){var h=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){h._currentTickCompleteState=h._animateCursor(h,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(h){var p=this,d=h?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){p._tick()},d)},abortCursorAnimation:function(){var h=this._currentTickState||this._currentTickCompleteState,p=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,h&&p&&p.clearContext(p.contextTop||p.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(h){var p=0,d=h-1;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)p++,d--;for(;/\S/.test(this._text[d])&&d>-1;)p++,d--;return h-p},findWordBoundaryRight:function(h){var p=0,d=h;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)p++,d++;for(;/\S/.test(this._text[d])&&d<this._text.length;)p++,d++;return h+p},findLineBoundaryLeft:function(h){for(var p=0,d=h-1;!/\n/.test(this._text[d])&&d>-1;)p++,d--;return h-p},findLineBoundaryRight:function(h){for(var p=0,d=h;!/\n/.test(this._text[d])&&d<this._text.length;)p++,d++;return h+p},searchWordBoundary:function(h,p){for(var d=this._text,a=this._reSpace.test(d[h])?h-1:h,c=d[a],s=w.reNonWord;!s.test(c)&&a>0&&a<d.length;)c=d[a+=p];return s.test(c)&&(a+=1===p?0:1),a},selectWord:function(h){var p=this.searchWordBoundary(h=h||this.selectionStart,-1),d=this.searchWordBoundary(h,1);this.selectionStart=p,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(h){var p=this.findLineBoundaryLeft(h=h||this.selectionStart),d=this.findLineBoundaryRight(h);return this.selectionStart=p,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(h){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(h),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(h){h._iTextInstances&&h._iTextInstances.forEach(function(p){p.selected=!1,p.isEditing&&p.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(h){if(this.__isMousedown&&this.isEditing){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var p=this.getSelectionStartFromPointer(h.e),d=this.selectionStart,a=this.selectionEnd;(p!==this.__selectionStartOnMouseDown||d===a)&&(d===p||a===p)||(p>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=p):(this.selectionStart=p,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==d||this.selectionEnd!==a)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(h,p,d){var a=d.slice(0,h),c=w.util.string.graphemeSplit(a).length;if(h===p)return{selectionStart:c,selectionEnd:c};var s=d.slice(h,p);return{selectionStart:c,selectionEnd:c+w.util.string.graphemeSplit(s).length}},fromGraphemeToStringSelection:function(h,p,d){var c=d.slice(0,h).join("").length;return h===p?{selectionStart:c,selectionEnd:c}:{selectionStart:c,selectionEnd:c+d.slice(h,p).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var h=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=h.selectionStart,this.hiddenTextarea.selectionEnd=h.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var h=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=h.selectionEnd,this.inCompositionMode||(this.selectionStart=h.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var h=this._calcTextareaPosition();this.hiddenTextarea.style.left=h.left,this.hiddenTextarea.style.top=h.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var h=this.inCompositionMode?this.compositionStart:this.selectionStart,p=this._getCursorBoundaries(h),d=this.get2DCursorLocation(h),s=this.getValueOfPropertyAt(d.lineIndex,d.charIndex,"fontSize")*this.lineHeight,f=p.leftOffset,g=this.calcTransformMatrix(),l={x:p.left+f,y:p.top+p.topOffset+s},v=this.canvas.getRetinaScaling(),_=this.canvas.upperCanvasEl,b=_.width/v,S=_.height/v,T=b-s,M=S-s,P=_.clientWidth/b,j=_.clientHeight/S;return l=w.util.transformPoint(l,g),(l=w.util.transformPoint(l,this.canvas.viewportTransform)).x*=P,l.y*=j,l.x<0&&(l.x=0),l.x>T&&(l.x=T),l.y<0&&(l.y=0),l.y>M&&(l.y=M),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:s+"px",charHeight:s}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var h=this._textBeforeEdit!==this.text,p=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,p&&(p.blur&&p.blur(),p.parentNode&&p.parentNode.removeChild(p)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),h&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),h&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var h in this.styles)this._textLines[h]||delete this.styles[h]},removeStyleFromTo:function(h,p){var l,v,d=this.get2DCursorLocation(h,!0),a=this.get2DCursorLocation(p,!0),c=d.lineIndex,s=d.charIndex,f=a.lineIndex,g=a.charIndex;if(c!==f){if(this.styles[c])for(l=s;l<this._unwrappedTextLines[c].length;l++)delete this.styles[c][l];if(this.styles[f])for(l=g;l<this._unwrappedTextLines[f].length;l++)(v=this.styles[f][l])&&(this.styles[c]||(this.styles[c]={}),this.styles[c][s+l-g]=v);for(l=c+1;l<=f;l++)delete this.styles[l];this.shiftLineStyles(f,c-f)}else if(this.styles[c]){v=this.styles[c];var b,S,_=g-s;for(l=s;l<g;l++)delete v[l];for(S in this.styles[c])(b=parseInt(S,10))>=g&&(v[b-_]=v[S],delete v[S])}},shiftLineStyles:function(h,p){var d=y(this.styles);for(var a in this.styles){var c=parseInt(a,10);c>h&&(this.styles[c+p]=d[c],d[c-p]||delete this.styles[c])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(h,p,d,a){var c,s={},f=!1,g=this._unwrappedTextLines[h].length===p;for(var l in d||(d=1),this.shiftLineStyles(h,d),this.styles[h]&&(c=this.styles[h][0===p?p:p-1]),this.styles[h]){var v=parseInt(l,10);v>=p&&(f=!0,s[v-p]=this.styles[h][l],g&&0===p||delete this.styles[h][l])}var _=!1;for(f&&!g&&(this.styles[h+d]=s,_=!0),_&&d--;d>0;)a&&a[d-1]?this.styles[h+d]={0:y(a[d-1])}:c?this.styles[h+d]={0:y(c)}:delete this.styles[h+d],d--;this._forceClearCache=!0},insertCharStyleObject:function(h,p,d,a){this.styles||(this.styles={});var c=this.styles[h],s=c?y(c):{};for(var f in d||(d=1),s){var g=parseInt(f,10);g>=p&&(c[g+d]=s[g],s[g-d]||delete c[g])}if(this._forceClearCache=!0,a)for(;d--;)Object.keys(a[d]).length&&(this.styles[h]||(this.styles[h]={}),this.styles[h][p+d]=y(a[d]));else if(c)for(var l=c[p?p-1:1];l&&d--;)this.styles[h][p+d]=y(l)},insertNewStyleBlock:function(h,p,d){for(var a=this.get2DCursorLocation(p,!0),c=[0],s=0,f=0;f<h.length;f++)"\n"===h[f]?c[++s]=0:c[s]++;for(c[0]>0&&(this.insertCharStyleObject(a.lineIndex,a.charIndex,c[0],d),d=d&&d.slice(c[0]+1)),s&&this.insertNewlineStyleObject(a.lineIndex,a.charIndex+c[0],s),f=1;f<s;f++)c[f]>0?this.insertCharStyleObject(a.lineIndex+f,0,c[f],d):d&&this.styles[a.lineIndex+f]&&d[0]&&(this.styles[a.lineIndex+f][0]=d[0]),d=d&&d.slice(c[f]+1);c[f]>0&&this.insertCharStyleObject(a.lineIndex+f,0,c[f],d)},setSelectionStartEndWithShift:function(h,p,d){d<=h?(p===h?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=h),this.selectionStart=d):d>h&&d<p?"right"===this._selectionDirection?this.selectionEnd=d:this.selectionStart=d:(p===h?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=p),this.selectionEnd=d)},setSelectionInBoundaries:function(){var h=this.text.length;this.selectionStart>h?this.selectionStart=h:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>h?this.selectionEnd=h:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),w.util.object.extend(w.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(y){if(this.canvas){this.__newClickTime=+new Date;var h=y.pointer;this.isTripleClick(h)&&(this.fire("tripleclick",y),this._stopEvent(y.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=h,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(y){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===y.x&&this.__lastPointer.y===y.y},_stopEvent:function(y){y.preventDefault&&y.preventDefault(),y.stopPropagation&&y.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(y){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(y.e))},tripleClickHandler:function(y){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(y.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(y){!this.canvas||!this.editable||y.e.button&&1!==y.e.button||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(y.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(y){!this.canvas||!this.editable||y.e.button&&1!==y.e.button||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(y){if(this.__isMousedown=!1,!(!this.editable||this.group||y.transform&&y.transform.actionPerformed||y.e.button&&1!==y.e.button)){if(this.canvas){var h=this.canvas._activeObject;if(h&&h!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(y.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(y){var h=this.getSelectionStartFromPointer(y);y.shiftKey?this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,h):(this.selectionStart=h,this.selectionEnd=h),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(y){for(var g,h=this.getLocalPointer(y),p=0,d=0,a=0,c=0,s=0,l=0,v=this._textLines.length;l<v&&a<=h.y;l++)a+=this.getHeightOfLine(l)*this.scaleY,s=l,l>0&&(c+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));d=this._getLineLeftOffset(s)*this.scaleX,g=this._textLines[s],"rtl"===this.direction&&(h.x=this.width*this.scaleX-h.x+d);for(var _=0,b=g.length;_<b&&(p=d,(d+=this.__charBounds[s][_].kernedWidth*this.scaleX)<=h.x);_++)c++;return this._getNewSelectionStartFromOffset(h,p,d,c,b)},_getNewSelectionStartFromOffset:function(y,h,p,d,a){var s=p-y.x,g=d+(s>y.x-h||s<0?0:1);return this.flipX&&(g=a-g),g>this._text.length&&(g=this._text.length),g}}),w.util.object.extend(w.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=w.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var y=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+y.top+"; left: "+y.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+y.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):w.document.body.appendChild(this.hiddenTextarea),w.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),w.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),w.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),w.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),w.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),w.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),w.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),w.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),w.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(w.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(y){if(this.isEditing){var h="rtl"===this.direction?this.keysMapRtl:this.keysMap;if(y.keyCode in h)this[h[y.keyCode]](y);else{if(!(y.keyCode in this.ctrlKeysMapDown)||!y.ctrlKey&&!y.metaKey)return;this[this.ctrlKeysMapDown[y.keyCode]](y)}y.stopImmediatePropagation(),y.preventDefault(),y.keyCode>=33&&y.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(y){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:y.keyCode in this.ctrlKeysMapUp&&(y.ctrlKey||y.metaKey)&&(this[this.ctrlKeysMapUp[y.keyCode]](y),y.stopImmediatePropagation(),y.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(y){var h=this.fromPaste;if(this.fromPaste=!1,y&&y.stopPropagation(),this.isEditing){var c,s,_,b,S,p=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,d=this._text.length,a=p.length,f=a-d,g=this.selectionStart,l=this.selectionEnd,v=g!==l;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var T=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),M=g>T.selectionStart;v?(c=this._text.slice(g,l),f+=l-g):a<d&&(c=M?this._text.slice(l+f,l):this._text.slice(g,g-f)),s=p.slice(T.selectionEnd-f,T.selectionEnd),c&&c.length&&(s.length&&(_=this.getSelectionStyles(g,g+1,!1),_=s.map(function(){return _[0]})),v?(b=g,S=l):M?(b=l-c.length,S=l):(b=l,S=l+c.length),this.removeStyleFromTo(b,S)),s.length&&(h&&s.join("")===w.copiedText&&!w.disableStyleCopyPaste&&(_=w.copiedTextStyle),this.insertNewStyleBlock(s,g,_)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(y){this.compositionStart=y.target.selectionStart,this.compositionEnd=y.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(w.copiedText=this.getSelectedText(),w.copiedTextStyle=w.disableStyleCopyPaste?null:this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(y){return y&&y.clipboardData||w.window.clipboardData},_getWidthBeforeCursor:function(y,h){var d,p=this._getLineLeftOffset(y);return h>0&&(p+=(d=this.__charBounds[y][h-1]).left+d.width),p},getDownCursorOffset:function(y,h){var p=this._getSelectionForOffset(y,h),d=this.get2DCursorLocation(p),a=d.lineIndex;if(a===this._textLines.length-1||y.metaKey||34===y.keyCode)return this._text.length-p;var c=d.charIndex,s=this._getWidthBeforeCursor(a,c),f=this._getIndexOnLine(a+1,s);return this._textLines[a].slice(c).length+f+1+this.missingNewlineOffset(a)},_getSelectionForOffset:function(y,h){return y.shiftKey&&this.selectionStart!==this.selectionEnd&&h?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(y,h){var p=this._getSelectionForOffset(y,h),d=this.get2DCursorLocation(p),a=d.lineIndex;if(0===a||y.metaKey||33===y.keyCode)return-p;var c=d.charIndex,s=this._getWidthBeforeCursor(a,c),f=this._getIndexOnLine(a-1,s),g=this._textLines[a].slice(0,c),l=this.missingNewlineOffset(a-1);return-this._textLines[a-1].length+f-g.length+(1-l)},_getIndexOnLine:function(y,h){for(var s,f,p=this._textLines[y],a=this._getLineLeftOffset(y),c=0,g=0,l=p.length;g<l;g++)if((a+=s=this.__charBounds[y][g].width)>h){f=!0;var _=a,b=Math.abs(a-s-h);c=Math.abs(_-h)<b?g:g-1;break}return f||(c=p.length-1),c},moveCursorDown:function(y){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",y)},moveCursorUp:function(y){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",y)},_moveCursorUpOrDown:function(y,h){var d=this["get"+y+"CursorOffset"](h,"right"===this._selectionDirection);h.shiftKey?this.moveCursorWithShift(d):this.moveCursorWithoutShift(d),0!==d&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(y){return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,"left"===this._selectionDirection?this.selectionStart+y:this.selectionEnd+y),0!==y},moveCursorWithoutShift:function(y){return y<0?(this.selectionStart+=y,this.selectionEnd=this.selectionStart):(this.selectionEnd+=y,this.selectionStart=this.selectionEnd),0!==y},moveCursorLeft:function(y){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",y)},_move:function(y,h,p){var d;if(y.altKey)d=this["findWordBoundary"+p](this[h]);else{if(!y.metaKey&&35!==y.keyCode&&36!==y.keyCode)return this[h]+="Left"===p?-1:1,!0;d=this["findLineBoundary"+p](this[h])}if(typeof d<"u"&&this[h]!==d)return this[h]=d,!0},_moveLeft:function(y,h){return this._move(y,h,"Left")},_moveRight:function(y,h){return this._move(y,h,"Right")},moveCursorLeftWithoutShift:function(y){var h=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(h=this._moveLeft(y,"selectionStart")),this.selectionEnd=this.selectionStart,h},moveCursorLeftWithShift:function(y){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(y,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(y,"selectionStart")):void 0},moveCursorRight:function(y){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",y)},_moveCursorLeftOrRight:function(y,h){var p="moveCursor"+y+"With";this._currentCursorOpacity=1,this[p+=h.shiftKey?"Shift":"outShift"](h)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(y){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(y,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(y,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(y){var h=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(h=this._moveRight(y,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,h},removeChars:function(y,h){typeof h>"u"&&(h=y+1),this.removeStyleFromTo(y,h),this._text.splice(y,h-y),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(y,h,p,d){typeof d>"u"&&(d=p),d>p&&this.removeStyleFromTo(p,d);var a=w.util.string.graphemeSplit(y);this.insertNewStyleBlock(a,p,h),this._text=[].concat(this._text.slice(0,p),a,this._text.slice(d)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var y=w.util.toFixed,h=/  +/g;w.util.object.extend(w.Text.prototype,{_toSVG:function(){var p=this._getSVGLeftTopOffsets(),d=this._getSVGTextAndBg(p.textTop,p.textLeft);return this._wrapSVGTextAndBg(d)},toSVG:function(p){return this._createBaseSVGMarkup(this._toSVG(),{reviver:p,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(p){var a=this.getSvgTextDecoration(this);return[p.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",a?'text-decoration="'+a+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",p.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(p,d){var f,a=[],c=[],s=p;this._setSVGBg(c);for(var g=0,l=this._textLines.length;g<l;g++)f=this._getLineLeftOffset(g),(this.textBackgroundColor||this.styleHas("textBackgroundColor",g))&&this._setSVGTextLineBg(c,g,d+f,s),this._setSVGTextLineText(a,g,d+f,s),s+=this.getHeightOfLine(g);return{textSpans:a,textBgRects:c}},_createTextCharSpan:function(p,d,a,c){var s=p!==p.trim()||p.match(h),f=this.getSvgSpanStyles(d,s),g=f?'style="'+f+'"':"",l=d.deltaY,v="",_=w.Object.NUM_FRACTION_DIGITS;return l&&(v=' dy="'+y(l,_)+'" '),['<tspan x="',y(a,_),'" y="',y(c,_),'" ',v,g,">",w.util.string.escapeXml(p),"</tspan>"].join("")},_setSVGTextLineText:function(p,d,a,c){var g,l,_,b,M,s=this.getHeightOfLine(d),f=-1!==this.textAlign.indexOf("justify"),v="",S=0,T=this._textLines[d];c+=s*(1-this._fontSizeFraction)/this.lineHeight;for(var P=0,j=T.length-1;P<=j;P++)M=P===j||this.charSpacing,v+=T[P],_=this.__charBounds[d][P],0===S?(a+=_.kernedWidth-_.width,S+=_.width):S+=_.kernedWidth,f&&!M&&this._reSpaceAndTab.test(T[P])&&(M=!0),M||(g=g||this.getCompleteStyleDeclaration(d,P),l=this.getCompleteStyleDeclaration(d,P+1),M=w.util.hasStyleChanged(g,l,!0)),M&&(b=this._getStyleDeclaration(d,P)||{},p.push(this._createTextCharSpan(v,b,a,c)),v="",g=l,a+=S,S=0)},_pushTextBgRect:function(p,d,a,c,s,f){var g=w.Object.NUM_FRACTION_DIGITS;p.push("\t\t<rect ",this._getFillAttributes(d),' x="',y(a,g),'" y="',y(c,g),'" width="',y(s,g),'" height="',y(f,g),'"></rect>\n')},_setSVGTextLineBg:function(p,d,a,c){for(var v,_,s=this._textLines[d],f=this.getHeightOfLine(d)/this.lineHeight,g=0,l=0,b=this.getValueOfPropertyAt(d,0,"textBackgroundColor"),S=0,T=s.length;S<T;S++)v=this.__charBounds[d][S],(_=this.getValueOfPropertyAt(d,S,"textBackgroundColor"))!==b?(b&&this._pushTextBgRect(p,b,a+l,c,g,f),l=v.left,g=v.width,b=_):g+=v.kernedWidth;_&&this._pushTextBgRect(p,_,a+l,c,g,f)},_getFillAttributes:function(p){var d=p&&"string"==typeof p?new w.Color(p):"";return d&&d.getSource()&&1!==d.getAlpha()?'opacity="'+d.getAlpha()+'" fill="'+d.setAlpha(1).toRgb()+'"':'fill="'+p+'"'},_getSVGLineTopOffset:function(p){for(var a,d=0,c=0;c<p;c++)d+=this.getHeightOfLine(c);return a=this.getHeightOfLine(c),{lineTop:d,offset:(this._fontSizeMult-this._fontSizeFraction)*a/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(p){return w.Object.prototype.getSvgStyles.call(this,p)+" white-space: pre;"}})}(),function(y){"use strict";var h=y.fabric||(y.fabric={});h.Textbox=h.util.createClass(h.IText,h.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:h.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(p){for(var d=0,a=0,c=0,s={},f=0;f<p.graphemeLines.length;f++)"\n"===p.graphemeText[c]&&f>0?(a=0,c++,d++):!this.splitByGrapheme&&this._reSpaceAndTab.test(p.graphemeText[c])&&f>0&&(a++,c++),s[f]={line:d,offset:a},c+=p.graphemeLines[f].length,a+=p.graphemeLines[f].length;return s},styleHas:function(p,d){if(this._styleMap&&!this.isWrapping){var a=this._styleMap[d];a&&(d=a.line)}return h.Text.prototype.styleHas.call(this,p,d)},isEmptyStyles:function(p){if(!this.styles)return!0;var c,s,d=0,f=!1,g=this._styleMap[p],l=this._styleMap[p+1];for(var v in g&&(p=g.line,d=g.offset),l&&(f=l.line===p,c=l.offset),s=typeof p>"u"?this.styles:{line:this.styles[p]})for(var _ in s[v])if(_>=d&&(!f||_<c))for(var b in s[v][_])return!1;return!0},_getStyleDeclaration:function(p,d){if(this._styleMap&&!this.isWrapping){var a=this._styleMap[p];if(!a)return null;p=a.line,d=a.offset+d}return this.callSuper("_getStyleDeclaration",p,d)},_setStyleDeclaration:function(p,d,a){var c=this._styleMap[p];this.styles[p=c.line][d=c.offset+d]=a},_deleteStyleDeclaration:function(p,d){var a=this._styleMap[p];delete this.styles[p=a.line][d=a.offset+d]},_getLineStyle:function(p){return!!this.styles[this._styleMap[p].line]},_setLineStyle:function(p){this.styles[this._styleMap[p].line]={}},_wrapText:function(p,d){var c,a=[];for(this.isWrapping=!0,c=0;c<p.length;c++)a=a.concat(this._wrapLine(p[c],c,d));return this.isWrapping=!1,a},_measureWord:function(p,d,a){var s,c=0;a=a||0;for(var g=0,l=p.length;g<l;g++)c+=this._getGraphemeBox(p[g],d,g+a,s,!0).kernedWidth,s=p[g];return c},_wrapLine:function(p,d,a,re){var s=0,f=this.splitByGrapheme,g=[],l=[],v=f?h.util.string.graphemeSplit(p):p.split(this._wordJoiners),_="",b=0,S=f?"":" ",T=0,M=0,P=0,j=!0,G=this._getWidthOfCharSpacing();re=re||0,0===v.length&&v.push([]),a-=re;for(var le=0;le<v.length;le++)_=f?v[le]:h.util.string.graphemeSplit(v[le]),T=this._measureWord(_,d,b),b+=_.length,(s+=M+T-G)>a&&!j?(g.push(l),l=[],s=T,j=!0):s+=G,!j&&!f&&l.push(S),l=l.concat(_),M=f?0:this._measureWord([S],d,b),b++,j=!1,T>P&&(P=T);return le&&g.push(l),P+re>this.dynamicMinWidth&&(this.dynamicMinWidth=P-G+re),g},isEndOfWrapping:function(p){return!this._styleMap[p+1]||this._styleMap[p+1].line!==this._styleMap[p].line},missingNewlineOffset:function(p){return this.splitByGrapheme?this.isEndOfWrapping(p)?1:0:1},_splitTextIntoLines:function(p){for(var d=h.Text.prototype._splitTextIntoLines.call(this,p),a=this._wrapText(d.lines,this.width),c=new Array(a.length),s=0;s<a.length;s++)c[s]=a[s].join("");return d.lines=c,d.graphemeLines=a,d},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var p={};for(var d in this._styleMap)this._textLines[d]&&(p[this._styleMap[d].line]=1);for(var d in this.styles)p[d]||delete this.styles[d]},toObject:function(p){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(p))}}),h.Textbox.fromObject=function(p,d){var a=h.util.stylesFromArray(p.styles,p.text),c=Object.assign({},p,{styles:a});return h.Object._fromObject("Textbox",c,d,"text")}}(Ie),function(){var y=w.controlsUtils,h=y.scaleSkewCursorStyleHandler,p=y.scaleCursorStyleHandler,d=y.scalingEqually,a=y.scalingYOrSkewingX,c=y.scalingXOrSkewingY,s=y.scaleOrSkewActionName,f=w.Object.prototype.controls;if(f.ml=new w.Control({x:-.5,y:0,cursorStyleHandler:h,actionHandler:c,getActionName:s}),f.mr=new w.Control({x:.5,y:0,cursorStyleHandler:h,actionHandler:c,getActionName:s}),f.mb=new w.Control({x:0,y:.5,cursorStyleHandler:h,actionHandler:a,getActionName:s}),f.mt=new w.Control({x:0,y:-.5,cursorStyleHandler:h,actionHandler:a,getActionName:s}),f.tl=new w.Control({x:-.5,y:-.5,cursorStyleHandler:p,actionHandler:d}),f.tr=new w.Control({x:.5,y:-.5,cursorStyleHandler:p,actionHandler:d}),f.bl=new w.Control({x:-.5,y:.5,cursorStyleHandler:p,actionHandler:d}),f.br=new w.Control({x:.5,y:.5,cursorStyleHandler:p,actionHandler:d}),f.mtr=new w.Control({x:0,y:-.5,actionHandler:y.rotationWithSnapping,cursorStyleHandler:y.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),w.Textbox){var g=w.Textbox.prototype.controls={};g.mtr=f.mtr,g.tr=f.tr,g.br=f.br,g.tl=f.tl,g.bl=f.bl,g.mt=f.mt,g.mb=f.mb,g.mr=new w.Control({x:.5,y:0,actionHandler:y.changeWidth,cursorStyleHandler:h,actionName:"resizing"}),g.ml=new w.Control({x:-.5,y:0,actionHandler:y.changeWidth,cursorStyleHandler:h,actionName:"resizing"})}}()},960:()=>{},759:()=>{},272:()=>{}},Mo=>{Mo(Mo.s=541)}]);